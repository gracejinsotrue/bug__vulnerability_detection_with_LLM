import requests
from bs4 import BeautifulSoup

def extract_cwe_content(url):
    response = requests.get(url)
    if response.status_code != 200:
        return "Failed to retrieve the webpage."

    soup = BeautifulSoup(response.content, 'html.parser')

    # Define a dictionary to hold the extracted content
    cwe_content = {}

    # Extract the title
    title = soup.title.string.strip()
    cwe_content['Title'] = title

    # Extract the content from #Description > div.heading to #Extended_Description > div.heading
    description_heading = soup.select_one('#Description > div.heading')
    extended_description_heading = soup.select_one('#Extended_Description > div.heading')

    if description_heading and extended_description_heading:
        content = []
        for sibling in description_heading.find_all_next():
            if sibling == extended_description_heading:
                break
            if sibling.get_text(strip=True):
                content.append(sibling.get_text(strip=True))
        cwe_content['Content'] = ' '.join(content)

    return cwe_content

url = "https://cwe.mitre.org/data/definitions/22.html"
cwe_content = extract_cwe_content(url)
for section, content in cwe_content.items():
    print(f"{section}:\n{content}\n")
