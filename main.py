import getpass
import os
from openai import OpenAI
from langchain.tools import tool
from langchain_openai import ChatOpenAI
from tools.retrieve_source import retrieve_source_code_function
from tools.find_callers import find_callers


#client = OpenAI(api_key = "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")

#bind tools to model
tools = [retrieve_source_code_function, find_callers]

llm = ChatOpenAI(model="gpt-3.5-turbo",openai_api_key="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")
llm_with_tools = llm.bind_tools(tools)

#example invocation
query = "Retrieve the source code for file ohok.c"
response = llm_with_tools.invoke(query)
print("Full Response:", response)

# Extract and print the tool call results
if 'tool_calls' in response.additional_kwargs:
    for call in response.additional_kwargs['tool_calls']:
         print("Tool Call:", call)
else:
    print("No tool calls found in response.")