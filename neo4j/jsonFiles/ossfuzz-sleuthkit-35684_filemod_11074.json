[
    {
        "baseNode": {
            "identity": 11066,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-sleuthkit-35684"
            }
        },
        "relation1": {
            "identity": 22938,
            "start": 11066,
            "end": 11074,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11074,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.01666788011789322,
                    -0.013791035860776901,
                    -0.08767351508140564,
                    0.00010483525693416595,
                    -0.0064052133820950985,
                    -0.01486355159431696,
                    0.03440522775053978,
                    0.05828425660729408,
                    0.009287082590162754,
                    -0.08328310400247574,
                    0.045023202896118164,
                    0.038327839225530624,
                    -0.0900651216506958,
                    -0.02164064534008503,
                    0.06104406714439392,
                    -0.06625230610370636,
                    0.16528908908367157,
                    0.0002021615655394271,
                    0.03931834548711777,
                    0.06766756623983383,
                    -0.07005337625741959,
                    -0.06296009570360184,
                    -0.045151736587285995,
                    0.04630604386329651,
                    -0.03204602375626564,
                    0.01432963740080595,
                    0.019857509061694145,
                    0.03768928721547127,
                    -0.04666038230061531,
                    0.009676064364612103,
                    -0.02765936590731144,
                    -0.10324803739786148,
                    0.041385918855667114,
                    0.023077845573425293,
                    0.0011927004670724273,
                    -0.004118524491786957,
                    0.011448035947978497,
                    0.01986825093626976,
                    0.0004677722754422575,
                    0.019309308379888535,
                    -0.07821664959192276,
                    -0.024151084944605827,
                    0.029724687337875366,
                    -0.04384741187095642,
                    -0.042867422103881836,
                    0.08881749957799911,
                    -0.08252836018800735,
                    -0.024410536512732506,
                    0.0071931867860257626,
                    0.02191600203514099,
                    0.07116644829511642,
                    0.032673586159944534,
                    -0.06987310200929642,
                    0.011478281579911709,
                    0.011793799698352814,
                    0.013603951781988144,
                    -0.07169725745916367,
                    0.02168339490890503,
                    -0.04598674178123474,
                    0.059910859912633896,
                    -0.10980537533760071,
                    -0.04431271180510521,
                    0.032018933445215225,
                    -0.05354749783873558,
                    0.08496621996164322,
                    0.02660549432039261,
                    0.07214222103357315,
                    0.00021138880401849747,
                    -0.018520453944802284,
                    0.04473273083567619,
                    0.05241842940449715,
                    0.056499868631362915,
                    -0.04390842840075493,
                    -0.04979870095849037,
                    -0.024644076824188232,
                    -0.08144306391477585,
                    -0.003227831097319722,
                    -0.0750977098941803,
                    -0.038677290081977844,
                    -0.07345592975616455,
                    -0.038035742938518524,
                    0.09030980616807938,
                    0.036539506167173386,
                    0.016727492213249207,
                    0.005112927872687578,
                    -0.015627330169081688,
                    0.07029365748167038,
                    -0.007751012686640024,
                    0.027396680787205696,
                    -0.03769861161708832,
                    0.02614643983542919,
                    -0.09901199489831924,
                    0.08028819411993027,
                    -0.07929075509309769,
                    0.04836012423038483,
                    -0.04646027460694313,
                    -0.012285631150007248,
                    -0.05286625400185585,
                    0.026423221454024315,
                    -0.07141389697790146,
                    -0.06326775997877121,
                    0.002169659361243248,
                    -0.04431525990366936,
                    -0.006757756229490042,
                    -0.12351084500551224,
                    0.013225794769823551,
                    -0.061421483755111694,
                    0.04842166230082512,
                    -0.010257666930556297,
                    -0.04386544227600098,
                    -0.022704103961586952,
                    -0.025143509730696678,
                    -0.048889074474573135,
                    -0.035466257482767105,
                    -0.0017686063656583428,
                    0.01629944145679474,
                    0.017592037096619606,
                    -0.040856022387742996,
                    -0.02506951242685318,
                    -0.029904507100582123,
                    0.0975746288895607,
                    0.03693327680230141,
                    -0.042877841740846634,
                    0.035507407039403915,
                    0.10265135765075684,
                    -0.022022053599357605,
                    0.04765929654240608,
                    0.0364285372197628,
                    0.0006904217298142612,
                    0.10830014944076538,
                    0.011725512333214283,
                    -0.012818374671041965,
                    -0.023649608716368675,
                    -0.037190329283475876,
                    -0.005504495929926634,
                    -0.08712808042764664,
                    0.06852630525827408,
                    0.011009189300239086,
                    0.05259006842970848,
                    0.019200926646590233,
                    0.05664163827896118,
                    0.029613157734274864,
                    -0.010848510079085827,
                    0.1625121384859085,
                    -0.060547035187482834,
                    -0.06337476521730423,
                    0.019353142008185387,
                    -0.05568903684616089,
                    -0.07913195341825485,
                    -0.061925943940877914,
                    -0.053861428052186966,
                    0.0069872229360044,
                    -0.047444865107536316,
                    -0.05837339535355568,
                    0.03191671893000603,
                    -0.002894860925152898,
                    0.033524107187986374,
                    -0.05065052583813667,
                    0.006331203039735556,
                    -0.042540598660707474,
                    0.03893912211060524,
                    0.061810094863176346,
                    0.027897313237190247,
                    0.07307811826467514,
                    -0.03293697163462639,
                    0.04857046902179718,
                    0.029131874442100525,
                    -0.00901723001152277,
                    -0.05541236326098442,
                    0.05013212934136391,
                    -0.05144277587532997,
                    0.04659755155444145,
                    -0.0034712988417595625,
                    -0.08394994586706161,
                    0.008478931151330471,
                    -0.044255997985601425,
                    0.00586734339594841,
                    -0.007640153635293245,
                    0.04748408496379852,
                    0.06547088176012039,
                    -0.03274521976709366,
                    -0.01041101198643446,
                    -0.10812439769506454,
                    -0.06229354068636894,
                    -0.06514453142881393,
                    0.0694979652762413,
                    -0.06750812381505966,
                    -0.0490899384021759,
                    -0.004079438280314207,
                    -0.006213436368852854,
                    0.021878501400351524,
                    -0.05902096629142761,
                    0.010560599155724049,
                    -0.0371716134250164,
                    -0.09567718952894211,
                    0.04108498990535736,
                    -0.0005541865830309689,
                    0.054931387305259705,
                    -0.06581714749336243,
                    -0.0860685408115387,
                    -0.0703376829624176,
                    0.018201500177383423,
                    -0.03396105021238327,
                    -0.02537633664906025,
                    -0.057933736592531204,
                    -0.0895179808139801,
                    0.15000930428504944,
                    -0.01823239214718342,
                    0.08785587549209595,
                    -0.018780797719955444,
                    0.06111493334174156,
                    -0.02049170434474945,
                    0.10678305476903915,
                    0.07036031782627106,
                    0.06298203021287918,
                    0.018684810027480125,
                    0.060264963656663895,
                    0.06576717644929886,
                    -0.03244099020957947,
                    0.01531748753041029,
                    -0.050113897770643234,
                    0.0033534683752804995,
                    -0.031391989439725876,
                    0.04977430775761604,
                    0.09521657228469849,
                    -0.01625397615134716,
                    0.025506233796477318,
                    -0.007150216493755579,
                    0.09275790303945541,
                    0.06705747544765472,
                    0.038902606815099716,
                    0.09631103277206421,
                    -0.0405852347612381,
                    -0.00867739412933588,
                    -0.004837632179260254,
                    -0.06595345586538315,
                    0.020446257665753365,
                    0.004662240389734507,
                    -0.07665727287530899,
                    -0.09939365833997726,
                    0.02987724356353283,
                    -0.015041664242744446,
                    -0.041477054357528687,
                    -0.00629352405667305,
                    0.08850633352994919,
                    -0.03779550641775131,
                    -0.04111890867352486,
                    0.15136516094207764,
                    -0.007874418050050735,
                    -0.04390694573521614,
                    -0.013757404871284962,
                    0.0033394116908311844,
                    0.05093764141201973,
                    0.030559509992599487,
                    -0.06773952394723892,
                    -0.008914820849895477
                ],
                "diffText": "diff --git a/tsk/fs/apfs_fs.cpp b/tsk/fs/apfs_fs.cpp\nindex 67c1b2071..e0a64a56d 100644\n--- a/tsk/fs/apfs_fs.cpp\n+++ b/tsk/fs/apfs_fs.cpp\n@@ -74,33 +74,49 @@ void APFSJObject::add_entry(const jit::value_type& e) {\n       _is_clone = (_inode.private_id != key->oid());\n \n       // If there's more data than the size of the inode then we have xdata\n-      if ((size_t)e.value.count() > sizeof(apfs_inode)) {\n+      size_t e_offset = sizeof(apfs_inode);\n+      size_t e_size = e.value.count();\n+      // Need at least 4 bytes for start of extended fields (xf_blob_t)\n+      if (e_size > sizeof(apfs_inode) + 4) {\n         // The xfield headers are right after the inode\n         const auto xfield = reinterpret_cast<const apfs_xfield*>(value + 1);\n \n-        // The xfield data is after all of the xfield headers\n-        auto xfield_data =\n-            reinterpret_cast<const char*>(&xfield->entries[xfield->num_exts]);\n+        e_offset += 4;\n \n-        for (auto i = 0U; i < xfield->num_exts; i++) {\n-          const auto& ext = xfield->entries[i];\n+        // Need at least 4 bytes for each x_field_t\n+        if (xfield->num_exts < (e_size - e_offset) / 4) {\n+          // sizeof(xf_blob_t) + number of extenteded fields * sizeof(x_field_t)\n+          e_offset += xfield->num_exts * 4;\n \n-          switch (ext.type) {\n-            case APFS_XFIELD_TYPE_NAME:\n-              _name = std::string(xfield_data);\n-              break;\n-            case APFS_XFIELD_TYPE_DSTREAM: {\n-              const auto ds =\n-                  reinterpret_cast<const apfs_dstream*>(xfield_data);\n+          // The xfield data is after all of the xfield headers\n+          auto xfield_data =\n+              reinterpret_cast<const char*>(&xfield->entries[xfield->num_exts]);\n \n-              _size = ds->size;\n-              _size_on_disk = ds->alloced_size;\n-              break;\n+          for (auto i = 0U; i < xfield->num_exts; i++) {\n+            const auto& ext = xfield->entries[i];\n+\n+            switch (ext.type) {\n+              case APFS_XFIELD_TYPE_NAME:\n+                if((ext.len < 1) || (ext.len > e_size) || (e_offset > e_size - ext.len)) {\n+                  break;\n+                }\n+                _name = std::string(xfield_data, ext.len - 1);\n+                break;\n+\n+              case APFS_XFIELD_TYPE_DSTREAM: {\n+                const auto ds =\n+                    reinterpret_cast<const apfs_dstream*>(xfield_data);\n+\n+                _size = ds->size;\n+                _size_on_disk = ds->alloced_size;\n+                break;\n+              }\n             }\n-          }\n \n-          // The next data needs to be aligned properly\n-          xfield_data += (ext.len + 7) & 0xFFF8;\n+            // The next data needs to be aligned properly\n+            xfield_data += (ext.len + 7) & 0xFFF8;\n+            e_offset += (ext.len + 7) & 0xFFF8;\n+          }\n         }\n       }\n       break;"
            }
        },
        "relation2": {
            "identity": 22938,
            "start": 11074,
            "end": 11066,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 11066,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-sleuthkit-35684"
            }
        }
    },
    {
        "baseNode": {
            "identity": 11066,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-sleuthkit-35684"
            }
        },
        "relation1": {
            "identity": 22938,
            "start": 11066,
            "end": 11074,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11074,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.01666788011789322,
                    -0.013791035860776901,
                    -0.08767351508140564,
                    0.00010483525693416595,
                    -0.0064052133820950985,
                    -0.01486355159431696,
                    0.03440522775053978,
                    0.05828425660729408,
                    0.009287082590162754,
                    -0.08328310400247574,
                    0.045023202896118164,
                    0.038327839225530624,
                    -0.0900651216506958,
                    -0.02164064534008503,
                    0.06104406714439392,
                    -0.06625230610370636,
                    0.16528908908367157,
                    0.0002021615655394271,
                    0.03931834548711777,
                    0.06766756623983383,
                    -0.07005337625741959,
                    -0.06296009570360184,
                    -0.045151736587285995,
                    0.04630604386329651,
                    -0.03204602375626564,
                    0.01432963740080595,
                    0.019857509061694145,
                    0.03768928721547127,
                    -0.04666038230061531,
                    0.009676064364612103,
                    -0.02765936590731144,
                    -0.10324803739786148,
                    0.041385918855667114,
                    0.023077845573425293,
                    0.0011927004670724273,
                    -0.004118524491786957,
                    0.011448035947978497,
                    0.01986825093626976,
                    0.0004677722754422575,
                    0.019309308379888535,
                    -0.07821664959192276,
                    -0.024151084944605827,
                    0.029724687337875366,
                    -0.04384741187095642,
                    -0.042867422103881836,
                    0.08881749957799911,
                    -0.08252836018800735,
                    -0.024410536512732506,
                    0.0071931867860257626,
                    0.02191600203514099,
                    0.07116644829511642,
                    0.032673586159944534,
                    -0.06987310200929642,
                    0.011478281579911709,
                    0.011793799698352814,
                    0.013603951781988144,
                    -0.07169725745916367,
                    0.02168339490890503,
                    -0.04598674178123474,
                    0.059910859912633896,
                    -0.10980537533760071,
                    -0.04431271180510521,
                    0.032018933445215225,
                    -0.05354749783873558,
                    0.08496621996164322,
                    0.02660549432039261,
                    0.07214222103357315,
                    0.00021138880401849747,
                    -0.018520453944802284,
                    0.04473273083567619,
                    0.05241842940449715,
                    0.056499868631362915,
                    -0.04390842840075493,
                    -0.04979870095849037,
                    -0.024644076824188232,
                    -0.08144306391477585,
                    -0.003227831097319722,
                    -0.0750977098941803,
                    -0.038677290081977844,
                    -0.07345592975616455,
                    -0.038035742938518524,
                    0.09030980616807938,
                    0.036539506167173386,
                    0.016727492213249207,
                    0.005112927872687578,
                    -0.015627330169081688,
                    0.07029365748167038,
                    -0.007751012686640024,
                    0.027396680787205696,
                    -0.03769861161708832,
                    0.02614643983542919,
                    -0.09901199489831924,
                    0.08028819411993027,
                    -0.07929075509309769,
                    0.04836012423038483,
                    -0.04646027460694313,
                    -0.012285631150007248,
                    -0.05286625400185585,
                    0.026423221454024315,
                    -0.07141389697790146,
                    -0.06326775997877121,
                    0.002169659361243248,
                    -0.04431525990366936,
                    -0.006757756229490042,
                    -0.12351084500551224,
                    0.013225794769823551,
                    -0.061421483755111694,
                    0.04842166230082512,
                    -0.010257666930556297,
                    -0.04386544227600098,
                    -0.022704103961586952,
                    -0.025143509730696678,
                    -0.048889074474573135,
                    -0.035466257482767105,
                    -0.0017686063656583428,
                    0.01629944145679474,
                    0.017592037096619606,
                    -0.040856022387742996,
                    -0.02506951242685318,
                    -0.029904507100582123,
                    0.0975746288895607,
                    0.03693327680230141,
                    -0.042877841740846634,
                    0.035507407039403915,
                    0.10265135765075684,
                    -0.022022053599357605,
                    0.04765929654240608,
                    0.0364285372197628,
                    0.0006904217298142612,
                    0.10830014944076538,
                    0.011725512333214283,
                    -0.012818374671041965,
                    -0.023649608716368675,
                    -0.037190329283475876,
                    -0.005504495929926634,
                    -0.08712808042764664,
                    0.06852630525827408,
                    0.011009189300239086,
                    0.05259006842970848,
                    0.019200926646590233,
                    0.05664163827896118,
                    0.029613157734274864,
                    -0.010848510079085827,
                    0.1625121384859085,
                    -0.060547035187482834,
                    -0.06337476521730423,
                    0.019353142008185387,
                    -0.05568903684616089,
                    -0.07913195341825485,
                    -0.061925943940877914,
                    -0.053861428052186966,
                    0.0069872229360044,
                    -0.047444865107536316,
                    -0.05837339535355568,
                    0.03191671893000603,
                    -0.002894860925152898,
                    0.033524107187986374,
                    -0.05065052583813667,
                    0.006331203039735556,
                    -0.042540598660707474,
                    0.03893912211060524,
                    0.061810094863176346,
                    0.027897313237190247,
                    0.07307811826467514,
                    -0.03293697163462639,
                    0.04857046902179718,
                    0.029131874442100525,
                    -0.00901723001152277,
                    -0.05541236326098442,
                    0.05013212934136391,
                    -0.05144277587532997,
                    0.04659755155444145,
                    -0.0034712988417595625,
                    -0.08394994586706161,
                    0.008478931151330471,
                    -0.044255997985601425,
                    0.00586734339594841,
                    -0.007640153635293245,
                    0.04748408496379852,
                    0.06547088176012039,
                    -0.03274521976709366,
                    -0.01041101198643446,
                    -0.10812439769506454,
                    -0.06229354068636894,
                    -0.06514453142881393,
                    0.0694979652762413,
                    -0.06750812381505966,
                    -0.0490899384021759,
                    -0.004079438280314207,
                    -0.006213436368852854,
                    0.021878501400351524,
                    -0.05902096629142761,
                    0.010560599155724049,
                    -0.0371716134250164,
                    -0.09567718952894211,
                    0.04108498990535736,
                    -0.0005541865830309689,
                    0.054931387305259705,
                    -0.06581714749336243,
                    -0.0860685408115387,
                    -0.0703376829624176,
                    0.018201500177383423,
                    -0.03396105021238327,
                    -0.02537633664906025,
                    -0.057933736592531204,
                    -0.0895179808139801,
                    0.15000930428504944,
                    -0.01823239214718342,
                    0.08785587549209595,
                    -0.018780797719955444,
                    0.06111493334174156,
                    -0.02049170434474945,
                    0.10678305476903915,
                    0.07036031782627106,
                    0.06298203021287918,
                    0.018684810027480125,
                    0.060264963656663895,
                    0.06576717644929886,
                    -0.03244099020957947,
                    0.01531748753041029,
                    -0.050113897770643234,
                    0.0033534683752804995,
                    -0.031391989439725876,
                    0.04977430775761604,
                    0.09521657228469849,
                    -0.01625397615134716,
                    0.025506233796477318,
                    -0.007150216493755579,
                    0.09275790303945541,
                    0.06705747544765472,
                    0.038902606815099716,
                    0.09631103277206421,
                    -0.0405852347612381,
                    -0.00867739412933588,
                    -0.004837632179260254,
                    -0.06595345586538315,
                    0.020446257665753365,
                    0.004662240389734507,
                    -0.07665727287530899,
                    -0.09939365833997726,
                    0.02987724356353283,
                    -0.015041664242744446,
                    -0.041477054357528687,
                    -0.00629352405667305,
                    0.08850633352994919,
                    -0.03779550641775131,
                    -0.04111890867352486,
                    0.15136516094207764,
                    -0.007874418050050735,
                    -0.04390694573521614,
                    -0.013757404871284962,
                    0.0033394116908311844,
                    0.05093764141201973,
                    0.030559509992599487,
                    -0.06773952394723892,
                    -0.008914820849895477
                ],
                "diffText": "diff --git a/tsk/fs/apfs_fs.cpp b/tsk/fs/apfs_fs.cpp\nindex 67c1b2071..e0a64a56d 100644\n--- a/tsk/fs/apfs_fs.cpp\n+++ b/tsk/fs/apfs_fs.cpp\n@@ -74,33 +74,49 @@ void APFSJObject::add_entry(const jit::value_type& e) {\n       _is_clone = (_inode.private_id != key->oid());\n \n       // If there's more data than the size of the inode then we have xdata\n-      if ((size_t)e.value.count() > sizeof(apfs_inode)) {\n+      size_t e_offset = sizeof(apfs_inode);\n+      size_t e_size = e.value.count();\n+      // Need at least 4 bytes for start of extended fields (xf_blob_t)\n+      if (e_size > sizeof(apfs_inode) + 4) {\n         // The xfield headers are right after the inode\n         const auto xfield = reinterpret_cast<const apfs_xfield*>(value + 1);\n \n-        // The xfield data is after all of the xfield headers\n-        auto xfield_data =\n-            reinterpret_cast<const char*>(&xfield->entries[xfield->num_exts]);\n+        e_offset += 4;\n \n-        for (auto i = 0U; i < xfield->num_exts; i++) {\n-          const auto& ext = xfield->entries[i];\n+        // Need at least 4 bytes for each x_field_t\n+        if (xfield->num_exts < (e_size - e_offset) / 4) {\n+          // sizeof(xf_blob_t) + number of extenteded fields * sizeof(x_field_t)\n+          e_offset += xfield->num_exts * 4;\n \n-          switch (ext.type) {\n-            case APFS_XFIELD_TYPE_NAME:\n-              _name = std::string(xfield_data);\n-              break;\n-            case APFS_XFIELD_TYPE_DSTREAM: {\n-              const auto ds =\n-                  reinterpret_cast<const apfs_dstream*>(xfield_data);\n+          // The xfield data is after all of the xfield headers\n+          auto xfield_data =\n+              reinterpret_cast<const char*>(&xfield->entries[xfield->num_exts]);\n \n-              _size = ds->size;\n-              _size_on_disk = ds->alloced_size;\n-              break;\n+          for (auto i = 0U; i < xfield->num_exts; i++) {\n+            const auto& ext = xfield->entries[i];\n+\n+            switch (ext.type) {\n+              case APFS_XFIELD_TYPE_NAME:\n+                if((ext.len < 1) || (ext.len > e_size) || (e_offset > e_size - ext.len)) {\n+                  break;\n+                }\n+                _name = std::string(xfield_data, ext.len - 1);\n+                break;\n+\n+              case APFS_XFIELD_TYPE_DSTREAM: {\n+                const auto ds =\n+                    reinterpret_cast<const apfs_dstream*>(xfield_data);\n+\n+                _size = ds->size;\n+                _size_on_disk = ds->alloced_size;\n+                break;\n+              }\n             }\n-          }\n \n-          // The next data needs to be aligned properly\n-          xfield_data += (ext.len + 7) & 0xFFF8;\n+            // The next data needs to be aligned properly\n+            xfield_data += (ext.len + 7) & 0xFFF8;\n+            e_offset += (ext.len + 7) & 0xFFF8;\n+          }\n         }\n       }\n       break;"
            }
        },
        "relation2": {
            "identity": 22937,
            "start": 11074,
            "end": 11073,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 11073,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "tsk/fs/apfs_fs.cpp"
            }
        }
    },
    {
        "baseNode": {
            "identity": 11066,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-sleuthkit-35684"
            }
        },
        "relation1": {
            "identity": 22934,
            "start": 11066,
            "end": 239,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 239,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "sleuthkit"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11066,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-sleuthkit-35684"
            }
        },
        "relation1": {
            "identity": 22933,
            "start": 11066,
            "end": 11072,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11072,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "INFO: Running with entropic power schedule (0xFF, 100).\nINFO: Seed: 905574555\nINFO: Loaded 1 modules   (18820 inline 8-bit counters): 18820 [0xaf9df8, 0xafe77c), \nINFO: Loaded 1 PC tables (18820 PCs): 18820 [0x7eca78,0x8362b8), \n/out/sleuthkit_fls_fat_fuzzer: Running 1 inputs 1 time(s) each.\nRunning: /tmp/poc\n=================================================================\n==1==ERROR: AddressSanitizer: heap-use-after-free on address 0x604000000698 at pc 0x00000068b0d3 bp 0x7ffed24353f0 sp 0x7ffed24353e8\nREAD of size 8 at 0x604000000698 thread T0\nSCARINESS: 51 (8-byte-read-heap-use-after-free)\n    #0 0x68b0d2 in tsk_fs_attr_set_run /src/sleuthkit/tsk/fs/fs_attr.c:334:25\n    #1 0x6dac56 in fatfs_make_data_runs /src/sleuthkit/tsk/fs/fatfs_meta.c:856:13\n    #2 0x560a88 in tsk_fs_file_attr_check /src/sleuthkit/tsk/fs/fs_file.c:235:13\n    #3 0x560bde in tsk_fs_file_attr_get /src/sleuthkit/tsk/fs/fs_file.c:287:9\n    #4 0x5613f2 in tsk_fs_file_walk /src/sleuthkit/tsk/fs/fs_file.c:451:20\n    #5 0x6df022 in inode_walk_dent_act /src/sleuthkit/tsk/fs/fatfs_meta.c:1073:9\n    #6 0x55bea5 in tsk_fs_dir_walk_lcl /src/sleuthkit/tsk/fs/fs_dir.c:684:22\n    #7 0x55b873 in tsk_fs_dir_walk /src/sleuthkit/tsk/fs/fs_dir.c:933:14\n    #8 0x6dd994 in fatfs_inode_walk /src/sleuthkit/tsk/fs/fatfs_meta.c:1260:13\n    #9 0x562723 in tsk_fs_meta_walk /src/sleuthkit/tsk/fs/fs_inode.c:214:12\n    #10 0x55e185 in tsk_fs_dir_find_orphans /src/sleuthkit/tsk/fs/fs_dir.c:1321:9\n    #11 0x64f697 in fatfs_dir_open_meta /src/sleuthkit/tsk/fs/fatfs_dent.cpp:268:16\n    #12 0x55a75e in tsk_fs_dir_open_meta /src/sleuthkit/tsk/fs/fs_dir.c:289:14\n    #13 0x55ba30 in tsk_fs_dir_walk_lcl /src/sleuthkit/tsk/fs/fs_dir.c:625:19\n    #14 0x55cc92 in tsk_fs_dir_walk_lcl /src/sleuthkit/tsk/fs/fs_dir.c:820:26\n    #15 0x55b873 in tsk_fs_dir_walk /src/sleuthkit/tsk/fs/fs_dir.c:933:14\n    #16 0x5581da in tsk_fs_fls /src/sleuthkit/tsk/fs/fls_lib.c:262:12\n    #17 0x557c68 in LLVMFuzzerTestOneInput /src/sleuthkit_fls_fuzzer.cc:35:5\n    #18 0x4598a3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15\n    #19 0x444e12 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6\n    #20 0x44ab4e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9\n    #21 0x474752 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #22 0x7f22737ad83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n    #23 0x41fe28 in _start (/out/sleuthkit_fls_fat_fuzzer+0x41fe28)\n\nDEDUP_TOKEN: tsk_fs_attr_set_run--fatfs_make_data_runs--tsk_fs_file_attr_check\n0x604000000698 is located 8 bytes inside of 48-byte region [0x604000000690,0x6040000006c0)\nfreed by thread T0 here:\n    #0 0x523982 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:127:3\n    #1 0x68a2ae in tsk_fs_attr_run_free /src/sleuthkit/tsk/fs/fs_attr.c:68:9\n    #2 0x6da904 in fatfs_make_data_runs /src/sleuthkit/tsk/fs/fatfs_meta.c:823:21\n    #3 0x560a88 in tsk_fs_file_attr_check /src/sleuthkit/tsk/fs/fs_file.c:235:13\n    #4 0x560bde in tsk_fs_file_attr_get /src/sleuthkit/tsk/fs/fs_file.c:287:9\n    #5 0x5613f2 in tsk_fs_file_walk /src/sleuthkit/tsk/fs/fs_file.c:451:20\n    #6 0x6df022 in inode_walk_dent_act /src/sleuthkit/tsk/fs/fatfs_meta.c:1073:9\n    #7 0x55bea5 in tsk_fs_dir_walk_lcl /src/sleuthkit/tsk/fs/fs_dir.c:684:22\n    #8 0x55b873 in tsk_fs_dir_walk /src/sleuthkit/tsk/fs/fs_dir.c:933:14\n    #9 0x6dd994 in fatfs_inode_walk /src/sleuthkit/tsk/fs/fatfs_meta.c:1260:13\n    #10 0x562723 in tsk_fs_meta_walk /src/sleuthkit/tsk/fs/fs_inode.c:214:12\n    #11 0x55e185 in tsk_fs_dir_find_orphans /src/sleuthkit/tsk/fs/fs_dir.c:1321:9\n    #12 0x64f697 in fatfs_dir_open_meta /src/sleuthkit/tsk/fs/fatfs_dent.cpp:268:16\n    #13 0x55a75e in tsk_fs_dir_open_meta /src/sleuthkit/tsk/fs/fs_dir.c:289:14\n    #14 0x55ba30 in tsk_fs_dir_walk_lcl /src/sleuthkit/tsk/fs/fs_dir.c:625:19\n    #15 0x55cc92 in tsk_fs_dir_walk_lcl /src/sleuthkit/tsk/fs/fs_dir.c:820:26\n    #16 0x55b873 in tsk_fs_dir_walk /src/sleuthkit/tsk/fs/fs_dir.c:933:14\n    #17 0x5581da in tsk_fs_fls /src/sleuthkit/tsk/fs/fls_lib.c:262:12\n    #18 0x557c68 in LLVMFuzzerTestOneInput /src/sleuthkit_fls_fuzzer.cc:35:5\n    #19 0x4598a3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15\n    #20 0x444e12 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6\n    #21 0x44ab4e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9\n    #22 0x474752 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #23 0x7f22737ad83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n\nDEDUP_TOKEN: free--tsk_fs_attr_run_free--fatfs_make_data_runs\npreviously allocated by thread T0 here:\n    #0 0x523bed in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3\n    #1 0x6110f9 in tsk_malloc /src/sleuthkit/tsk/base/mymalloc.c:32:16\n    #2 0x68a245 in tsk_fs_attr_run_alloc /src/sleuthkit/tsk/fs/fs_attr.c:48:29\n    #3 0x6da434 in fatfs_make_data_runs /src/sleuthkit/tsk/fs/fatfs_meta.c:774:49\n    #4 0x560a88 in tsk_fs_file_attr_check /src/sleuthkit/tsk/fs/fs_file.c:235:13\n    #5 0x560bde in tsk_fs_file_attr_get /src/sleuthkit/tsk/fs/fs_file.c:287:9\n    #6 0x5613f2 in tsk_fs_file_walk /src/sleuthkit/tsk/fs/fs_file.c:451:20\n    #7 0x6df022 in inode_walk_dent_act /src/sleuthkit/tsk/fs/fatfs_meta.c:1073:9\n    #8 0x55bea5 in tsk_fs_dir_walk_lcl /src/sleuthkit/tsk/fs/fs_dir.c:684:22\n    #9 0x55b873 in tsk_fs_dir_walk /src/sleuthkit/tsk/fs/fs_dir.c:933:14\n    #10 0x6dd994 in fatfs_inode_walk /src/sleuthkit/tsk/fs/fatfs_meta.c:1260:13\n    #11 0x562723 in tsk_fs_meta_walk /src/sleuthkit/tsk/fs/fs_inode.c:214:12\n    #12 0x55e185 in tsk_fs_dir_find_orphans /src/sleuthkit/tsk/fs/fs_dir.c:1321:9\n    #13 0x64f697 in fatfs_dir_open_meta /src/sleuthkit/tsk/fs/fatfs_dent.cpp:268:16\n    #14 0x55a75e in tsk_fs_dir_open_meta /src/sleuthkit/tsk/fs/fs_dir.c:289:14\n    #15 0x55ba30 in tsk_fs_dir_walk_lcl /src/sleuthkit/tsk/fs/fs_dir.c:625:19\n    #16 0x55cc92 in tsk_fs_dir_walk_lcl /src/sleuthkit/tsk/fs/fs_dir.c:820:26\n    #17 0x55b873 in tsk_fs_dir_walk /src/sleuthkit/tsk/fs/fs_dir.c:933:14\n    #18 0x5581da in tsk_fs_fls /src/sleuthkit/tsk/fs/fls_lib.c:262:12\n    #19 0x557c68 in LLVMFuzzerTestOneInput /src/sleuthkit_fls_fuzzer.cc:35:5\n    #20 0x4598a3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15\n    #21 0x444e12 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6\n    #22 0x44ab4e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9\n    #23 0x474752 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #24 0x7f22737ad83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n\nDEDUP_TOKEN: malloc--tsk_malloc--tsk_fs_attr_run_alloc\nSUMMARY: AddressSanitizer: heap-use-after-free /src/sleuthkit/tsk/fs/fs_attr.c:334:25 in tsk_fs_attr_set_run\nShadow bytes around the buggy address:\n  0x0c087fff8080: fa fa 00 00 00 00 00 00 fa fa fd fd fd fd fd fa\n  0x0c087fff8090: fa fa 00 00 00 00 00 00 fa fa fd fd fd fd fd fd\n  0x0c087fff80a0: fa fa fd fd fd fd fd fd fa fa 00 00 00 00 00 00\n  0x0c087fff80b0: fa fa fd fd fd fd fd fd fa fa 00 00 00 00 00 00\n  0x0c087fff80c0: fa fa fd fd fd fd fd fa fa fa 00 00 00 00 00 00\n=>0x0c087fff80d0: fa fa fd[fd]fd fd fd fd fa fa fd fd fd fd fd fd\n  0x0c087fff80e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c087fff80f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c087fff8100: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c087fff8110: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c087fff8120: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n  Shadow gap:              cc\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.00899565126746893,
                    0.01624348573386669,
                    -0.03258137032389641,
                    0.0156484916806221,
                    -0.010235905647277832,
                    -0.005389964208006859,
                    -0.030056660994887352,
                    0.057474032044410706,
                    0.09570924192667007,
                    -0.01687110774219036,
                    0.009971636347472668,
                    0.004727071616798639,
                    -0.040585678070783615,
                    -0.0392049141228199,
                    0.02759248949587345,
                    0.01960807293653488,
                    0.10362983494997025,
                    0.044471364468336105,
                    0.0402524508535862,
                    0.026339100673794746,
                    -0.06314667314291,
                    0.027420977130532265,
                    -0.00745932012796402,
                    -0.01011770311743021,
                    -0.05464419350028038,
                    0.021481195464730263,
                    -0.07774428278207779,
                    -0.06351698189973831,
                    -0.02193106710910797,
                    -0.018551232293248177,
                    -0.09537740796804428,
                    -0.07755611091852188,
                    0.014305074699223042,
                    -0.0027028925251215696,
                    -0.011259995400905609,
                    -0.04389020428061485,
                    -0.0018515133997425437,
                    -0.04334520921111107,
                    0.046654585748910904,
                    0.11986128240823746,
                    -0.07032463699579239,
                    -0.05108846351504326,
                    0.0030612933915108442,
                    -0.06103740260004997,
                    -0.0499006025493145,
                    0.054415006190538406,
                    0.015952393412590027,
                    0.003963656723499298,
                    0.02481631003320217,
                    -0.06562195718288422,
                    -0.116075299680233,
                    -0.022317616268992424,
                    -0.0535120964050293,
                    -0.04360722005367279,
                    -0.07657789438962936,
                    -0.03673480823636055,
                    0.04390190541744232,
                    0.036642517894506454,
                    -0.05200678110122681,
                    0.13891424238681793,
                    -0.0020916727371513844,
                    -0.024308547377586365,
                    0.020935997366905212,
                    -0.004468230996280909,
                    -0.08039386570453644,
                    0.00924583151936531,
                    0.05207918956875801,
                    0.029833490028977394,
                    0.012371187098324299,
                    0.00202111410908401,
                    0.02559361793100834,
                    0.1613416224718094,
                    -0.0868229791522026,
                    -0.11818744987249374,
                    -0.019730830565094948,
                    0.019771194085478783,
                    -0.052904579788446426,
                    -0.04250219091773033,
                    -0.04562195762991905,
                    -0.10314763337373734,
                    -0.08763738721609116,
                    0.006590748205780983,
                    0.03573259711265564,
                    0.074815534055233,
                    0.02405952475965023,
                    0.02066216804087162,
                    -0.003441027132794261,
                    -0.0791473537683487,
                    0.007278111297637224,
                    -0.016927246004343033,
                    0.029622672125697136,
                    -0.058255720883607864,
                    -0.0009331852197647095,
                    0.0038256340194493532,
                    0.019190596416592598,
                    -0.024086354300379753,
                    0.010683703236281872,
                    -0.015246313065290451,
                    -0.03231839835643768,
                    0.0007958644418977201,
                    -0.0234938096255064,
                    -0.036832284182310104,
                    -0.015747522935271263,
                    -0.04629208520054817,
                    -0.013872332870960236,
                    0.03252319619059563,
                    -0.010346169583499432,
                    -0.008396103046834469,
                    0.007543023210018873,
                    0.004522746428847313,
                    -0.05490313097834587,
                    -0.012985233217477798,
                    -0.028200985863804817,
                    0.04062242433428764,
                    0.03906496241688728,
                    -0.014921081252396107,
                    -0.05362248048186302,
                    -0.048154640942811966,
                    0.02250407077372074,
                    0.022173473611474037,
                    0.015538237988948822,
                    0.012886103242635727,
                    -0.02055678330361843,
                    0.0015204139053821564,
                    0.015884514898061752,
                    0.01930508017539978,
                    0.015010868199169636,
                    -0.004720086697489023,
                    0.049680665135383606,
                    0.04780605435371399,
                    -0.00434561213478446,
                    0.004170704632997513,
                    0.0994630679488182,
                    0.007728178054094315,
                    -0.03133934363722801,
                    0.0243461225181818,
                    0.11809087544679642,
                    -0.012181746773421764,
                    0.020163482055068016,
                    0.003610284300521016,
                    0.05931609869003296,
                    0.020780039951205254,
                    -0.01685120165348053,
                    -0.011313698254525661,
                    0.012192302383482456,
                    -0.08324364572763443,
                    0.03141738101840019,
                    0.02059207670390606,
                    -0.09008585661649704,
                    -0.02239082008600235,
                    -0.0020455236081033945,
                    0.013627978973090649,
                    -0.09496643394231796,
                    -0.05446764826774597,
                    0.002265841932967305,
                    0.004201906267553568,
                    -0.039761021733284,
                    -0.009350360371172428,
                    -0.021793154999613762,
                    -0.019868632778525352,
                    0.008158201351761818,
                    0.10413963347673416,
                    0.055036887526512146,
                    0.12856054306030273,
                    -0.0261828750371933,
                    0.1011931523680687,
                    -0.023912891745567322,
                    0.004542635753750801,
                    -0.03341839089989662,
                    -0.055796850472688675,
                    -0.03553386032581329,
                    -0.008194202557206154,
                    0.03313179314136505,
                    -0.045638557523489,
                    0.04034371301531792,
                    -0.020610297098755836,
                    0.014444570057094097,
                    0.10800621658563614,
                    0.0277508944272995,
                    0.0749056339263916,
                    0.02252107672393322,
                    0.027273396030068398,
                    -0.026651516556739807,
                    -0.06628087908029556,
                    -0.00547339953482151,
                    0.06875572353601456,
                    -0.0728331208229065,
                    -0.0418449304997921,
                    0.028541982173919678,
                    -0.01355996448546648,
                    0.06812560558319092,
                    -0.0357566773891449,
                    0.029502244666218758,
                    -0.01697523333132267,
                    -0.09367773681879044,
                    -0.0025784531608223915,
                    0.051949549466371536,
                    0.05624079704284668,
                    0.00024193960416596383,
                    -0.1517956703901291,
                    -0.031399209052324295,
                    -0.038411807268857956,
                    0.06038573384284973,
                    -0.007836912758648396,
                    0.03642052784562111,
                    -0.10385682433843613,
                    0.016328999772667885,
                    5.655735731124878e-05,
                    0.002003602683544159,
                    -0.01827426441013813,
                    0.012061946094036102,
                    0.007900266908109188,
                    0.10691982507705688,
                    0.0622749924659729,
                    0.03397833928465843,
                    -0.051057666540145874,
                    0.014270923100411892,
                    0.012691146694123745,
                    -0.04593001306056976,
                    0.02503461390733719,
                    -0.07811109721660614,
                    -0.058086320757865906,
                    -0.07028497010469437,
                    -0.06057438626885414,
                    0.05595030263066292,
                    -0.01664622873067856,
                    -0.0346168577671051,
                    0.0784003809094429,
                    0.08796825259923935,
                    0.03127598762512207,
                    -0.04132580757141113,
                    -0.024311712011694908,
                    -0.006808411329984665,
                    0.003383878618478775,
                    -0.023563077673316002,
                    0.019750302657485008,
                    0.0799153745174408,
                    0.05267983675003052,
                    -0.056359026581048965,
                    -0.027042387053370476,
                    0.040191877633333206,
                    -0.009272207506000996,
                    -0.053093072026968,
                    -0.03205881640315056,
                    0.12328044325113297,
                    -0.08923684805631638,
                    -0.08007749915122986,
                    0.051390573382377625,
                    -0.03974081203341484,
                    0.04275381565093994,
                    -0.0511610209941864,
                    -0.03507421538233757,
                    0.03257998451590538,
                    -0.006547750439494848,
                    -0.015944046899676323,
                    -0.020186839625239372
                ],
                "report_type": "Heap-use-after-free READ 8",
                "severity": "High"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11066,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-sleuthkit-35684"
            }
        },
        "relation1": {
            "identity": 22932,
            "start": 11066,
            "end": 11070,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11070,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Merge pull request #2520 from joachimmetz/apfs_fix_oob_read1\n\nFixed multiple OOB reads in APFSJObject::add_entry #2519",
                "sha": "3a32d25c88a771892c9db1d2055395ae4523a682",
                "repo": "sleuthkit",
                "encoding": "UTF-8",
                "authored_date": 1631727459,
                "committer_tz_offset": 14400,
                "author_tz_offset": 14400,
                "committed_date": 1631727459
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11066,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-sleuthkit-35684"
            }
        },
        "relation1": {
            "identity": 22925,
            "start": 11066,
            "end": 11067,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11067,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Merge pull request #2523 from joachimmetz/fix_use_after_free1\n\nFixed use-after-free in fatfs_make_data_runs",
                "sha": "9f960bfca4add2f86e1edc7672b1736ff1f7f181",
                "repo": "sleuthkit",
                "encoding": "UTF-8",
                "authored_date": 1631715415,
                "committer_tz_offset": 14400,
                "author_tz_offset": 14400,
                "committed_date": 1631715415
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]