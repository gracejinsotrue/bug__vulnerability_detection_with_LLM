[
    {
        "baseNode": {
            "identity": 10743,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-ntopng-61836"
            }
        },
        "relation1": {
            "identity": 22238,
            "start": 10743,
            "end": 10749,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 10749,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.08427984267473221,
                    0.011863111518323421,
                    -0.09953013062477112,
                    -0.03833712637424469,
                    0.006482996046543121,
                    -0.001236051321029663,
                    0.054541945457458496,
                    0.12055232375860214,
                    -0.1115032210946083,
                    -0.10927531868219376,
                    -0.02285689488053322,
                    0.11667431890964508,
                    0.03137623146176338,
                    0.017738327383995056,
                    0.07482397556304932,
                    -0.061200760304927826,
                    0.08362192660570145,
                    0.06157601624727249,
                    0.0819149762392044,
                    0.017152298241853714,
                    -0.07969861477613449,
                    -0.01731681264936924,
                    -0.06740911304950714,
                    0.09139072895050049,
                    0.04832109063863754,
                    0.030111201107501984,
                    -0.05471355840563774,
                    0.0349372960627079,
                    0.030370723456144333,
                    0.049058571457862854,
                    -0.060174278914928436,
                    -0.1286393702030182,
                    0.060943201184272766,
                    -0.008386020548641682,
                    -0.05521632730960846,
                    -0.12672144174575806,
                    -0.06593865156173706,
                    0.011516734957695007,
                    -0.004907581023871899,
                    0.08054084330797195,
                    -0.06365831196308136,
                    -0.17317351698875427,
                    0.08925913274288177,
                    0.03903759643435478,
                    -0.061628542840480804,
                    0.004904206842184067,
                    -0.019969860091805458,
                    -0.028047824278473854,
                    -0.01912683993577957,
                    0.0011086617596447468,
                    -0.02658923901617527,
                    0.06171058118343353,
                    -0.09720470011234283,
                    -0.046570248901844025,
                    -0.06911656260490417,
                    -0.05816594138741493,
                    -0.04719849303364754,
                    -0.02061278186738491,
                    -0.05951530858874321,
                    0.09926868975162506,
                    -0.17876148223876953,
                    -0.03845423832535744,
                    0.010258659720420837,
                    0.024838650599122047,
                    0.0724668949842453,
                    0.0932830348610878,
                    -0.012899262830615044,
                    0.019285667687654495,
                    0.04704497009515762,
                    -0.05693505331873894,
                    0.08727452158927917,
                    0.07781762629747391,
                    -0.04769117385149002,
                    -0.06556540727615356,
                    -0.014352705329656601,
                    -0.06361530721187592,
                    0.030635546892881393,
                    -0.05668020248413086,
                    0.004047101829200983,
                    -0.1324595808982849,
                    0.03316682204604149,
                    0.07414508610963821,
                    0.03833268955349922,
                    0.008454638533294201,
                    0.08090706169605255,
                    0.006269689649343491,
                    0.08511386811733246,
                    0.052860669791698456,
                    -0.02245299331843853,
                    -0.026493895798921585,
                    0.05678032338619232,
                    -0.10316511988639832,
                    0.060391657054424286,
                    -0.07958449423313141,
                    0.017996355891227722,
                    0.009271019138395786,
                    0.03769507259130478,
                    -0.012123224325478077,
                    0.01594545878469944,
                    -0.0479760468006134,
                    0.027671270072460175,
                    -0.06629489362239838,
                    -0.051047734916210175,
                    -0.04677531495690346,
                    -0.03045007959008217,
                    -0.010927814990282059,
                    -0.0798024982213974,
                    -0.023712947964668274,
                    -0.024800287559628487,
                    -0.08741161972284317,
                    0.06212788075208664,
                    -0.008497759699821472,
                    -0.0318693146109581,
                    -0.0068669747561216354,
                    0.04435529187321663,
                    -0.030130749568343163,
                    -0.13085000216960907,
                    -0.06109274551272392,
                    -0.011834472417831421,
                    0.04739862307906151,
                    0.03657737001776695,
                    -0.07619059085845947,
                    0.09232189506292343,
                    0.004244355950504541,
                    0.02574169635772705,
                    0.011715192347764969,
                    0.06756599992513657,
                    0.08089843392372131,
                    0.023375922814011574,
                    0.011189969256520271,
                    0.04027453809976578,
                    -0.03770775347948074,
                    0.08053816854953766,
                    -0.05542124807834625,
                    -0.027791457250714302,
                    0.10760566592216492,
                    0.051364511251449585,
                    0.09283068031072617,
                    0.0006717010983265936,
                    -0.05180276557803154,
                    0.09171056747436523,
                    0.040953293442726135,
                    0.017174389213323593,
                    0.10888108611106873,
                    0.05669201910495758,
                    -0.03734496980905533,
                    0.0517704114317894,
                    0.006522710435092449,
                    -0.07903377711772919,
                    -0.019843045622110367,
                    0.018525222316384315,
                    -0.09534262120723724,
                    -0.09973494708538055,
                    -0.005331085994839668,
                    0.07523748278617859,
                    0.09692258387804031,
                    0.012917165644466877,
                    -0.014103973284363747,
                    -0.06828787922859192,
                    0.03093266859650612,
                    -0.01802190952003002,
                    0.11711977422237396,
                    0.01326272077858448,
                    0.02336224541068077,
                    -0.014578569680452347,
                    0.024309618398547173,
                    0.023636776953935623,
                    0.015744756907224655,
                    -0.07427741587162018,
                    0.05950314924120903,
                    0.03629150241613388,
                    0.021797936409711838,
                    0.018200846388936043,
                    0.0427866168320179,
                    0.059729382395744324,
                    0.0022307545877993107,
                    0.028860807418823242,
                    0.08254958689212799,
                    0.004169098101556301,
                    -0.03411279618740082,
                    -0.017995592206716537,
                    -0.03378648683428764,
                    -0.08691957592964172,
                    -0.009010633453726768,
                    0.03198854625225067,
                    0.02105281874537468,
                    0.020054683089256287,
                    -0.09683050215244293,
                    -0.05243600159883499,
                    0.01051334384828806,
                    0.06065747141838074,
                    -0.09759148955345154,
                    0.03901154547929764,
                    -0.0001977803185582161,
                    -0.09399065375328064,
                    0.01747877150774002,
                    -0.02172255888581276,
                    0.044903889298439026,
                    -0.01448741927742958,
                    -0.10660219192504883,
                    0.02315923199057579,
                    -0.012060029432177544,
                    0.09572212398052216,
                    -0.05559515580534935,
                    0.05848758667707443,
                    -0.03385809436440468,
                    0.04947958141565323,
                    -0.06591025739908218,
                    0.04897024855017662,
                    -0.07694046944379807,
                    0.09571461379528046,
                    0.06930718570947647,
                    0.11581963300704956,
                    -0.01650749146938324,
                    -0.016988033428788185,
                    -0.004119757562875748,
                    0.06015321612358093,
                    0.09531301259994507,
                    -0.016856038942933083,
                    0.007234044373035431,
                    -0.06295284628868103,
                    -0.05481552332639694,
                    -0.07030656933784485,
                    -0.06100836396217346,
                    0.12546372413635254,
                    -0.04298795014619827,
                    0.04993509501218796,
                    0.045961540192365646,
                    0.07976032793521881,
                    0.03813733905553818,
                    0.019289404153823853,
                    -0.0048421467654407024,
                    -0.06344124674797058,
                    -0.04026360437273979,
                    -0.03898400813341141,
                    -0.08852817118167877,
                    0.028609201312065125,
                    -0.03867480158805847,
                    -0.06580115109682083,
                    -0.011532868258655071,
                    0.013899620622396469,
                    0.03309406712651253,
                    0.02067520096898079,
                    -0.0182737298309803,
                    0.026948317885398865,
                    -0.03280699998140335,
                    -0.015294650569558144,
                    0.1363542228937149,
                    -0.03021986037492752,
                    -0.014017067849636078,
                    -0.055107854306697845,
                    -0.024432264268398285,
                    -0.006087488494813442,
                    0.08147057890892029,
                    -0.014888869598507881,
                    -0.019699059426784515
                ],
                "diffText": "diff --git a/src/ICMPinfo.cpp b/src/ICMPinfo.cpp\nindex f7f234fb1..f6ccfdeb8 100644\n--- a/src/ICMPinfo.cpp\n+++ b/src/ICMPinfo.cpp\n@@ -100,25 +100,20 @@ void ICMPinfo::dissectICMP(u_int16_t const payload_len,\n     icmp_type = payload_data[0], icmp_code = payload_data[1];\n \n     if (icmp_type == ICMP_DEST_UNREACH && icmp_code == ICMP_PORT_UNREACH &&\n-        payload_len >= sizeof(struct ndpi_iphdr)) {\n-      struct ndpi_iphdr *icmp_port_unreach_ip =\n-          (struct ndpi_iphdr *)&payload_data[8];\n-      u_short icmp_port_unreach_iph_len =\n-          (u_short)(icmp_port_unreach_ip->ihl * 4);\n-\n-      if (payload_len >=\n-              icmp_port_unreach_iph_len + sizeof(struct ndpi_udphdr) &&\n-          icmp_port_unreach_ip->protocol == IPPROTO_UDP &&\n-          (unreach ||\n-           (unreach = (unreachable_t *)calloc(1, sizeof(*unreach))))) {\n-        struct ndpi_udphdr *icmp_port_unreach_udp =\n-            (struct ndpi_udphdr *)&payload_data[8 + icmp_port_unreach_iph_len];\n-\n+        payload_len >= (sizeof(struct ndpi_iphdr) + 8)) {\n+      struct ndpi_iphdr *icmp_port_unreach_ip = (struct ndpi_iphdr *)&payload_data[8];\n+      u_short icmp_port_unreach_iph_len = (u_short)(icmp_port_unreach_ip->ihl * 4);\n+\n+      if ((payload_len >= (8 + icmp_port_unreach_iph_len + sizeof(struct ndpi_udphdr)))\n+\t  && (icmp_port_unreach_ip->protocol == IPPROTO_UDP)\n+\t  && (unreach || (unreach = (unreachable_t *)calloc(1, sizeof(*unreach))))) {\n+        struct ndpi_udphdr *icmp_port_unreach_udp = (struct ndpi_udphdr *)&payload_data[8 + icmp_port_unreach_iph_len];\n+\t\n         unreach->src_ip.set(icmp_port_unreach_ip->saddr),\n-            unreach->dst_ip.set(icmp_port_unreach_ip->daddr),\n-            unreach->src_port = icmp_port_unreach_udp->source,\n-            unreach->dst_port = icmp_port_unreach_udp->dest,\n-            unreach->protocol = icmp_port_unreach_ip->protocol;\n+\t  unreach->dst_ip.set(icmp_port_unreach_ip->daddr),\n+\t  unreach->src_port = icmp_port_unreach_udp->source,\n+\t  unreach->dst_port = icmp_port_unreach_udp->dest,\n+\t  unreach->protocol = icmp_port_unreach_ip->protocol;\n       }\n     } else if ((icmp_type == ICMP_ECHO || icmp_type == ICMP_ECHOREPLY ||\n                 icmp_type == ICMP_TIMESTAMP ||"
            }
        },
        "relation2": {
            "identity": 22238,
            "start": 10749,
            "end": 10743,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 10743,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-ntopng-61836"
            }
        }
    },
    {
        "baseNode": {
            "identity": 10743,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-ntopng-61836"
            }
        },
        "relation1": {
            "identity": 22238,
            "start": 10743,
            "end": 10749,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 10749,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.08427984267473221,
                    0.011863111518323421,
                    -0.09953013062477112,
                    -0.03833712637424469,
                    0.006482996046543121,
                    -0.001236051321029663,
                    0.054541945457458496,
                    0.12055232375860214,
                    -0.1115032210946083,
                    -0.10927531868219376,
                    -0.02285689488053322,
                    0.11667431890964508,
                    0.03137623146176338,
                    0.017738327383995056,
                    0.07482397556304932,
                    -0.061200760304927826,
                    0.08362192660570145,
                    0.06157601624727249,
                    0.0819149762392044,
                    0.017152298241853714,
                    -0.07969861477613449,
                    -0.01731681264936924,
                    -0.06740911304950714,
                    0.09139072895050049,
                    0.04832109063863754,
                    0.030111201107501984,
                    -0.05471355840563774,
                    0.0349372960627079,
                    0.030370723456144333,
                    0.049058571457862854,
                    -0.060174278914928436,
                    -0.1286393702030182,
                    0.060943201184272766,
                    -0.008386020548641682,
                    -0.05521632730960846,
                    -0.12672144174575806,
                    -0.06593865156173706,
                    0.011516734957695007,
                    -0.004907581023871899,
                    0.08054084330797195,
                    -0.06365831196308136,
                    -0.17317351698875427,
                    0.08925913274288177,
                    0.03903759643435478,
                    -0.061628542840480804,
                    0.004904206842184067,
                    -0.019969860091805458,
                    -0.028047824278473854,
                    -0.01912683993577957,
                    0.0011086617596447468,
                    -0.02658923901617527,
                    0.06171058118343353,
                    -0.09720470011234283,
                    -0.046570248901844025,
                    -0.06911656260490417,
                    -0.05816594138741493,
                    -0.04719849303364754,
                    -0.02061278186738491,
                    -0.05951530858874321,
                    0.09926868975162506,
                    -0.17876148223876953,
                    -0.03845423832535744,
                    0.010258659720420837,
                    0.024838650599122047,
                    0.0724668949842453,
                    0.0932830348610878,
                    -0.012899262830615044,
                    0.019285667687654495,
                    0.04704497009515762,
                    -0.05693505331873894,
                    0.08727452158927917,
                    0.07781762629747391,
                    -0.04769117385149002,
                    -0.06556540727615356,
                    -0.014352705329656601,
                    -0.06361530721187592,
                    0.030635546892881393,
                    -0.05668020248413086,
                    0.004047101829200983,
                    -0.1324595808982849,
                    0.03316682204604149,
                    0.07414508610963821,
                    0.03833268955349922,
                    0.008454638533294201,
                    0.08090706169605255,
                    0.006269689649343491,
                    0.08511386811733246,
                    0.052860669791698456,
                    -0.02245299331843853,
                    -0.026493895798921585,
                    0.05678032338619232,
                    -0.10316511988639832,
                    0.060391657054424286,
                    -0.07958449423313141,
                    0.017996355891227722,
                    0.009271019138395786,
                    0.03769507259130478,
                    -0.012123224325478077,
                    0.01594545878469944,
                    -0.0479760468006134,
                    0.027671270072460175,
                    -0.06629489362239838,
                    -0.051047734916210175,
                    -0.04677531495690346,
                    -0.03045007959008217,
                    -0.010927814990282059,
                    -0.0798024982213974,
                    -0.023712947964668274,
                    -0.024800287559628487,
                    -0.08741161972284317,
                    0.06212788075208664,
                    -0.008497759699821472,
                    -0.0318693146109581,
                    -0.0068669747561216354,
                    0.04435529187321663,
                    -0.030130749568343163,
                    -0.13085000216960907,
                    -0.06109274551272392,
                    -0.011834472417831421,
                    0.04739862307906151,
                    0.03657737001776695,
                    -0.07619059085845947,
                    0.09232189506292343,
                    0.004244355950504541,
                    0.02574169635772705,
                    0.011715192347764969,
                    0.06756599992513657,
                    0.08089843392372131,
                    0.023375922814011574,
                    0.011189969256520271,
                    0.04027453809976578,
                    -0.03770775347948074,
                    0.08053816854953766,
                    -0.05542124807834625,
                    -0.027791457250714302,
                    0.10760566592216492,
                    0.051364511251449585,
                    0.09283068031072617,
                    0.0006717010983265936,
                    -0.05180276557803154,
                    0.09171056747436523,
                    0.040953293442726135,
                    0.017174389213323593,
                    0.10888108611106873,
                    0.05669201910495758,
                    -0.03734496980905533,
                    0.0517704114317894,
                    0.006522710435092449,
                    -0.07903377711772919,
                    -0.019843045622110367,
                    0.018525222316384315,
                    -0.09534262120723724,
                    -0.09973494708538055,
                    -0.005331085994839668,
                    0.07523748278617859,
                    0.09692258387804031,
                    0.012917165644466877,
                    -0.014103973284363747,
                    -0.06828787922859192,
                    0.03093266859650612,
                    -0.01802190952003002,
                    0.11711977422237396,
                    0.01326272077858448,
                    0.02336224541068077,
                    -0.014578569680452347,
                    0.024309618398547173,
                    0.023636776953935623,
                    0.015744756907224655,
                    -0.07427741587162018,
                    0.05950314924120903,
                    0.03629150241613388,
                    0.021797936409711838,
                    0.018200846388936043,
                    0.0427866168320179,
                    0.059729382395744324,
                    0.0022307545877993107,
                    0.028860807418823242,
                    0.08254958689212799,
                    0.004169098101556301,
                    -0.03411279618740082,
                    -0.017995592206716537,
                    -0.03378648683428764,
                    -0.08691957592964172,
                    -0.009010633453726768,
                    0.03198854625225067,
                    0.02105281874537468,
                    0.020054683089256287,
                    -0.09683050215244293,
                    -0.05243600159883499,
                    0.01051334384828806,
                    0.06065747141838074,
                    -0.09759148955345154,
                    0.03901154547929764,
                    -0.0001977803185582161,
                    -0.09399065375328064,
                    0.01747877150774002,
                    -0.02172255888581276,
                    0.044903889298439026,
                    -0.01448741927742958,
                    -0.10660219192504883,
                    0.02315923199057579,
                    -0.012060029432177544,
                    0.09572212398052216,
                    -0.05559515580534935,
                    0.05848758667707443,
                    -0.03385809436440468,
                    0.04947958141565323,
                    -0.06591025739908218,
                    0.04897024855017662,
                    -0.07694046944379807,
                    0.09571461379528046,
                    0.06930718570947647,
                    0.11581963300704956,
                    -0.01650749146938324,
                    -0.016988033428788185,
                    -0.004119757562875748,
                    0.06015321612358093,
                    0.09531301259994507,
                    -0.016856038942933083,
                    0.007234044373035431,
                    -0.06295284628868103,
                    -0.05481552332639694,
                    -0.07030656933784485,
                    -0.06100836396217346,
                    0.12546372413635254,
                    -0.04298795014619827,
                    0.04993509501218796,
                    0.045961540192365646,
                    0.07976032793521881,
                    0.03813733905553818,
                    0.019289404153823853,
                    -0.0048421467654407024,
                    -0.06344124674797058,
                    -0.04026360437273979,
                    -0.03898400813341141,
                    -0.08852817118167877,
                    0.028609201312065125,
                    -0.03867480158805847,
                    -0.06580115109682083,
                    -0.011532868258655071,
                    0.013899620622396469,
                    0.03309406712651253,
                    0.02067520096898079,
                    -0.0182737298309803,
                    0.026948317885398865,
                    -0.03280699998140335,
                    -0.015294650569558144,
                    0.1363542228937149,
                    -0.03021986037492752,
                    -0.014017067849636078,
                    -0.055107854306697845,
                    -0.024432264268398285,
                    -0.006087488494813442,
                    0.08147057890892029,
                    -0.014888869598507881,
                    -0.019699059426784515
                ],
                "diffText": "diff --git a/src/ICMPinfo.cpp b/src/ICMPinfo.cpp\nindex f7f234fb1..f6ccfdeb8 100644\n--- a/src/ICMPinfo.cpp\n+++ b/src/ICMPinfo.cpp\n@@ -100,25 +100,20 @@ void ICMPinfo::dissectICMP(u_int16_t const payload_len,\n     icmp_type = payload_data[0], icmp_code = payload_data[1];\n \n     if (icmp_type == ICMP_DEST_UNREACH && icmp_code == ICMP_PORT_UNREACH &&\n-        payload_len >= sizeof(struct ndpi_iphdr)) {\n-      struct ndpi_iphdr *icmp_port_unreach_ip =\n-          (struct ndpi_iphdr *)&payload_data[8];\n-      u_short icmp_port_unreach_iph_len =\n-          (u_short)(icmp_port_unreach_ip->ihl * 4);\n-\n-      if (payload_len >=\n-              icmp_port_unreach_iph_len + sizeof(struct ndpi_udphdr) &&\n-          icmp_port_unreach_ip->protocol == IPPROTO_UDP &&\n-          (unreach ||\n-           (unreach = (unreachable_t *)calloc(1, sizeof(*unreach))))) {\n-        struct ndpi_udphdr *icmp_port_unreach_udp =\n-            (struct ndpi_udphdr *)&payload_data[8 + icmp_port_unreach_iph_len];\n-\n+        payload_len >= (sizeof(struct ndpi_iphdr) + 8)) {\n+      struct ndpi_iphdr *icmp_port_unreach_ip = (struct ndpi_iphdr *)&payload_data[8];\n+      u_short icmp_port_unreach_iph_len = (u_short)(icmp_port_unreach_ip->ihl * 4);\n+\n+      if ((payload_len >= (8 + icmp_port_unreach_iph_len + sizeof(struct ndpi_udphdr)))\n+\t  && (icmp_port_unreach_ip->protocol == IPPROTO_UDP)\n+\t  && (unreach || (unreach = (unreachable_t *)calloc(1, sizeof(*unreach))))) {\n+        struct ndpi_udphdr *icmp_port_unreach_udp = (struct ndpi_udphdr *)&payload_data[8 + icmp_port_unreach_iph_len];\n+\t\n         unreach->src_ip.set(icmp_port_unreach_ip->saddr),\n-            unreach->dst_ip.set(icmp_port_unreach_ip->daddr),\n-            unreach->src_port = icmp_port_unreach_udp->source,\n-            unreach->dst_port = icmp_port_unreach_udp->dest,\n-            unreach->protocol = icmp_port_unreach_ip->protocol;\n+\t  unreach->dst_ip.set(icmp_port_unreach_ip->daddr),\n+\t  unreach->src_port = icmp_port_unreach_udp->source,\n+\t  unreach->dst_port = icmp_port_unreach_udp->dest,\n+\t  unreach->protocol = icmp_port_unreach_ip->protocol;\n       }\n     } else if ((icmp_type == ICMP_ECHO || icmp_type == ICMP_ECHOREPLY ||\n                 icmp_type == ICMP_TIMESTAMP ||"
            }
        },
        "relation2": {
            "identity": 22237,
            "start": 10749,
            "end": 10748,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 10748,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "src/ICMPinfo.cpp"
            }
        }
    },
    {
        "baseNode": {
            "identity": 10743,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-ntopng-61836"
            }
        },
        "relation1": {
            "identity": 22234,
            "start": 10743,
            "end": 137,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 137,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "ntopng"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 10743,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-ntopng-61836"
            }
        },
        "relation1": {
            "identity": 22233,
            "start": 10743,
            "end": 10747,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 10747,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "Running LLVMFuzzerInitialize ...\ncontinue...\nReading 114 bytes from /tmp/poc\n20/Mar/2024 22:51:28 [NetworkInterface.cpp:2421] WARNING: If TSO/GRO is enabled, please disable it for best accuracy\n20/Mar/2024 22:51:28 [NetworkInterface.cpp:2426] WARNING: using: sudo ethtool -K custom gro off gso off tso off\n=================================================================\n==1==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x606000eabee0 at pc 0x00000078c81e bp 0x7ffdad21ef10 sp 0x7ffdad21ef08\nREAD of size 4 at 0x606000eabee0 thread T0\nSCARINESS: 17 (4-byte-read-heap-buffer-overflow)\n    #0 0x78c81d in ICMPinfo::dissectICMP(unsigned short, unsigned char const*) /src/ntopng/src/ICMPinfo.cpp:118:55\n    #1 0x7d69e9 in NetworkInterface::processPacket(unsigned int, bool, timeval const*, unsigned long, ndpi_ethhdr*, unsigned short, ndpi_iphdr*, ndpi_ipv6hdr*, unsigned short, unsigned short, unsigned int, pcap_pkthdr const*, unsigned char const*, unsigned short*, Host**, Host**, Flow**) /src/ntopng/src/NetworkInterface.cpp:1824:15\n    #2 0x7e3a6e in NetworkInterface::dissectPacket(unsigned int, bool, unsigned char*, pcap_pkthdr const*, unsigned char const*, unsigned short*, Host**, Host**, Flow**) /src/ntopng/src/NetworkInterface.cpp:2973:28\n    #3 0x4e9445 in LLVMFuzzerTestOneInput /src/ntopng/fuzz/fuzz_dissect_packet.cpp:197:16\n    #4 0x4e834a in ExecuteFilesOnyByOne /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:234:7\n    #5 0x4e811c in main /src/aflplusplus/utils/aflpp_driver/aflpp_driver.c:318:12\n    #6 0x7f91649cc082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: eebe5d5f4b608b8a53ec446b63981bba373ca0ca)\n    #7 0x4294cd in _start (/out/fuzz_dissect_packet+0x4294cd)\n\nDEDUP_TOKEN: ICMPinfo::dissectICMP(unsigned short, unsigned char const*)--NetworkInterface::processPacket(unsigned int, bool, timeval const*, unsigned long, ndpi_ethhdr*, unsigned short, ndpi_iphdr*, ndpi_ipv6hdr*, unsigned short, unsigned short, unsigned int, pcap_pkthdr const*, unsigned char const*, unsigned short*, Host**, Host**, Flow**)--NetworkInterface::dissectPacket(unsigned int, bool, unsigned char*, pcap_pkthdr const*, unsigned char const*, unsigned short*, Host**, Host**, Flow**)\n0x606000eabee0 is located 0 bytes to the right of 64-byte region [0x606000eabea0,0x606000eabee0)\nallocated by thread T0 here:\n    #0 0x4aad0c in __interceptor_realloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:85:3\n    #1 0x9bc1d1 in grow_buffer /src/libpcap-1.9.1/./sf-pcap.c:426:18\n    #2 0x9bc1d1 in pcap_next_packet /src/libpcap-1.9.1/./sf-pcap.c:604:9\n\nDEDUP_TOKEN: __interceptor_realloc--grow_buffer--pcap_next_packet\nSUMMARY: AddressSanitizer: heap-buffer-overflow /src/ntopng/src/ICMPinfo.cpp:118:55 in ICMPinfo::dissectICMP(unsigned short, unsigned char const*)\nShadow bytes around the buggy address:\n  0x0c0c801cd780: 00 00 00 00 00 00 00 00 fa fa fa fa 00 00 00 00\n  0x0c0c801cd790: 00 00 00 00 fa fa fa fa 00 00 00 00 00 00 00 00\n  0x0c0c801cd7a0: fa fa fa fa 00 00 00 00 00 00 00 00 fa fa fa fa\n  0x0c0c801cd7b0: fd fd fd fd fd fd fd fa fa fa fa fa fd fd fd fd\n  0x0c0c801cd7c0: fd fd fd fa fa fa fa fa fd fd fd fd fd fd fd fd\n=>0x0c0c801cd7d0: fa fa fa fa 00 00 00 00 00 00 00 00[fa]fa fa fa\n  0x0c0c801cd7e0: 00 00 00 00 00 00 00 fa fa fa fa fa fa fa fa fa\n  0x0c0c801cd7f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c0c801cd800: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c0c801cd810: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c0c801cd820: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    -0.003825465217232704,
                    0.05366189405322075,
                    -0.0925050601363182,
                    -0.029112987220287323,
                    -0.031046511605381966,
                    0.015479084104299545,
                    -0.0053056045435369015,
                    0.04402337595820427,
                    0.02903163805603981,
                    -0.023845020681619644,
                    -0.016660677269101143,
                    0.044422589242458344,
                    -0.02762802504003048,
                    -0.009791049174964428,
                    0.009533633477985859,
                    -0.00464749475941062,
                    0.10997289419174194,
                    0.03903868794441223,
                    0.026278428733348846,
                    -0.005183335393667221,
                    -0.018344342708587646,
                    0.0420592837035656,
                    -0.03822933882474899,
                    -0.006811132654547691,
                    0.007969568483531475,
                    0.023497771471738815,
                    -0.11796222627162933,
                    -0.012476430274546146,
                    -0.02563776634633541,
                    -0.027671657502651215,
                    -0.10470930486917496,
                    -0.1382719874382019,
                    -0.03149682655930519,
                    -0.03659867122769356,
                    -0.023082956671714783,
                    -0.01447677705436945,
                    -0.0089258449152112,
                    0.012157304212450981,
                    0.018553219735622406,
                    0.09407996386289597,
                    -0.0621773861348629,
                    -0.09288772940635681,
                    0.026560798287391663,
                    0.0011935587972402573,
                    -0.07555395364761353,
                    0.020362460985779762,
                    -0.01474311575293541,
                    -0.045951589941978455,
                    -0.024958066642284393,
                    -0.03833157941699028,
                    -0.0711541697382927,
                    0.01741417869925499,
                    -0.07370149344205856,
                    -0.053104981780052185,
                    -0.039931025356054306,
                    -0.03046542964875698,
                    0.03557272255420685,
                    0.007893973030149937,
                    -0.07842601835727692,
                    0.07833904027938843,
                    -0.0637829378247261,
                    -0.07013338804244995,
                    0.021373849362134933,
                    0.002003910718485713,
                    0.0005418471992015839,
                    0.06441646069288254,
                    0.05661012977361679,
                    0.05407102406024933,
                    0.0216809194535017,
                    -0.037498850375413895,
                    0.013108477927744389,
                    0.16712570190429688,
                    -0.060381773859262466,
                    -0.08570732176303864,
                    -0.016573766246438026,
                    0.02366263046860695,
                    -0.037138231098651886,
                    -0.03652490675449371,
                    -0.023479130119085312,
                    -0.1243286207318306,
                    -0.01250658929347992,
                    0.013356003910303116,
                    0.045996613800525665,
                    0.037457868456840515,
                    0.0661453977227211,
                    0.007093014195561409,
                    0.01637311279773712,
                    -0.022382155060768127,
                    -0.01623808965086937,
                    0.010477260686457157,
                    0.07999879866838455,
                    -0.11000536382198334,
                    0.01286403089761734,
                    -0.03099595196545124,
                    0.033798810094594955,
                    0.008089474402368069,
                    0.01932239532470703,
                    -0.04469216242432594,
                    -0.040023159235715866,
                    -0.016804110258817673,
                    0.0028493115678429604,
                    -0.03355031460523605,
                    -0.06637657433748245,
                    -0.03943728655576706,
                    -0.059335172176361084,
                    -0.011569298803806305,
                    -0.08242445439100266,
                    -0.017793074250221252,
                    0.003852879861369729,
                    -0.033116664737463,
                    0.009037712588906288,
                    -0.045196402817964554,
                    -0.03354640305042267,
                    0.0021209577098488808,
                    0.026093175634741783,
                    0.006507404148578644,
                    -0.06364412605762482,
                    -0.04104158282279968,
                    -0.006749609485268593,
                    0.05945916846394539,
                    0.04967770352959633,
                    -0.009757538326084614,
                    0.017826873809099197,
                    -0.021970899775624275,
                    0.015184137038886547,
                    0.039170943200588226,
                    0.0702432319521904,
                    0.00706636905670166,
                    0.06656739115715027,
                    0.07341691851615906,
                    -0.029254570603370667,
                    0.009675039909780025,
                    0.08205527067184448,
                    -0.0016763536259531975,
                    -0.004031728953123093,
                    0.06057227402925491,
                    0.07838040590286255,
                    -0.002393364906311035,
                    0.00660500256344676,
                    -0.055757276713848114,
                    0.07760913670063019,
                    0.010912811383605003,
                    -0.0004729420761577785,
                    0.03646456450223923,
                    0.02210661582648754,
                    -0.04139694944024086,
                    0.031140681356191635,
                    0.02023455873131752,
                    -0.03263074532151222,
                    0.005936942994594574,
                    -0.004908585920929909,
                    -0.04040885344147682,
                    -0.06463437527418137,
                    -0.034683745354413986,
                    0.013047817163169384,
                    -0.017141494899988174,
                    -0.01653369888663292,
                    -0.05242985859513283,
                    -0.02880195342004299,
                    0.00552835687994957,
                    0.007085384801030159,
                    0.10603949427604675,
                    0.0065094782039523125,
                    0.1226850375533104,
                    -0.004833064042031765,
                    0.10409528017044067,
                    -0.04486137628555298,
                    0.02356112189590931,
                    0.004932158626616001,
                    0.006443542428314686,
                    0.008310437202453613,
                    -0.00833540316671133,
                    0.026127301156520844,
                    0.009598497301340103,
                    0.009291371330618858,
                    -0.02732899785041809,
                    0.016759473830461502,
                    0.05770019441843033,
                    0.037133604288101196,
                    0.03160836547613144,
                    0.022839121520519257,
                    0.040842846035957336,
                    -0.019784031435847282,
                    -0.046191249042749405,
                    -0.02428019791841507,
                    0.032014988362789154,
                    -0.05239694193005562,
                    -0.03031831979751587,
                    -0.052029795944690704,
                    0.021440282464027405,
                    0.03634782135486603,
                    -0.06812648475170135,
                    0.04367519170045853,
                    -0.023470260202884674,
                    -0.1116710901260376,
                    -0.014705242589116096,
                    0.003323388285934925,
                    0.03185619041323662,
                    -0.028865985572338104,
                    -0.06820137798786163,
                    -0.0017526387237012386,
                    -0.037959806621074677,
                    0.04843919724225998,
                    -0.00587083213031292,
                    0.028231896460056305,
                    -0.04590378701686859,
                    0.07952895760536194,
                    -0.04500342160463333,
                    0.05688305199146271,
                    -0.0054794056341052055,
                    0.004484544508159161,
                    -0.007794942706823349,
                    0.08894332498311996,
                    0.0051441192626953125,
                    -0.03566811978816986,
                    -0.040100425481796265,
                    0.07412208616733551,
                    -0.009611137211322784,
                    -0.040405888110399246,
                    0.020565543323755264,
                    -0.06128435581922531,
                    -0.022898908704519272,
                    -0.10018687695264816,
                    -0.025256233289837837,
                    0.06932424753904343,
                    -0.040102072060108185,
                    0.031135987490415573,
                    0.06837369501590729,
                    0.09298448264598846,
                    0.054222721606492996,
                    -0.0698237493634224,
                    -0.0019418001174926758,
                    -0.027676904574036598,
                    0.012025231495499611,
                    0.01871626265347004,
                    -0.04286433011293411,
                    0.02275637537240982,
                    -0.0014608828350901604,
                    -0.046062108129262924,
                    -0.012049572542309761,
                    0.02020406164228916,
                    0.015807325020432472,
                    -0.009504474699497223,
                    -0.01845359615981579,
                    0.07844886928796768,
                    -0.04090122506022453,
                    -0.046270325779914856,
                    0.07722154259681702,
                    -0.025435183197259903,
                    0.04290147125720978,
                    -0.09178195148706436,
                    0.0057550882920622826,
                    0.07729096710681915,
                    0.01574762538075447,
                    0.029932452365756035,
                    -0.01878722757101059
                ],
                "report_type": "Heap-buffer-overflow READ 4",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 10743,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-ntopng-61836"
            }
        },
        "relation1": {
            "identity": 22232,
            "start": 10743,
            "end": 10746,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 10746,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Fixes in Heap-buffer-overflow in ICMPinfo::dissectICMP\n",
                "sha": "8397540abaf6906979da66b718195d6ed5587861",
                "repo": "ntopng",
                "encoding": "UTF-8",
                "authored_date": 1700567659,
                "committer_tz_offset": -3600,
                "author_tz_offset": -3600,
                "committed_date": 1700567659
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 10743,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-ntopng-61836"
            }
        },
        "relation1": {
            "identity": 22227,
            "start": 10743,
            "end": 10744,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 10744,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "[VS] Fix sort issues on last scan and last duration columns. (#8038) (#8039)\n",
                "sha": "b83e1e13c0356f22bbb24daa2a6a571855f457a8",
                "repo": "ntopng",
                "encoding": "UTF-8",
                "authored_date": 1700566285,
                "committer_tz_offset": -3600,
                "author_tz_offset": -3600,
                "committed_date": 1700566285
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]