[
    {
        "baseNode": {
            "identity": 6285,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-61718"
            }
        },
        "relation1": {
            "identity": 12524,
            "start": 6285,
            "end": 6292,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 6292,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.06456364691257477,
                    0.03558880463242531,
                    -0.0718153640627861,
                    0.06290522962808609,
                    -0.08133964240550995,
                    -0.0271974578499794,
                    -0.0022353604435920715,
                    0.0014712726697325706,
                    0.04067789018154144,
                    -0.07237657159566879,
                    0.024593733251094818,
                    0.1016458198428154,
                    -0.10359819233417511,
                    -0.03061356022953987,
                    0.0017711762338876724,
                    -0.016750242561101913,
                    0.05227953940629959,
                    -0.056890495121479034,
                    0.0605723112821579,
                    0.04330885410308838,
                    -0.03328182175755501,
                    0.018662389367818832,
                    0.03940001502633095,
                    -0.0513518787920475,
                    0.03432130441069603,
                    0.05446712672710419,
                    -0.08836276829242706,
                    0.06465059518814087,
                    0.060735613107681274,
                    0.06220969557762146,
                    -0.049445368349552155,
                    -0.1713513433933258,
                    -0.06736160814762115,
                    0.04488997161388397,
                    -0.019069621339440346,
                    0.02678239345550537,
                    -0.009252902120351791,
                    -0.06759384274482727,
                    -0.002779813949018717,
                    0.11282070726156235,
                    -0.10416940599679947,
                    -0.04805999994277954,
                    0.058304376900196075,
                    0.00017871928866952658,
                    -0.05946538597345352,
                    0.039889559149742126,
                    0.013763337396085262,
                    -0.05254465341567993,
                    0.018829716369509697,
                    0.003945003263652325,
                    -0.025187131017446518,
                    -0.04063823074102402,
                    -0.0696123018860817,
                    0.03420579805970192,
                    -0.08889470994472504,
                    0.0760604664683342,
                    -0.02732113003730774,
                    -0.002295922487974167,
                    -0.1070556715130806,
                    0.03946475684642792,
                    -0.054928816854953766,
                    -0.06835488229990005,
                    -0.09982924163341522,
                    0.0460205152630806,
                    0.044022493064403534,
                    0.03529331460595131,
                    0.06463204324245453,
                    -0.02873302437365055,
                    0.05847792327404022,
                    -0.09395867586135864,
                    0.03678419813513756,
                    -0.021915186196565628,
                    -0.07114206999540329,
                    0.06018584966659546,
                    -0.08381690084934235,
                    -0.016936134546995163,
                    -0.07073412835597992,
                    -0.048473529517650604,
                    -0.04684244841337204,
                    -0.10261479020118713,
                    -0.01797737367451191,
                    0.03424479812383652,
                    -0.001325453631579876,
                    -0.007379873190075159,
                    0.04616376757621765,
                    -0.022105418145656586,
                    0.0991273820400238,
                    -0.025628739967942238,
                    0.04991879314184189,
                    -0.022546719759702682,
                    0.012622233480215073,
                    0.02892099693417549,
                    0.04503884166479111,
                    -0.0458190031349659,
                    -0.07713903486728668,
                    -0.051999904215335846,
                    -0.04896864295005798,
                    -0.057185422629117966,
                    -0.027623869478702545,
                    0.06252653896808624,
                    -0.01785125583410263,
                    -0.038185231387615204,
                    -0.05611516535282135,
                    -0.058257780969142914,
                    -0.0660039484500885,
                    -0.07304572314023972,
                    -0.09531459212303162,
                    0.034319378435611725,
                    -0.034407030791044235,
                    -0.02590220421552658,
                    0.02316087670624256,
                    0.008377613499760628,
                    0.015828847885131836,
                    -0.006481924094259739,
                    -0.016777964308857918,
                    -0.06482671946287155,
                    0.05934283882379532,
                    -0.015112084336578846,
                    0.012392014265060425,
                    0.04609973728656769,
                    -0.0010219430550932884,
                    0.07549794018268585,
                    0.02240038849413395,
                    -0.014364565722644329,
                    0.004329088609665632,
                    -0.008409741334617138,
                    0.0336189903318882,
                    0.0521169938147068,
                    0.07094252109527588,
                    0.13277891278266907,
                    -0.010861029848456383,
                    -0.06983281672000885,
                    -0.036233142018318176,
                    -0.06198524683713913,
                    -0.002581818960607052,
                    0.010766085237264633,
                    0.0981777012348175,
                    0.013886259868741035,
                    0.02507833205163479,
                    -0.017301393672823906,
                    -0.025112729519605637,
                    0.04593619331717491,
                    0.027676614001393318,
                    0.07518534362316132,
                    0.010132437571883202,
                    -0.03637297451496124,
                    0.07105276733636856,
                    -0.009848782792687416,
                    -0.06686148792505264,
                    -0.062031298875808716,
                    0.019325613975524902,
                    -0.04232519119977951,
                    -0.06224618852138519,
                    0.021108923479914665,
                    0.06317746639251709,
                    0.0354970283806324,
                    -0.0319402739405632,
                    0.0008561490103602409,
                    -0.017062081024050713,
                    -0.030933372676372528,
                    0.03874496743083,
                    0.1627531200647354,
                    0.03565472736954689,
                    0.17895779013633728,
                    -0.009015643037855625,
                    0.02094000019133091,
                    -0.10064347088336945,
                    0.015581437386572361,
                    0.007872411981225014,
                    0.09848539531230927,
                    0.04572472721338272,
                    -0.014345159754157066,
                    0.01864948309957981,
                    0.048328422009944916,
                    0.07531554251909256,
                    -0.09262176603078842,
                    -0.03395133092999458,
                    -0.01758650690317154,
                    0.06675703823566437,
                    -0.029085813090205193,
                    0.07161807268857956,
                    0.013105452992022038,
                    -0.1576024293899536,
                    -0.0522213950753212,
                    -0.00263264961540699,
                    0.03204077482223511,
                    -0.10323749482631683,
                    -0.11004692316055298,
                    -0.062189117074012756,
                    -0.03609837219119072,
                    -0.004000075161457062,
                    -0.004804803989827633,
                    0.04096073657274246,
                    -0.04383104294538498,
                    -0.10505546629428864,
                    0.030612705275416374,
                    0.0019258614629507065,
                    0.02493421360850334,
                    0.01348564587533474,
                    -0.14847931265830994,
                    -0.02895977348089218,
                    -0.05409305542707443,
                    -0.0061177401803433895,
                    -0.005754922050982714,
                    0.1306212693452835,
                    -0.03331613540649414,
                    0.07638218253850937,
                    -0.04470854625105858,
                    0.04291323199868202,
                    -0.06429149210453033,
                    0.0027054462116211653,
                    0.030476294457912445,
                    0.10820607841014862,
                    -0.002881922759115696,
                    0.067135751247406,
                    0.00991858635097742,
                    0.03304514288902283,
                    -0.03161471709609032,
                    -0.01913977786898613,
                    0.060245826840400696,
                    -0.03316428139805794,
                    0.014911912381649017,
                    -0.06992527097463608,
                    0.01905379816889763,
                    0.05265086889266968,
                    0.021036669611930847,
                    0.08830662071704865,
                    0.025845225900411606,
                    0.1133025586605072,
                    0.07294891029596329,
                    0.012649402022361755,
                    0.0134184081107378,
                    0.12139066308736801,
                    -0.04601898416876793,
                    0.003123082220554352,
                    -0.08147545158863068,
                    -0.026270732283592224,
                    0.008666249923408031,
                    0.06457586586475372,
                    -0.022149374708533287,
                    0.05032239481806755,
                    0.01965658739209175,
                    -0.040032513439655304,
                    -0.05593813210725784,
                    -0.0037086615338921547,
                    -0.024062901735305786,
                    -0.06982788443565369,
                    0.0690363347530365,
                    -0.02503478154540062,
                    0.004200764000415802,
                    0.08252380788326263,
                    0.010731160640716553,
                    0.035175882279872894,
                    0.0803520604968071,
                    -0.11110502481460571,
                    -0.07655396312475204
                ],
                "diffText": "diff --git a/libheif/context.cc b/libheif/context.cc\nindex 359a5b7..ca1dfd9 100644\n--- a/libheif/context.cc\n+++ b/libheif/context.cc\n@@ -969,20 +969,33 @@ Error HeifContext::interpret_heif_file()\n             img_iter->second->add_region_item_id(id);\n             m_region_items.push_back(region_item);\n           }\n+\n           /* When the geometry 'mask' of a region is represented by a mask stored in\n           * another image item the image item containing the mask shall be identified\n           * by an item reference of type 'mask' from the region item to the image item\n           * containing the mask. */\n           if (ref.header.get_short_type() == fourcc(\"mask\")) {\n             std::vector<uint32_t> refs = ref.to_item_ID;\n-            int mask_index = 0;\n+            size_t mask_index = 0;\n             for (int j = 0; j < region_item->get_number_of_regions(); j++) {\n               if (region_item->get_regions()[j]->getRegionType() == heif_region_type_referenced_mask) {\n                 std::shared_ptr<RegionGeometry_ReferencedMask> mask_geometry = std::dynamic_pointer_cast<RegionGeometry_ReferencedMask>(region_item->get_regions()[j]);\n+\n+                if (mask_index >= refs.size()) {\n+                  return Error(heif_error_Invalid_input,\n+                               heif_suberror_Unspecified,\n+                               \"Region mask reference with non-existing mask image reference\");\n+                }\n+\n                 uint32_t mask_image_id = refs[mask_index];\n-                assert(is_image(mask_image_id));\n-                mask_geometry->referenced_item = mask_image_id;\n+                if (!is_image(mask_image_id)) {\n+                  return Error(heif_error_Invalid_input,\n+                               heif_suberror_Unspecified,\n+                               \"Region mask referenced item is not an image\");\n+                }\n+\n                 auto mask_image = m_all_images.find(mask_image_id)->second;\n+                mask_geometry->referenced_item = mask_image_id;\n                 if (mask_geometry->width == 0) {\n                   mask_geometry->width = mask_image->get_ispe_width();\n                 }"
            }
        },
        "relation2": {
            "identity": 12524,
            "start": 6292,
            "end": 6285,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 6285,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-61718"
            }
        }
    },
    {
        "baseNode": {
            "identity": 6285,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-61718"
            }
        },
        "relation1": {
            "identity": 12524,
            "start": 6285,
            "end": 6292,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 6292,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.06456364691257477,
                    0.03558880463242531,
                    -0.0718153640627861,
                    0.06290522962808609,
                    -0.08133964240550995,
                    -0.0271974578499794,
                    -0.0022353604435920715,
                    0.0014712726697325706,
                    0.04067789018154144,
                    -0.07237657159566879,
                    0.024593733251094818,
                    0.1016458198428154,
                    -0.10359819233417511,
                    -0.03061356022953987,
                    0.0017711762338876724,
                    -0.016750242561101913,
                    0.05227953940629959,
                    -0.056890495121479034,
                    0.0605723112821579,
                    0.04330885410308838,
                    -0.03328182175755501,
                    0.018662389367818832,
                    0.03940001502633095,
                    -0.0513518787920475,
                    0.03432130441069603,
                    0.05446712672710419,
                    -0.08836276829242706,
                    0.06465059518814087,
                    0.060735613107681274,
                    0.06220969557762146,
                    -0.049445368349552155,
                    -0.1713513433933258,
                    -0.06736160814762115,
                    0.04488997161388397,
                    -0.019069621339440346,
                    0.02678239345550537,
                    -0.009252902120351791,
                    -0.06759384274482727,
                    -0.002779813949018717,
                    0.11282070726156235,
                    -0.10416940599679947,
                    -0.04805999994277954,
                    0.058304376900196075,
                    0.00017871928866952658,
                    -0.05946538597345352,
                    0.039889559149742126,
                    0.013763337396085262,
                    -0.05254465341567993,
                    0.018829716369509697,
                    0.003945003263652325,
                    -0.025187131017446518,
                    -0.04063823074102402,
                    -0.0696123018860817,
                    0.03420579805970192,
                    -0.08889470994472504,
                    0.0760604664683342,
                    -0.02732113003730774,
                    -0.002295922487974167,
                    -0.1070556715130806,
                    0.03946475684642792,
                    -0.054928816854953766,
                    -0.06835488229990005,
                    -0.09982924163341522,
                    0.0460205152630806,
                    0.044022493064403534,
                    0.03529331460595131,
                    0.06463204324245453,
                    -0.02873302437365055,
                    0.05847792327404022,
                    -0.09395867586135864,
                    0.03678419813513756,
                    -0.021915186196565628,
                    -0.07114206999540329,
                    0.06018584966659546,
                    -0.08381690084934235,
                    -0.016936134546995163,
                    -0.07073412835597992,
                    -0.048473529517650604,
                    -0.04684244841337204,
                    -0.10261479020118713,
                    -0.01797737367451191,
                    0.03424479812383652,
                    -0.001325453631579876,
                    -0.007379873190075159,
                    0.04616376757621765,
                    -0.022105418145656586,
                    0.0991273820400238,
                    -0.025628739967942238,
                    0.04991879314184189,
                    -0.022546719759702682,
                    0.012622233480215073,
                    0.02892099693417549,
                    0.04503884166479111,
                    -0.0458190031349659,
                    -0.07713903486728668,
                    -0.051999904215335846,
                    -0.04896864295005798,
                    -0.057185422629117966,
                    -0.027623869478702545,
                    0.06252653896808624,
                    -0.01785125583410263,
                    -0.038185231387615204,
                    -0.05611516535282135,
                    -0.058257780969142914,
                    -0.0660039484500885,
                    -0.07304572314023972,
                    -0.09531459212303162,
                    0.034319378435611725,
                    -0.034407030791044235,
                    -0.02590220421552658,
                    0.02316087670624256,
                    0.008377613499760628,
                    0.015828847885131836,
                    -0.006481924094259739,
                    -0.016777964308857918,
                    -0.06482671946287155,
                    0.05934283882379532,
                    -0.015112084336578846,
                    0.012392014265060425,
                    0.04609973728656769,
                    -0.0010219430550932884,
                    0.07549794018268585,
                    0.02240038849413395,
                    -0.014364565722644329,
                    0.004329088609665632,
                    -0.008409741334617138,
                    0.0336189903318882,
                    0.0521169938147068,
                    0.07094252109527588,
                    0.13277891278266907,
                    -0.010861029848456383,
                    -0.06983281672000885,
                    -0.036233142018318176,
                    -0.06198524683713913,
                    -0.002581818960607052,
                    0.010766085237264633,
                    0.0981777012348175,
                    0.013886259868741035,
                    0.02507833205163479,
                    -0.017301393672823906,
                    -0.025112729519605637,
                    0.04593619331717491,
                    0.027676614001393318,
                    0.07518534362316132,
                    0.010132437571883202,
                    -0.03637297451496124,
                    0.07105276733636856,
                    -0.009848782792687416,
                    -0.06686148792505264,
                    -0.062031298875808716,
                    0.019325613975524902,
                    -0.04232519119977951,
                    -0.06224618852138519,
                    0.021108923479914665,
                    0.06317746639251709,
                    0.0354970283806324,
                    -0.0319402739405632,
                    0.0008561490103602409,
                    -0.017062081024050713,
                    -0.030933372676372528,
                    0.03874496743083,
                    0.1627531200647354,
                    0.03565472736954689,
                    0.17895779013633728,
                    -0.009015643037855625,
                    0.02094000019133091,
                    -0.10064347088336945,
                    0.015581437386572361,
                    0.007872411981225014,
                    0.09848539531230927,
                    0.04572472721338272,
                    -0.014345159754157066,
                    0.01864948309957981,
                    0.048328422009944916,
                    0.07531554251909256,
                    -0.09262176603078842,
                    -0.03395133092999458,
                    -0.01758650690317154,
                    0.06675703823566437,
                    -0.029085813090205193,
                    0.07161807268857956,
                    0.013105452992022038,
                    -0.1576024293899536,
                    -0.0522213950753212,
                    -0.00263264961540699,
                    0.03204077482223511,
                    -0.10323749482631683,
                    -0.11004692316055298,
                    -0.062189117074012756,
                    -0.03609837219119072,
                    -0.004000075161457062,
                    -0.004804803989827633,
                    0.04096073657274246,
                    -0.04383104294538498,
                    -0.10505546629428864,
                    0.030612705275416374,
                    0.0019258614629507065,
                    0.02493421360850334,
                    0.01348564587533474,
                    -0.14847931265830994,
                    -0.02895977348089218,
                    -0.05409305542707443,
                    -0.0061177401803433895,
                    -0.005754922050982714,
                    0.1306212693452835,
                    -0.03331613540649414,
                    0.07638218253850937,
                    -0.04470854625105858,
                    0.04291323199868202,
                    -0.06429149210453033,
                    0.0027054462116211653,
                    0.030476294457912445,
                    0.10820607841014862,
                    -0.002881922759115696,
                    0.067135751247406,
                    0.00991858635097742,
                    0.03304514288902283,
                    -0.03161471709609032,
                    -0.01913977786898613,
                    0.060245826840400696,
                    -0.03316428139805794,
                    0.014911912381649017,
                    -0.06992527097463608,
                    0.01905379816889763,
                    0.05265086889266968,
                    0.021036669611930847,
                    0.08830662071704865,
                    0.025845225900411606,
                    0.1133025586605072,
                    0.07294891029596329,
                    0.012649402022361755,
                    0.0134184081107378,
                    0.12139066308736801,
                    -0.04601898416876793,
                    0.003123082220554352,
                    -0.08147545158863068,
                    -0.026270732283592224,
                    0.008666249923408031,
                    0.06457586586475372,
                    -0.022149374708533287,
                    0.05032239481806755,
                    0.01965658739209175,
                    -0.040032513439655304,
                    -0.05593813210725784,
                    -0.0037086615338921547,
                    -0.024062901735305786,
                    -0.06982788443565369,
                    0.0690363347530365,
                    -0.02503478154540062,
                    0.004200764000415802,
                    0.08252380788326263,
                    0.010731160640716553,
                    0.035175882279872894,
                    0.0803520604968071,
                    -0.11110502481460571,
                    -0.07655396312475204
                ],
                "diffText": "diff --git a/libheif/context.cc b/libheif/context.cc\nindex 359a5b7..ca1dfd9 100644\n--- a/libheif/context.cc\n+++ b/libheif/context.cc\n@@ -969,20 +969,33 @@ Error HeifContext::interpret_heif_file()\n             img_iter->second->add_region_item_id(id);\n             m_region_items.push_back(region_item);\n           }\n+\n           /* When the geometry 'mask' of a region is represented by a mask stored in\n           * another image item the image item containing the mask shall be identified\n           * by an item reference of type 'mask' from the region item to the image item\n           * containing the mask. */\n           if (ref.header.get_short_type() == fourcc(\"mask\")) {\n             std::vector<uint32_t> refs = ref.to_item_ID;\n-            int mask_index = 0;\n+            size_t mask_index = 0;\n             for (int j = 0; j < region_item->get_number_of_regions(); j++) {\n               if (region_item->get_regions()[j]->getRegionType() == heif_region_type_referenced_mask) {\n                 std::shared_ptr<RegionGeometry_ReferencedMask> mask_geometry = std::dynamic_pointer_cast<RegionGeometry_ReferencedMask>(region_item->get_regions()[j]);\n+\n+                if (mask_index >= refs.size()) {\n+                  return Error(heif_error_Invalid_input,\n+                               heif_suberror_Unspecified,\n+                               \"Region mask reference with non-existing mask image reference\");\n+                }\n+\n                 uint32_t mask_image_id = refs[mask_index];\n-                assert(is_image(mask_image_id));\n-                mask_geometry->referenced_item = mask_image_id;\n+                if (!is_image(mask_image_id)) {\n+                  return Error(heif_error_Invalid_input,\n+                               heif_suberror_Unspecified,\n+                               \"Region mask referenced item is not an image\");\n+                }\n+\n                 auto mask_image = m_all_images.find(mask_image_id)->second;\n+                mask_geometry->referenced_item = mask_image_id;\n                 if (mask_geometry->width == 0) {\n                   mask_geometry->width = mask_image->get_ispe_width();\n                 }"
            }
        },
        "relation2": {
            "identity": 12523,
            "start": 6292,
            "end": 6291,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 6291,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "libheif/context.cc"
            }
        }
    },
    {
        "baseNode": {
            "identity": 6285,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-61718"
            }
        },
        "relation1": {
            "identity": 12520,
            "start": 6285,
            "end": 5009,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 5009,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "libheif"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 6285,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-61718"
            }
        },
        "relation1": {
            "identity": 12519,
            "start": 6285,
            "end": 6290,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 6290,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "INFO: Running with entropic power schedule (0xFF, 100).\nINFO: Seed: 3853020400\nINFO: Loaded 1 modules   (22288 inline 8-bit counters): 22288 [0x8c5790, 0x8caea0), \nINFO: Loaded 1 PC tables (22288 PCs): 22288 [0x8caea0,0x921fa0), \n/out/file_fuzzer: Running 1 inputs 1 time(s) each.\nRunning: /tmp/poc\n=================================================================\n==1==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6020000007d4 at pc 0x0000005cf596 bp 0x7fff3b524bb0 sp 0x7fff3b524ba8\nREAD of size 4 at 0x6020000007d4 thread T0\nSCARINESS: 17 (4-byte-read-heap-buffer-overflow)\n    #0 0x5cf595 in HeifContext::interpret_heif_file() /src/libheif/libheif/context.cc:985:42\n    #1 0x5d1d56 in HeifContext::read_from_memory(void const*, unsigned long, bool) /src/libheif/libheif/context.cc:448:10\n    #2 0x572ee5 in heif_context_read_from_memory /src/libheif/libheif/heif.cc:450:29\n    #3 0x56dcc6 in LLVMFuzzerTestOneInput /src/libheif/fuzzing/file_fuzzer.cc:97:9\n    #4 0x43f563 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15\n    #5 0x42acc2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6\n    #6 0x43056c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9\n    #7 0x459aa2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #8 0x7f2e9c22b082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: eebe5d5f4b608b8a53ec446b63981bba373ca0ca)\n    #9 0x420e8d in _start (/out/file_fuzzer+0x420e8d)\n\nDEDUP_TOKEN: HeifContext::interpret_heif_file()--HeifContext::read_from_memory(void const*, unsigned long, bool)--heif_context_read_from_memory\n0x6020000007d4 is located 0 bytes to the right of 4-byte region [0x6020000007d0,0x6020000007d4)\nallocated by thread T0 here:\n    #0 0x56b53d in operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:95:3\n    #1 0x599fcd in void* std::__1::__libcpp_operator_new<unsigned long>(unsigned long) /usr/local/bin/../include/c++/v1/new:245:10\n    #2 0x599fcd in std::__1::__libcpp_allocate(unsigned long, unsigned long) /usr/local/bin/../include/c++/v1/new:271:10\n    #3 0x599fcd in std::__1::allocator<unsigned int>::allocate(unsigned long) /usr/local/bin/../include/c++/v1/__memory/allocator.h:105:38\n    #4 0x599fcd in std::__1::allocator_traits<std::__1::allocator<unsigned int> >::allocate(std::__1::allocator<unsigned int>&, unsigned long) /usr/local/bin/../include/c++/v1/__memory/allocator_traits.h:262:20\n    #5 0x599fcd in std::__1::vector<unsigned int, std::__1::allocator<unsigned int> >::__vallocate(unsigned long) /usr/local/bin/../include/c++/v1/vector:931:37\n    #6 0x599fcd in std::__1::vector<unsigned int, std::__1::allocator<unsigned int> >::vector(std::__1::vector<unsigned int, std::__1::allocator<unsigned int> > const&) /usr/local/bin/../include/c++/v1/vector:1166:9\n    #7 0x5cc92c in HeifContext::interpret_heif_file() /src/libheif/libheif/context.cc:980:42\n    #8 0x5d1d56 in HeifContext::read_from_memory(void const*, unsigned long, bool) /src/libheif/libheif/context.cc:448:10\n    #9 0x572ee5 in heif_context_read_from_memory /src/libheif/libheif/heif.cc:450:29\n    #10 0x56dcc6 in LLVMFuzzerTestOneInput /src/libheif/fuzzing/file_fuzzer.cc:97:9\n    #11 0x43f563 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15\n    #12 0x42acc2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6\n    #13 0x43056c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9\n    #14 0x459aa2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #15 0x7f2e9c22b082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: eebe5d5f4b608b8a53ec446b63981bba373ca0ca)\n\nDEDUP_TOKEN: operator new(unsigned long)--void* std::__1::__libcpp_operator_new<unsigned long>(unsigned long)--std::__1::__libcpp_allocate(unsigned long, unsigned long)\nSUMMARY: AddressSanitizer: heap-buffer-overflow /src/libheif/libheif/context.cc:985:42 in HeifContext::interpret_heif_file()\nShadow bytes around the buggy address:\n  0x0c047fff80a0: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fa\n  0x0c047fff80b0: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fd\n  0x0c047fff80c0: fa fa 04 fa fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c047fff80d0: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd\n  0x0c047fff80e0: fa fa fd fa fa fa 00 fa fa fa fc fc fa fa fd fd\n=>0x0c047fff80f0: fa fa fd fd fa fa 04 fa fa fa[04]fa fa fa fa fa\n  0x0c047fff8100: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8110: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8120: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8130: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8140: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.05821338668465614,
                    0.05250062420964241,
                    -0.07864890247583389,
                    -0.002786688506603241,
                    -0.01812678389251232,
                    -0.0033770492300391197,
                    -0.009000818245112896,
                    0.03461989760398865,
                    0.03583080694079399,
                    -0.02954254113137722,
                    0.0022140946239233017,
                    0.00727804796770215,
                    -0.02487419731914997,
                    -0.017441140487790108,
                    0.030753692612051964,
                    -0.006128072272986174,
                    0.1272120177745819,
                    0.037283189594745636,
                    0.03608525171875954,
                    0.0661468505859375,
                    -0.07771943509578705,
                    0.03324170783162117,
                    -0.002948108362033963,
                    -0.008754375390708447,
                    -0.04259731248021126,
                    -0.012955286540091038,
                    -0.13246457278728485,
                    -0.01332890335470438,
                    -0.019166426733136177,
                    -0.008614947088062763,
                    -0.11308262497186661,
                    -0.12256147712469101,
                    -0.013758857734501362,
                    -0.04981901869177818,
                    -0.0017602145671844482,
                    -0.02969343401491642,
                    0.03152788057923317,
                    -0.00269951275549829,
                    0.0627468079328537,
                    0.09167893975973129,
                    -0.07944422215223312,
                    -0.0625152662396431,
                    0.024616247043013573,
                    -0.03168468177318573,
                    -0.052940379828214645,
                    0.02055894024670124,
                    0.026538841426372528,
                    -0.0558638870716095,
                    0.04675507918000221,
                    -0.026192478835582733,
                    -0.11873669177293777,
                    0.005509235430508852,
                    -0.062060508877038956,
                    -0.06453585624694824,
                    -0.04101782292127609,
                    -0.046876754611730576,
                    0.03209874406456947,
                    0.049468185752630234,
                    -0.036224547773599625,
                    0.08384229987859726,
                    0.015458747744560242,
                    -0.034575268626213074,
                    0.01981198415160179,
                    -0.005446682218462229,
                    -0.06009352579712868,
                    0.061511460691690445,
                    0.07947191596031189,
                    0.03944912180304527,
                    0.025741180405020714,
                    -0.03312934935092926,
                    0.0383087657392025,
                    0.12041722983121872,
                    -0.05049583315849304,
                    -0.1471371054649353,
                    -0.04045088216662407,
                    0.00465143658220768,
                    -0.04549631476402283,
                    0.0066877733916044235,
                    -0.041455209255218506,
                    -0.1425616294145584,
                    -0.07326690107584,
                    0.0003111871483270079,
                    0.04875313863158226,
                    0.005131191108375788,
                    0.03560536727309227,
                    0.05601179227232933,
                    -0.05180969461798668,
                    -0.058487772941589355,
                    -0.006162730976939201,
                    -0.010873179882764816,
                    0.043948423117399216,
                    -0.08075293153524399,
                    0.010359127074480057,
                    -0.04636577144265175,
                    0.05208437144756317,
                    0.02881048433482647,
                    0.01768755353987217,
                    -0.03593301400542259,
                    -0.024045689031481743,
                    0.026134779676795006,
                    -0.07847777009010315,
                    -0.02407052554190159,
                    -0.016570689156651497,
                    -0.048576172441244125,
                    -0.032739896327257156,
                    0.0066198925487697124,
                    -0.04568210244178772,
                    0.004724441561847925,
                    -0.015037649311125278,
                    -0.026023395359516144,
                    -0.014045429416000843,
                    -0.007178041618317366,
                    -0.002836649538949132,
                    0.057121869176626205,
                    0.07016410678625107,
                    -0.04997723922133446,
                    -0.019466793164610863,
                    -0.05642293766140938,
                    0.013856030069291592,
                    0.011011664755642414,
                    0.034225959330797195,
                    0.03293248638510704,
                    -0.044779013842344284,
                    0.011384028010070324,
                    0.007243528962135315,
                    -0.018117893487215042,
                    0.015869267284870148,
                    0.04436994716525078,
                    0.0503094457089901,
                    0.07643985003232956,
                    -0.0083087719976902,
                    0.00447390740737319,
                    0.060647252947092056,
                    0.02993067540228367,
                    -0.03314924240112305,
                    0.01881650649011135,
                    0.12228108197450638,
                    -0.013635060749948025,
                    -0.013586685992777348,
                    -0.023672915995121002,
                    0.021823326125741005,
                    0.010672111064195633,
                    -0.04984285309910774,
                    -0.007241353392601013,
                    0.03582846000790596,
                    -0.05921616032719612,
                    0.06562001258134842,
                    0.009123694151639938,
                    0.016672739759087563,
                    0.000806611031293869,
                    0.006092084106057882,
                    -0.024659225717186928,
                    -0.11279305815696716,
                    -0.00887226965278387,
                    0.030848147347569466,
                    -0.01686653308570385,
                    -0.005966761615127325,
                    0.02267155610024929,
                    -0.059683140367269516,
                    0.010474402457475662,
                    0.0014470162568613887,
                    0.0963188037276268,
                    -0.0028910853434354067,
                    0.12505103647708893,
                    -0.03817242756485939,
                    0.09950345009565353,
                    -0.038462165743112564,
                    -0.0029472988098859787,
                    0.015597435645759106,
                    -0.014874710701406002,
                    -0.0521596223115921,
                    -0.0022737483959645033,
                    0.01441887766122818,
                    -0.014640924520790577,
                    -0.013122394680976868,
                    -0.03187057003378868,
                    -0.006368482019752264,
                    0.07772866636514664,
                    0.023965882137417793,
                    0.02293817140161991,
                    0.053359776735305786,
                    0.03684527799487114,
                    -0.022545725107192993,
                    -0.061044514179229736,
                    -0.010565350763499737,
                    0.0480923093855381,
                    -0.08656402677297592,
                    -0.05969013646245003,
                    -0.037433262914419174,
                    0.009380485862493515,
                    0.00990501418709755,
                    -0.03240516781806946,
                    0.03228498622775078,
                    -0.01347534079104662,
                    -0.11940764635801315,
                    -0.010580703616142273,
                    -0.008834494277834892,
                    0.018820077180862427,
                    0.0141696622595191,
                    -0.1184447780251503,
                    -0.05811147391796112,
                    -0.023478614166378975,
                    0.08361181616783142,
                    -0.013356409035623074,
                    0.04297887906432152,
                    -0.10096987336874008,
                    0.0721498653292656,
                    0.00978422723710537,
                    0.0703989639878273,
                    -0.015147652477025986,
                    -0.0337584912776947,
                    0.006469157990068197,
                    0.08245626837015152,
                    0.029767384752631187,
                    0.01696181483566761,
                    -0.058246418833732605,
                    0.04581032320857048,
                    -0.017644204199314117,
                    -0.08459044247865677,
                    0.017241524532437325,
                    -0.06209949776530266,
                    -0.027597593143582344,
                    -0.06840050965547562,
                    -0.056052450090646744,
                    0.07934481650590897,
                    0.0019225962460041046,
                    -0.02758316695690155,
                    0.0717964619398117,
                    0.04431317746639252,
                    0.043910447508096695,
                    -0.03903772309422493,
                    -0.002450833795592189,
                    -0.0068345325998961926,
                    0.01727472059428692,
                    -0.03063853830099106,
                    0.021149946376681328,
                    0.09519851952791214,
                    0.02962633967399597,
                    -0.041907403618097305,
                    -0.05158416926860809,
                    0.03143985569477081,
                    -0.038556091487407684,
                    -0.015093778260052204,
                    -0.04266363009810448,
                    0.10259220749139786,
                    -0.08186180144548416,
                    -0.07230120897293091,
                    0.05145469307899475,
                    -0.02792668528854847,
                    0.04689572751522064,
                    -0.009198613464832306,
                    -0.026545129716396332,
                    0.0747474953532219,
                    0.0136934919282794,
                    0.06894100457429886,
                    -0.022030316293239594
                ],
                "report_type": "Heap-buffer-overflow READ 4",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 6285,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-61718"
            }
        },
        "relation1": {
            "identity": 12518,
            "start": 6285,
            "end": 6289,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 6289,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "detect invalid mask region image reference (fixes clusterfuzz issue 60359)\n",
                "sha": "6c4016fd3d944a8903bdd3e6be8fcdd1bc73ca79",
                "repo": "libheif",
                "encoding": "UTF-8",
                "authored_date": 1696334741,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1696334741
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 6285,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-61718"
            }
        },
        "relation1": {
            "identity": 12513,
            "start": 6285,
            "end": 6286,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 6286,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "add script to build Android libraries for all platforms\n",
                "sha": "4a3327b5b73c94a26b2deed91d0cae82d53db24a",
                "repo": "libheif",
                "encoding": "UTF-8",
                "authored_date": 1695028960,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1695028960
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]