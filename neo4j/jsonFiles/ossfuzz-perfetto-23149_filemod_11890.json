[
    {
        "baseNode": {
            "identity": 11882,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-perfetto-23149"
            }
        },
        "relation1": {
            "identity": 24717,
            "start": 11882,
            "end": 11890,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11890,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.056242018938064575,
                    -0.0508674681186676,
                    -0.08495372533798218,
                    0.02132965624332428,
                    0.040955837815999985,
                    -0.01023980975151062,
                    0.026117587462067604,
                    -0.007505885325372219,
                    0.0812528133392334,
                    0.0019515602616593242,
                    0.037722114473581314,
                    -0.04365326836705208,
                    0.0651155486702919,
                    -0.02572977915406227,
                    0.0008343640365637839,
                    -0.003736502258107066,
                    0.10372054576873779,
                    0.07316450029611588,
                    0.052490655332803726,
                    0.01628659851849079,
                    -0.0828908383846283,
                    0.03155141323804855,
                    0.009988442063331604,
                    -0.016799738630652428,
                    0.049851179122924805,
                    -0.08818501234054565,
                    -0.03257346898317337,
                    0.04039695858955383,
                    -0.03600005805492401,
                    -0.0754014253616333,
                    -0.10915530472993851,
                    -0.07686322182416916,
                    -0.0040580881759524345,
                    0.029409537091851234,
                    0.03209959715604782,
                    -0.08300027996301651,
                    -0.01598910428583622,
                    -0.055257052183151245,
                    -0.060053374618291855,
                    0.08312278240919113,
                    -0.07755237072706223,
                    -0.09703631699085236,
                    0.06738761067390442,
                    0.00010966002446366474,
                    -0.02986418642103672,
                    -0.0278764758259058,
                    -0.06614730507135391,
                    -0.04595889896154404,
                    0.0059513733722269535,
                    0.0003126236842945218,
                    -0.10533767938613892,
                    -0.03718676045536995,
                    -0.011349600739777088,
                    0.007247264496982098,
                    -0.08125271648168564,
                    -0.020510924980044365,
                    0.004701878875494003,
                    0.054321177303791046,
                    -0.0582338310778141,
                    0.22152011096477509,
                    0.017742125317454338,
                    -0.03982320427894592,
                    0.08638512343168259,
                    0.006933972705155611,
                    -0.05953932926058769,
                    0.04078294336795807,
                    -0.015492865815758705,
                    -0.024310268461704254,
                    -0.05417238548398018,
                    0.024103764444589615,
                    -0.04536052793264389,
                    0.09883572161197662,
                    -0.16975240409374237,
                    -0.06908077746629715,
                    0.07380539923906326,
                    0.03749324753880501,
                    -0.04653911665081978,
                    0.007892364636063576,
                    -0.09523304551839828,
                    -0.05588832125067711,
                    -0.03711331635713577,
                    0.06162327900528908,
                    0.003011394990608096,
                    0.02266358956694603,
                    0.0015455064130946994,
                    0.09016973525285721,
                    -0.07812400162220001,
                    0.009691162034869194,
                    0.03305559977889061,
                    0.020424488931894302,
                    0.05369105190038681,
                    -0.012373766861855984,
                    0.07072838395833969,
                    -0.026379132643342018,
                    0.035657744854688644,
                    -0.016922056674957275,
                    0.08627644926309586,
                    -0.022017542272806168,
                    -0.008110479451715946,
                    -0.042611490935087204,
                    0.007700060028582811,
                    -0.08226229250431061,
                    -0.017283834517002106,
                    -0.13501541316509247,
                    -0.05671538785099983,
                    -0.01729469560086727,
                    0.0008290158002637327,
                    0.10144060105085373,
                    0.06435094773769379,
                    -0.02304847724735737,
                    0.0684540644288063,
                    -0.0008397467900067568,
                    -0.08222822099924088,
                    0.09276081621646881,
                    0.051611047238111496,
                    -0.08959567546844482,
                    -0.15071237087249756,
                    0.04942287504673004,
                    0.031081853434443474,
                    0.13140133023262024,
                    0.06443005055189133,
                    0.0504566915333271,
                    0.11427175998687744,
                    -0.01995883695781231,
                    -0.06025924161076546,
                    -0.09532937407493591,
                    -0.038414161652326584,
                    0.012620359659194946,
                    -0.028307301923632622,
                    -0.019612183794379234,
                    0.11791141331195831,
                    -0.014025848358869553,
                    0.08727961033582687,
                    0.02547774463891983,
                    0.07474666833877563,
                    -0.016511837020516396,
                    0.09747564792633057,
                    0.05602345988154411,
                    0.015090198256075382,
                    0.04835162311792374,
                    0.10547704994678497,
                    0.054721783846616745,
                    0.01933467760682106,
                    0.02258719503879547,
                    0.1780080795288086,
                    -0.027462724596261978,
                    0.04522142931818962,
                    0.018390489742159843,
                    -0.04012470319867134,
                    0.02154306322336197,
                    -0.05786634609103203,
                    0.006300084758549929,
                    -0.12251712381839752,
                    0.03142711520195007,
                    0.015768030658364296,
                    0.022536274045705795,
                    -0.017562637105584145,
                    -0.012989146634936333,
                    -0.00299066468141973,
                    -0.014934243634343147,
                    -0.014508526772260666,
                    0.10079500824213028,
                    0.12369974702596664,
                    0.1388634443283081,
                    0.007111190818250179,
                    0.09523240476846695,
                    0.01032870914787054,
                    0.02957688644528389,
                    -0.05051470920443535,
                    0.09333642572164536,
                    -0.07107999920845032,
                    0.03560030087828636,
                    -0.04326961934566498,
                    -0.04405530169606209,
                    0.013362242840230465,
                    -0.03501073643565178,
                    -0.07961014658212662,
                    0.042393043637275696,
                    -0.04318062216043472,
                    -0.047577887773513794,
                    -0.005155234597623348,
                    0.025960292667150497,
                    0.03542294725775719,
                    0.01621788740158081,
                    0.0004326319904066622,
                    0.010949256829917431,
                    0.02458181418478489,
                    -0.0237947478890419,
                    -0.046812754124403,
                    -0.04387688636779785,
                    0.057494185864925385,
                    -0.048058271408081055,
                    0.0623190701007843,
                    0.04692816734313965,
                    -0.059496622532606125,
                    0.10078667849302292,
                    0.0906052514910698,
                    0.04842682555317879,
                    -0.025823121890425682,
                    -0.08724331110715866,
                    -0.17916129529476166,
                    0.007727340795099735,
                    -0.013265782967209816,
                    -0.013707427307963371,
                    0.09843997657299042,
                    -0.01824643462896347,
                    0.04502306878566742,
                    -0.10531561821699142,
                    -0.05021784454584122,
                    0.054684147238731384,
                    0.13139209151268005,
                    0.03617751970887184,
                    0.05694124102592468,
                    0.08466130495071411,
                    0.05366842821240425,
                    -0.13890044391155243,
                    0.04210317134857178,
                    0.11544395983219147,
                    0.022909799590706825,
                    0.028958618640899658,
                    -0.0451178103685379,
                    0.04236849024891853,
                    0.026107026264071465,
                    -0.02877281978726387,
                    0.0624513179063797,
                    0.03056821972131729,
                    0.021830396726727486,
                    0.06394175440073013,
                    0.05174023658037186,
                    -0.05840621516108513,
                    -0.0019135401817038655,
                    0.018854927271604538,
                    -0.01089386735111475,
                    -0.041999369859695435,
                    -0.03561656177043915,
                    -0.06775905191898346,
                    0.08348961174488068,
                    0.06560733914375305,
                    -0.05541979521512985,
                    -0.05890491604804993,
                    0.03736455366015434,
                    0.0513736791908741,
                    0.002175315283238888,
                    -0.024489913135766983,
                    0.12573009729385376,
                    -0.039945174008607864,
                    -0.07654792815446854,
                    0.06891759485006332,
                    -0.04864737391471863,
                    0.05832514539361,
                    0.06090180203318596,
                    -0.02002008818089962,
                    0.03217906132340431,
                    0.13739550113677979,
                    0.03220429643988609,
                    0.0044770920649170876
                ],
                "diffText": "diff --git a/src/trace_processor/importers/common/clock_tracker.cc b/src/trace_processor/importers/common/clock_tracker.cc\nindex 40448d200..4f5202993 100644\n--- a/src/trace_processor/importers/common/clock_tracker.cc\n+++ b/src/trace_processor/importers/common/clock_tracker.cc\n@@ -251,11 +251,18 @@ base::Optional<int64_t> ClockTracker::ConvertSlowpath(ClockId src_clock_id,\n     // And use that to retrieve the corresponding time in the next clock domain.\n     // The snapshot id must exist in the target clock domain. If it doesn't\n     // either the hash logic or the pathfinding logic are bugged.\n+    // This can also happen if the sanity checks in AddSnapshot fail and we\n+    // skip part of the snapshot.\n     const ClockSnapshots& next_snap = next_clock->GetSnapshot(hash);\n+\n+    // Using std::lower_bound because snapshot_ids is sorted, so we can do\n+    // a binary search. std::find would do a linear scan.\n     auto next_it = std::lower_bound(next_snap.snapshot_ids.begin(),\n                                     next_snap.snapshot_ids.end(), snapshot_id);\n-    PERFETTO_DCHECK(next_it != next_snap.snapshot_ids.end() &&\n-                    *next_it == snapshot_id);\n+    if (next_it == next_snap.snapshot_ids.end() || *next_it != snapshot_id) {\n+      PERFETTO_DFATAL(\"Snapshot does not exist in clock domain.\");\n+      continue;\n+    }\n     size_t next_index = static_cast<size_t>(\n         std::distance(next_snap.snapshot_ids.begin(), next_it));\n     PERFETTO_DCHECK(next_index < next_snap.snapshot_ids.size());"
            }
        },
        "relation2": {
            "identity": 24717,
            "start": 11890,
            "end": 11882,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 11882,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-perfetto-23149"
            }
        }
    },
    {
        "baseNode": {
            "identity": 11882,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-perfetto-23149"
            }
        },
        "relation1": {
            "identity": 24717,
            "start": 11882,
            "end": 11890,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11890,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.056242018938064575,
                    -0.0508674681186676,
                    -0.08495372533798218,
                    0.02132965624332428,
                    0.040955837815999985,
                    -0.01023980975151062,
                    0.026117587462067604,
                    -0.007505885325372219,
                    0.0812528133392334,
                    0.0019515602616593242,
                    0.037722114473581314,
                    -0.04365326836705208,
                    0.0651155486702919,
                    -0.02572977915406227,
                    0.0008343640365637839,
                    -0.003736502258107066,
                    0.10372054576873779,
                    0.07316450029611588,
                    0.052490655332803726,
                    0.01628659851849079,
                    -0.0828908383846283,
                    0.03155141323804855,
                    0.009988442063331604,
                    -0.016799738630652428,
                    0.049851179122924805,
                    -0.08818501234054565,
                    -0.03257346898317337,
                    0.04039695858955383,
                    -0.03600005805492401,
                    -0.0754014253616333,
                    -0.10915530472993851,
                    -0.07686322182416916,
                    -0.0040580881759524345,
                    0.029409537091851234,
                    0.03209959715604782,
                    -0.08300027996301651,
                    -0.01598910428583622,
                    -0.055257052183151245,
                    -0.060053374618291855,
                    0.08312278240919113,
                    -0.07755237072706223,
                    -0.09703631699085236,
                    0.06738761067390442,
                    0.00010966002446366474,
                    -0.02986418642103672,
                    -0.0278764758259058,
                    -0.06614730507135391,
                    -0.04595889896154404,
                    0.0059513733722269535,
                    0.0003126236842945218,
                    -0.10533767938613892,
                    -0.03718676045536995,
                    -0.011349600739777088,
                    0.007247264496982098,
                    -0.08125271648168564,
                    -0.020510924980044365,
                    0.004701878875494003,
                    0.054321177303791046,
                    -0.0582338310778141,
                    0.22152011096477509,
                    0.017742125317454338,
                    -0.03982320427894592,
                    0.08638512343168259,
                    0.006933972705155611,
                    -0.05953932926058769,
                    0.04078294336795807,
                    -0.015492865815758705,
                    -0.024310268461704254,
                    -0.05417238548398018,
                    0.024103764444589615,
                    -0.04536052793264389,
                    0.09883572161197662,
                    -0.16975240409374237,
                    -0.06908077746629715,
                    0.07380539923906326,
                    0.03749324753880501,
                    -0.04653911665081978,
                    0.007892364636063576,
                    -0.09523304551839828,
                    -0.05588832125067711,
                    -0.03711331635713577,
                    0.06162327900528908,
                    0.003011394990608096,
                    0.02266358956694603,
                    0.0015455064130946994,
                    0.09016973525285721,
                    -0.07812400162220001,
                    0.009691162034869194,
                    0.03305559977889061,
                    0.020424488931894302,
                    0.05369105190038681,
                    -0.012373766861855984,
                    0.07072838395833969,
                    -0.026379132643342018,
                    0.035657744854688644,
                    -0.016922056674957275,
                    0.08627644926309586,
                    -0.022017542272806168,
                    -0.008110479451715946,
                    -0.042611490935087204,
                    0.007700060028582811,
                    -0.08226229250431061,
                    -0.017283834517002106,
                    -0.13501541316509247,
                    -0.05671538785099983,
                    -0.01729469560086727,
                    0.0008290158002637327,
                    0.10144060105085373,
                    0.06435094773769379,
                    -0.02304847724735737,
                    0.0684540644288063,
                    -0.0008397467900067568,
                    -0.08222822099924088,
                    0.09276081621646881,
                    0.051611047238111496,
                    -0.08959567546844482,
                    -0.15071237087249756,
                    0.04942287504673004,
                    0.031081853434443474,
                    0.13140133023262024,
                    0.06443005055189133,
                    0.0504566915333271,
                    0.11427175998687744,
                    -0.01995883695781231,
                    -0.06025924161076546,
                    -0.09532937407493591,
                    -0.038414161652326584,
                    0.012620359659194946,
                    -0.028307301923632622,
                    -0.019612183794379234,
                    0.11791141331195831,
                    -0.014025848358869553,
                    0.08727961033582687,
                    0.02547774463891983,
                    0.07474666833877563,
                    -0.016511837020516396,
                    0.09747564792633057,
                    0.05602345988154411,
                    0.015090198256075382,
                    0.04835162311792374,
                    0.10547704994678497,
                    0.054721783846616745,
                    0.01933467760682106,
                    0.02258719503879547,
                    0.1780080795288086,
                    -0.027462724596261978,
                    0.04522142931818962,
                    0.018390489742159843,
                    -0.04012470319867134,
                    0.02154306322336197,
                    -0.05786634609103203,
                    0.006300084758549929,
                    -0.12251712381839752,
                    0.03142711520195007,
                    0.015768030658364296,
                    0.022536274045705795,
                    -0.017562637105584145,
                    -0.012989146634936333,
                    -0.00299066468141973,
                    -0.014934243634343147,
                    -0.014508526772260666,
                    0.10079500824213028,
                    0.12369974702596664,
                    0.1388634443283081,
                    0.007111190818250179,
                    0.09523240476846695,
                    0.01032870914787054,
                    0.02957688644528389,
                    -0.05051470920443535,
                    0.09333642572164536,
                    -0.07107999920845032,
                    0.03560030087828636,
                    -0.04326961934566498,
                    -0.04405530169606209,
                    0.013362242840230465,
                    -0.03501073643565178,
                    -0.07961014658212662,
                    0.042393043637275696,
                    -0.04318062216043472,
                    -0.047577887773513794,
                    -0.005155234597623348,
                    0.025960292667150497,
                    0.03542294725775719,
                    0.01621788740158081,
                    0.0004326319904066622,
                    0.010949256829917431,
                    0.02458181418478489,
                    -0.0237947478890419,
                    -0.046812754124403,
                    -0.04387688636779785,
                    0.057494185864925385,
                    -0.048058271408081055,
                    0.0623190701007843,
                    0.04692816734313965,
                    -0.059496622532606125,
                    0.10078667849302292,
                    0.0906052514910698,
                    0.04842682555317879,
                    -0.025823121890425682,
                    -0.08724331110715866,
                    -0.17916129529476166,
                    0.007727340795099735,
                    -0.013265782967209816,
                    -0.013707427307963371,
                    0.09843997657299042,
                    -0.01824643462896347,
                    0.04502306878566742,
                    -0.10531561821699142,
                    -0.05021784454584122,
                    0.054684147238731384,
                    0.13139209151268005,
                    0.03617751970887184,
                    0.05694124102592468,
                    0.08466130495071411,
                    0.05366842821240425,
                    -0.13890044391155243,
                    0.04210317134857178,
                    0.11544395983219147,
                    0.022909799590706825,
                    0.028958618640899658,
                    -0.0451178103685379,
                    0.04236849024891853,
                    0.026107026264071465,
                    -0.02877281978726387,
                    0.0624513179063797,
                    0.03056821972131729,
                    0.021830396726727486,
                    0.06394175440073013,
                    0.05174023658037186,
                    -0.05840621516108513,
                    -0.0019135401817038655,
                    0.018854927271604538,
                    -0.01089386735111475,
                    -0.041999369859695435,
                    -0.03561656177043915,
                    -0.06775905191898346,
                    0.08348961174488068,
                    0.06560733914375305,
                    -0.05541979521512985,
                    -0.05890491604804993,
                    0.03736455366015434,
                    0.0513736791908741,
                    0.002175315283238888,
                    -0.024489913135766983,
                    0.12573009729385376,
                    -0.039945174008607864,
                    -0.07654792815446854,
                    0.06891759485006332,
                    -0.04864737391471863,
                    0.05832514539361,
                    0.06090180203318596,
                    -0.02002008818089962,
                    0.03217906132340431,
                    0.13739550113677979,
                    0.03220429643988609,
                    0.0044770920649170876
                ],
                "diffText": "diff --git a/src/trace_processor/importers/common/clock_tracker.cc b/src/trace_processor/importers/common/clock_tracker.cc\nindex 40448d200..4f5202993 100644\n--- a/src/trace_processor/importers/common/clock_tracker.cc\n+++ b/src/trace_processor/importers/common/clock_tracker.cc\n@@ -251,11 +251,18 @@ base::Optional<int64_t> ClockTracker::ConvertSlowpath(ClockId src_clock_id,\n     // And use that to retrieve the corresponding time in the next clock domain.\n     // The snapshot id must exist in the target clock domain. If it doesn't\n     // either the hash logic or the pathfinding logic are bugged.\n+    // This can also happen if the sanity checks in AddSnapshot fail and we\n+    // skip part of the snapshot.\n     const ClockSnapshots& next_snap = next_clock->GetSnapshot(hash);\n+\n+    // Using std::lower_bound because snapshot_ids is sorted, so we can do\n+    // a binary search. std::find would do a linear scan.\n     auto next_it = std::lower_bound(next_snap.snapshot_ids.begin(),\n                                     next_snap.snapshot_ids.end(), snapshot_id);\n-    PERFETTO_DCHECK(next_it != next_snap.snapshot_ids.end() &&\n-                    *next_it == snapshot_id);\n+    if (next_it == next_snap.snapshot_ids.end() || *next_it != snapshot_id) {\n+      PERFETTO_DFATAL(\"Snapshot does not exist in clock domain.\");\n+      continue;\n+    }\n     size_t next_index = static_cast<size_t>(\n         std::distance(next_snap.snapshot_ids.begin(), next_it));\n     PERFETTO_DCHECK(next_index < next_snap.snapshot_ids.size());"
            }
        },
        "relation2": {
            "identity": 24716,
            "start": 11890,
            "end": 11889,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 11889,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "src/trace_processor/importers/common/clock_tracker.cc"
            }
        }
    },
    {
        "baseNode": {
            "identity": 11882,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-perfetto-23149"
            }
        },
        "relation1": {
            "identity": 24713,
            "start": 11882,
            "end": 1696,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 1696,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "perfetto"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11882,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-perfetto-23149"
            }
        },
        "relation1": {
            "identity": 24712,
            "start": 11882,
            "end": 11888,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11888,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "INFO: Seed: 993312783\nINFO: Loaded 1 modules   (72162 inline 8-bit counters): 72162 [0x561309b41958, 0x561309b5333a), \nINFO: Loaded 1 PC tables (72162 PCs): 72162 [0x561309b53340,0x561309c6d160), \n/out/trace_processor_fuzzer: Running 1 inputs 1 time(s) each.\nRunning: /tmp/poc\n[984.945] clock_tracker.cc:80     Clock sync error: the clock domain with id=6 (unit=1, incremental=1), was previously registered with different properties (unit=1, incremental=0).\n[984.945] _profile_tracker.cc:196 Unknown frame in callstack; ignoring.\n=================================================================\n==1==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000438 at pc 0x56130935c290 bp 0x7ffe4996a770 sp 0x7ffe4996a768\nREAD of size 8 at 0x602000000438 thread T0\nSCARINESS: 23 (8-byte-read-heap-buffer-overflow)\n    #0 0x56130935c28f in perfetto::trace_processor::ClockTracker::ConvertSlowpath(unsigned long, long, unsigned long) /work/build/../../src/perfetto/src/trace_processor/importers/common/clock_tracker.cc:263:33\n    #1 0x561309080d18 in perfetto::trace_processor::ClockTracker::Convert(unsigned long, long, unsigned long) /work/build/../../src/perfetto/src/trace_processor/importers/common/clock_tracker.h:174:12\n    #2 0x56130907e60f in perfetto::trace_processor::ClockTracker::ToTraceTime(unsigned long, long) /work/build/../../src/perfetto/src/trace_processor/importers/common/clock_tracker.h:185:12\n    #3 0x56130926dd27 in perfetto::trace_processor::ProtoTraceParser::ParseProfilePacket(long, perfetto::trace_processor::PacketSequenceStateGeneration*, unsigned int, protozero::ConstBytes) /work/build/../../src/perfetto/src/trace_processor/importers/proto/proto_trace_parser.cc:288:53\n    #4 0x56130926c6d2 in perfetto::trace_processor::ProtoTraceParser::ParseTracePacketImpl(long, perfetto::trace_processor::TimestampedTracePiece, perfetto::trace_processor::TracePacketData const*, perfetto::protos::pbzero::TracePacket_Decoder const&) /work/build/../../src/perfetto/src/trace_processor/importers/proto/proto_trace_parser.cc:125:5\n    #5 0x56130926c3f1 in perfetto::trace_processor::ProtoTraceParser::ParseTracePacket(long, perfetto::trace_processor::TimestampedTracePiece) /work/build/../../src/perfetto/src/trace_processor/importers/proto/proto_trace_parser.cc:98:3\n    #6 0x56130931d53e in perfetto::trace_processor::TraceSorter::SortAndExtractEventsBeyondWindow(long) /work/build/../../src/perfetto/src/trace_processor/trace_sorter.cc:140:18\n    #7 0x56130931c39a in perfetto::trace_processor::TraceSorter::ExtractEventsForced() /work/build/../../src/perfetto/src/trace_processor/trace_sorter.h:158:5\n    #8 0x56130931c11b in perfetto::trace_processor::TraceProcessorStorageImpl::NotifyEndOfFile() /work/build/../../src/perfetto/src/trace_processor/trace_processor_storage_impl.cc:82:22\n    #9 0x561308fc6811 in perfetto::trace_processor::FuzzTraceProcessor(unsigned char const*, unsigned long) /work/build/../../src/perfetto/src/trace_processor/trace_parsing_fuzzer.cc:33:14\n    #10 0x561308fc6dd0 in LLVMFuzzerTestOneInput /work/build/../../src/perfetto/src/trace_processor/trace_parsing_fuzzer.cc:42:3\n    #11 0x561308f694c6 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:558:15\n    #12 0x561308f1ea73 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:296:6\n    #13 0x561308f2c583 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:796:9\n    #14 0x561308f1e0e7 in main /src/libfuzzer/FuzzerMain.cpp:19:10\n    #15 0x7f3a858e883f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n    #16 0x561308e81fd8 in _start (/out/trace_processor_fuzzer+0x266fd8)\n\nDEDUP_TOKEN: perfetto::trace_processor::ClockTracker::ConvertSlowpath(unsigned long, long, unsigned long)--perfetto::trace_processor::ClockTracker::Convert(unsigned long, long, unsigned long)--perfetto::trace_processor::ClockTracker::ToTraceTime(unsigned long, long)\n0x602000000438 is located 0 bytes to the right of 8-byte region [0x602000000430,0x602000000438)\nallocated by thread T0 here:\n    #0 0x561308f1bb2d in operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:99:3\n    #1 0x561308fc9ab0 in std::__1::__libcpp_allocate(unsigned long, unsigned long) /usr/local/bin/../include/c++/v1/new:253:10\n    #2 0x5613090160f3 in std::__1::allocator<long>::allocate(unsigned long) /usr/local/bin/../include/c++/v1/memory:1789:34\n    #3 0x561309013d40 in std::__1::allocator_traits<std::__1::allocator<long> >::allocate(std::__1::allocator<long>&, unsigned long) /usr/local/bin/../include/c++/v1/memory:1525:21\n    #4 0x56130913c0de in std::__1::__split_buffer<long, std::__1::allocator<long>&>::__split_buffer(unsigned long, unsigned long, std::__1::allocator<long>&) /usr/local/bin/../include/c++/v1/__split_buffer:318:29\n    #5 0x5613093672ea in void std::__1::vector<long, std::__1::allocator<long> >::__emplace_back_slow_path<long const&>(long const&) /usr/local/bin/../include/c++/v1/vector:1666:49\n    #6 0x56130935a282 in void std::__1::vector<long, std::__1::allocator<long> >::emplace_back<long const&>(long const&) /usr/local/bin/../include/c++/v1/vector:1688:9\n    #7 0x561309358c4d in perfetto::trace_processor::ClockTracker::AddSnapshot(std::__1::vector<perfetto::trace_processor::ClockTracker::ClockValue, std::__1::allocator<perfetto::trace_processor::ClockTracker::ClockValue> > const&) /work/build/../../src/perfetto/src/trace_processor/importers/common/clock_tracker.cc:141:24\n    #8 0x56130928cce5 in perfetto::trace_processor::ProtoTraceTokenizer::ParseClockSnapshot(protozero::ConstBytes, unsigned int) /work/build/../../src/perfetto/src/trace_processor/importers/proto/proto_trace_tokenizer.cc:475:28\n    #9 0x56130928ab87 in perfetto::trace_processor::ProtoTraceTokenizer::ParsePacket(perfetto::trace_processor::TraceBlobView) /work/build/../../src/perfetto/src/trace_processor/importers/proto/proto_trace_tokenizer.cc:218:12\n    #10 0x56130928a4b9 in perfetto::trace_processor::ProtoTraceTokenizer::ParseInternal(std::__1::unique_ptr<unsigned char [], std::__1::default_delete<unsigned char []> >, unsigned char*, unsigned long) /work/build/../../src/perfetto/src/trace_processor/importers/proto/proto_trace_tokenizer.cc:170:9\n    #11 0x561309289d7f in perfetto::trace_processor::ProtoTraceTokenizer::Parse(std::__1::unique_ptr<unsigned char [], std::__1::default_delete<unsigned char []> >, unsigned long) /work/build/../../src/perfetto/src/trace_processor/importers/proto/proto_trace_tokenizer.cc:153:10\n    #12 0x5613091fe50f in perfetto::trace_processor::ForwardingTraceParser::Parse(std::__1::unique_ptr<unsigned char [], std::__1::default_delete<unsigned char []> >, unsigned long) /work/build/../../src/perfetto/src/trace_processor/forwarding_trace_parser.cc:138:19\n    #13 0x56130931be68 in perfetto::trace_processor::TraceProcessorStorageImpl::Parse(std::__1::unique_ptr<unsigned char [], std::__1::default_delete<unsigned char []> >, unsigned long) /work/build/../../src/perfetto/src/trace_processor/trace_processor_storage_impl.cc:71:48\n    #14 0x561308fc67ad in perfetto::trace_processor::FuzzTraceProcessor(unsigned char const*, unsigned long) /work/build/../../src/perfetto/src/trace_processor/trace_parsing_fuzzer.cc:30:36\n    #15 0x561308fc6dd0 in LLVMFuzzerTestOneInput /work/build/../../src/perfetto/src/trace_processor/trace_parsing_fuzzer.cc:42:3\n    #16 0x561308f694c6 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:558:15\n    #17 0x561308f1ea73 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:296:6\n    #18 0x561308f2c583 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:796:9\n    #19 0x561308f1e0e7 in main /src/libfuzzer/FuzzerMain.cpp:19:10\n    #20 0x7f3a858e883f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n\nDEDUP_TOKEN: operator new(unsigned long)--std::__1::__libcpp_allocate(unsigned long, unsigned long)--std::__1::allocator<long>::allocate(unsigned long)\nSUMMARY: AddressSanitizer: heap-buffer-overflow /work/build/../../src/perfetto/src/trace_processor/importers/common/clock_tracker.cc:263:33 in perfetto::trace_processor::ClockTracker::ConvertSlowpath(unsigned long, long, unsigned long)\nShadow bytes around the buggy address:\n  0x0c047fff8030: fa fa 00 fa fa fa fd fa fa fa fd fa fa fa fd fa\n  0x0c047fff8040: fa fa fd fa fa fa 00 04 fa fa fd fd fa fa 00 00\n  0x0c047fff8050: fa fa 00 fa fa fa 00 fa fa fa 00 fa fa fa 00 fa\n  0x0c047fff8060: fa fa 00 fa fa fa 04 fa fa fa 00 00 fa fa 00 fa\n  0x0c047fff8070: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa\n=>0x0c047fff8080: fa fa 04 fa fa fa 00[fa]fa fa 04 fa fa fa 00 fa\n  0x0c047fff8090: fa fa 04 fa fa fa 00 fa fa fa 04 fa fa fa 00 fa\n  0x0c047fff80a0: fa fa 04 fa fa fa 00 fa fa fa 00 fa fa fa 00 00\n  0x0c047fff80b0: fa fa 00 fa fa fa 00 00 fa fa 00 00 fa fa 00 fa\n  0x0c047fff80c0: fa fa 00 fa fa fa 00 fa fa fa 00 fa fa fa 00 fa\n  0x0c047fff80d0: fa fa 00 fa fa fa 00 fa fa fa 00 fa fa fa 04 fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n  Shadow gap:              cc\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.009804017841815948,
                    0.044751305133104324,
                    -0.05338100716471672,
                    0.013143233954906464,
                    0.01112580019980669,
                    0.02316354401409626,
                    -0.029658118262887,
                    -0.004477192182093859,
                    0.08908084034919739,
                    -0.01928197592496872,
                    -0.019689125940203667,
                    0.07033031433820724,
                    -0.015261012129485607,
                    -0.0076658152975142,
                    -0.009472019970417023,
                    0.008862526156008244,
                    0.1262064129114151,
                    0.0304704662412405,
                    0.017068801447749138,
                    0.0337107814848423,
                    -0.04025915265083313,
                    0.0421953909099102,
                    -0.02360934019088745,
                    -0.025660723447799683,
                    0.017160743474960327,
                    -0.05264465883374214,
                    -0.09000483900308609,
                    -0.002303890185430646,
                    -0.03936445340514183,
                    -0.06649979203939438,
                    -0.10175218433141708,
                    -0.13920781016349792,
                    9.276345372200012e-05,
                    -0.002612768905237317,
                    -0.014640584588050842,
                    -0.011007323861122131,
                    -0.033915940672159195,
                    -0.00791621021926403,
                    -0.0017862009117379785,
                    0.07390982657670975,
                    -0.06020473316311836,
                    -0.07767683267593384,
                    0.02314820885658264,
                    0.002162652090191841,
                    -0.049396127462387085,
                    0.017429687082767487,
                    -0.05148402974009514,
                    -0.06283536553382874,
                    -0.01450416911393404,
                    -0.026988349854946136,
                    -0.12859661877155304,
                    -0.037529271095991135,
                    0.006717709358781576,
                    -0.04291737079620361,
                    -0.04462742805480957,
                    -0.0379907488822937,
                    0.0037185850087553263,
                    0.027214454486966133,
                    -0.061088740825653076,
                    0.14925429224967957,
                    0.021339304745197296,
                    -0.06090426817536354,
                    0.03250395506620407,
                    0.0352158285677433,
                    -0.05241454765200615,
                    0.0609709732234478,
                    0.03596815839409828,
                    0.002457623602822423,
                    0.006784235592931509,
                    -0.02992779202759266,
                    0.01868569850921631,
                    0.11843685060739517,
                    -0.11544481664896011,
                    -0.11759763211011887,
                    0.02488812990486622,
                    0.012479729950428009,
                    -0.014511954970657825,
                    -0.03254405036568642,
                    -0.05717569962143898,
                    -0.100557841360569,
                    -0.0010300936410203576,
                    0.030892008915543556,
                    0.0199096892029047,
                    0.05506858602166176,
                    0.007691643666476011,
                    0.03837720677256584,
                    -0.010202137753367424,
                    -0.024566782638430595,
                    0.012055027298629284,
                    -0.031651824712753296,
                    0.06819792836904526,
                    -0.056635092943906784,
                    0.03262811899185181,
                    -0.04452240467071533,
                    0.04224276915192604,
                    0.03555087000131607,
                    0.025222882628440857,
                    -0.014561894349753857,
                    -0.06412269920110703,
                    -0.013046092353761196,
                    -0.028390636667609215,
                    -0.0552714504301548,
                    -0.06774936616420746,
                    -0.09022068232297897,
                    -0.023765111342072487,
                    0.010705032385885715,
                    -0.0312870629131794,
                    0.026105185970664024,
                    0.04587658867239952,
                    -0.030393408611416817,
                    0.008230028674006462,
                    -0.043854862451553345,
                    -0.012367737479507923,
                    0.10716426372528076,
                    0.0696437731385231,
                    -0.07270032912492752,
                    -0.11509698629379272,
                    -0.07330188900232315,
                    -0.0008841471862979233,
                    0.04169054329395294,
                    0.017126860097050667,
                    -0.004798303358256817,
                    0.014036874286830425,
                    0.037681397050619125,
                    0.004496442154049873,
                    -0.00796073954552412,
                    0.033551815897226334,
                    -0.007789898663759232,
                    0.05441616475582123,
                    0.009688310325145721,
                    0.048346150666475296,
                    0.023577116429805756,
                    0.060941968113183975,
                    -0.01373379211872816,
                    -0.009947883896529675,
                    0.025183530524373055,
                    0.07147596031427383,
                    0.026942817494273186,
                    0.03959987312555313,
                    0.004092046525329351,
                    0.07613566517829895,
                    0.022952338680624962,
                    -0.04694977030158043,
                    0.02130713313817978,
                    0.06521735340356827,
                    -0.02659965306520462,
                    0.017107540741562843,
                    0.048717278987169266,
                    -0.006923333276063204,
                    0.003650809871032834,
                    -0.018814535811543465,
                    -0.03207940608263016,
                    -0.10851501673460007,
                    0.01925387606024742,
                    -0.0031292138155549765,
                    -0.047440629452466965,
                    0.0024616967421025038,
                    0.009934068657457829,
                    -0.05043775215744972,
                    -0.011287495493888855,
                    0.01374672632664442,
                    0.08754297345876694,
                    0.021106252446770668,
                    0.12772227823734283,
                    -0.026571182534098625,
                    0.0697699561715126,
                    -0.03750070556998253,
                    0.06674624234437943,
                    0.013398508541285992,
                    0.027895519509911537,
                    -0.03758254274725914,
                    -0.0014185840263962746,
                    0.015174712054431438,
                    0.002120696008205414,
                    0.006750853732228279,
                    -0.046145349740982056,
                    -0.013455021195113659,
                    0.06429615616798401,
                    0.018786199390888214,
                    0.008377591148018837,
                    0.027552030980587006,
                    0.06987229734659195,
                    -0.022525139153003693,
                    -0.0768030658364296,
                    -0.0004437702300492674,
                    0.056577760726213455,
                    -0.037375111132860184,
                    -0.013269241899251938,
                    -0.04161904752254486,
                    0.0032082628458738327,
                    0.035501886159181595,
                    -0.04470701888203621,
                    0.05920339748263359,
                    -0.004116788040846586,
                    -0.11080646514892578,
                    0.015934862196445465,
                    0.058918844908475876,
                    0.04213535785675049,
                    0.029574066400527954,
                    -0.128714919090271,
                    -0.10166889429092407,
                    -0.02260432206094265,
                    0.0775824561715126,
                    -0.005015099886804819,
                    0.01050668302923441,
                    -0.051763247698545456,
                    0.0652717873454094,
                    -0.03063192218542099,
                    0.05365446209907532,
                    -0.028134793043136597,
                    0.02337028644979,
                    0.013561383821070194,
                    0.08453240245580673,
                    0.049487676471471786,
                    0.01411697268486023,
                    -0.0673142597079277,
                    0.0515240915119648,
                    0.02094602771103382,
                    -0.030331218615174294,
                    0.021211648359894753,
                    -0.058233220130205154,
                    0.0099952919408679,
                    -0.02690783701837063,
                    -0.019304431974887848,
                    0.0891321673989296,
                    -0.05308784171938896,
                    0.00011215917766094208,
                    0.0521484911441803,
                    0.12583859264850616,
                    0.005832407157868147,
                    -0.043512288480997086,
                    0.028829194605350494,
                    -0.0334010012447834,
                    -0.014783427119255066,
                    0.0016319621354341507,
                    -0.0135738430544734,
                    0.0920606479048729,
                    0.07591258734464645,
                    -0.0425405390560627,
                    -0.006086766254156828,
                    0.05490223690867424,
                    0.009191806428134441,
                    -0.041605863720178604,
                    -0.02218264900147915,
                    0.10278049111366272,
                    -0.05664362385869026,
                    -0.05537377670407295,
                    0.03270851820707321,
                    -0.02173703908920288,
                    0.053329646587371826,
                    -0.027210557833313942,
                    -0.05515464022755623,
                    0.0696200504899025,
                    0.06598488986492157,
                    0.08168470114469528,
                    -0.003793447045609355
                ],
                "report_type": "Heap-buffer-overflow READ 8",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11882,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-perfetto-23149"
            }
        },
        "relation1": {
            "identity": 24711,
            "start": 11882,
            "end": 11886,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11886,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Merge \"Fix ASAN failure in clock tracker.\"",
                "sha": "509812647060893522be508e0ab5b6c62dec03bd",
                "repo": "perfetto",
                "encoding": "UTF-8",
                "authored_date": 1594128993,
                "committer_tz_offset": 0,
                "author_tz_offset": 0,
                "committed_date": 1594128993
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11882,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-perfetto-23149"
            }
        },
        "relation1": {
            "identity": 24704,
            "start": 11882,
            "end": 11883,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11883,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Merge \"Migrate scroll_jank related tables to the 'chrome/scroll_jank.sql' metric\"",
                "sha": "87547defa41951f506c06817055b1d3d3f09e82e",
                "repo": "perfetto",
                "encoding": "UTF-8",
                "authored_date": 1594128127,
                "committer_tz_offset": 0,
                "author_tz_offset": 0,
                "committed_date": 1594128127
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]