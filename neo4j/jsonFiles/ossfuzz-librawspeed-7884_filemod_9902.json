[
    {
        "baseNode": {
            "identity": 9900,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-7884"
            }
        },
        "relation1": {
            "identity": 20407,
            "start": 9900,
            "end": 9902,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 9902,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    -0.020761622115969658,
                    -0.02797684073448181,
                    -0.08975140750408173,
                    0.001999804750084877,
                    -0.03462762385606766,
                    0.03094826079905033,
                    0.00843004323542118,
                    0.05571369081735611,
                    -0.025940710678696632,
                    -0.004844529088586569,
                    0.02965850755572319,
                    0.04021488130092621,
                    -0.08575352281332016,
                    -0.05008227750658989,
                    0.04415971785783768,
                    -0.02620581164956093,
                    0.08903394639492035,
                    -0.09125161170959473,
                    -0.04583772271871567,
                    0.04113651439547539,
                    -0.06968992948532104,
                    -0.008695084601640701,
                    -0.06169112026691437,
                    0.09963105618953705,
                    -0.02527027763426304,
                    0.05676872283220291,
                    -0.05521740764379501,
                    -0.024318834766745567,
                    0.02769654616713524,
                    -0.030037034302949905,
                    -0.06043630838394165,
                    -0.10038153827190399,
                    0.06443329900503159,
                    -0.0007933545857667923,
                    0.047974519431591034,
                    0.03079208731651306,
                    -0.014996029436588287,
                    -0.06113704293966293,
                    0.06538087874650955,
                    0.07908664643764496,
                    -0.06194307655096054,
                    -0.05564046651124954,
                    0.0731285810470581,
                    -0.004024744965136051,
                    -0.09377651661634445,
                    0.0037386594340205193,
                    -0.0620507076382637,
                    -0.042804840952157974,
                    0.05151744559407234,
                    0.04411958158016205,
                    -0.04300716519355774,
                    0.046055540442466736,
                    -0.11333173513412476,
                    0.044743917882442474,
                    0.028440922498703003,
                    -0.030208898708224297,
                    -0.03789050877094269,
                    0.03813241422176361,
                    -0.11657308787107468,
                    -0.004269180353730917,
                    -0.05718669295310974,
                    -0.05868377909064293,
                    0.09270644932985306,
                    -0.027237366884946823,
                    -0.02669902890920639,
                    0.03759409859776497,
                    0.09161373972892761,
                    -0.03388608247041702,
                    0.05803864449262619,
                    -0.027624815702438354,
                    -0.013160662725567818,
                    0.15302325785160065,
                    -0.05099167674779892,
                    -0.021907055750489235,
                    -0.003558736527338624,
                    -0.012383915483951569,
                    -0.05745413154363632,
                    -0.06922826915979385,
                    0.06488949060440063,
                    -0.1015322357416153,
                    -0.010763954371213913,
                    -0.004547243006527424,
                    -0.034832246601581573,
                    0.06927928328514099,
                    0.09269414842128754,
                    -0.08487626910209656,
                    0.03369160369038582,
                    -0.06037396565079689,
                    0.013028069399297237,
                    0.020724711939692497,
                    0.08420060575008392,
                    -0.07206231355667114,
                    0.05001268535852432,
                    -0.03057074546813965,
                    0.02273985929787159,
                    -0.06900549679994583,
                    0.0266738124191761,
                    -0.10618472099304199,
                    0.012430734932422638,
                    -0.0272216796875,
                    0.03302537649869919,
                    -0.06081144139170647,
                    -0.04641231521964073,
                    -0.026172157377004623,
                    -0.017125241458415985,
                    0.0035556387156248093,
                    -0.10467533767223358,
                    0.06191713735461235,
                    0.015520241111516953,
                    -0.08208943158388138,
                    0.013319719582796097,
                    0.0430762842297554,
                    -0.030431360006332397,
                    -0.0312255397439003,
                    -0.044801294803619385,
                    -0.01272059790790081,
                    -0.031243594363331795,
                    -0.02948901057243347,
                    -0.03641573339700699,
                    0.014457393437623978,
                    0.11863423883914948,
                    0.04746735841035843,
                    -0.0048352256417274475,
                    -0.010654343292117119,
                    0.024874985218048096,
                    -0.030162334442138672,
                    0.03196435049176216,
                    0.03227885812520981,
                    0.11875252425670624,
                    0.12039106339216232,
                    -0.06018982082605362,
                    -0.001132134348154068,
                    -0.016706958413124084,
                    -0.0458856001496315,
                    -0.03252970054745674,
                    0.06981202960014343,
                    0.10722853243350983,
                    -0.02985442243516445,
                    0.10714630037546158,
                    0.027644729241728783,
                    0.023657184094190598,
                    0.06039128452539444,
                    0.04884229600429535,
                    0.08534932136535645,
                    -0.05852134898304939,
                    -0.01062268391251564,
                    0.09067694842815399,
                    -0.007002990692853928,
                    -0.06438707560300827,
                    -0.07320911437273026,
                    0.015611373819410801,
                    -0.04758374020457268,
                    0.0022391374222934246,
                    -0.08257844299077988,
                    0.09246063977479935,
                    0.050614114850759506,
                    0.05518772453069687,
                    -0.06172776222229004,
                    -0.0024595027789473534,
                    -0.01641186513006687,
                    -0.00550489965826273,
                    0.07668381929397583,
                    0.021168909966945648,
                    0.11234768480062485,
                    -0.02729143388569355,
                    0.10351619124412537,
                    -0.008791502565145493,
                    0.034087054431438446,
                    -0.007016240153461695,
                    0.062453821301460266,
                    -0.025973625481128693,
                    -0.021574540063738823,
                    -0.011657485738396645,
                    -0.06498245149850845,
                    0.07539226859807968,
                    -0.01305276807397604,
                    0.01768411323428154,
                    -0.025607306510210037,
                    0.038181062787771225,
                    -0.02092936635017395,
                    -0.03939877822995186,
                    0.005649838596582413,
                    -0.04968114197254181,
                    -0.08514118194580078,
                    -0.062078289687633514,
                    0.03787488117814064,
                    -0.03726494684815407,
                    0.06873738765716553,
                    -0.014741375111043453,
                    -0.02763678878545761,
                    0.04284662753343582,
                    -0.05177239328622818,
                    0.0947192907333374,
                    -0.08072991669178009,
                    -0.07732976227998734,
                    -0.033079687505960464,
                    0.014581817202270031,
                    0.005360197275876999,
                    -0.00777837447822094,
                    -0.06794721633195877,
                    -0.0632137730717659,
                    -0.02949339896440506,
                    -0.02867906168103218,
                    0.02911524474620819,
                    -0.08247529715299606,
                    -0.09145283699035645,
                    0.10097086429595947,
                    -0.030225787311792374,
                    0.03262840211391449,
                    0.05034548416733742,
                    0.014533773064613342,
                    -0.02142558991909027,
                    0.10531431436538696,
                    0.029164448380470276,
                    0.052600301802158356,
                    -0.023228589445352554,
                    -0.0396418496966362,
                    0.011236422695219517,
                    -0.04558756574988365,
                    -0.010579760186374187,
                    -0.07162317633628845,
                    -0.008259428665041924,
                    -0.027508240193128586,
                    0.018657952547073364,
                    0.059038858860731125,
                    -0.020111272111535072,
                    -0.00456999521702528,
                    0.04071073979139328,
                    0.09843720495700836,
                    0.09225452691316605,
                    -0.06368356943130493,
                    0.032785337418317795,
                    -0.028692809864878654,
                    -0.044628363102674484,
                    0.09093868732452393,
                    -0.04484636336565018,
                    0.06593196839094162,
                    -0.0012029558420181274,
                    -0.05389914661645889,
                    -0.07785981893539429,
                    0.010298659093677998,
                    0.015052289701998234,
                    -0.09041107445955276,
                    0.0016665048897266388,
                    0.05993293225765228,
                    -0.0486583337187767,
                    -0.07723705470561981,
                    0.11548569798469543,
                    -0.02974545955657959,
                    0.010112252086400986,
                    -0.022960111498832703,
                    -0.02819531410932541,
                    0.0972241684794426,
                    0.06913712620735168,
                    -0.07083188742399216,
                    -0.0030351560562849045
                ],
                "diffText": "diff --git a/src/librawspeed/decoders/ArwDecoder.cpp b/src/librawspeed/decoders/ArwDecoder.cpp\nindex 8b671f77..ff973605 100644\n--- a/src/librawspeed/decoders/ArwDecoder.cpp\n+++ b/src/librawspeed/decoders/ArwDecoder.cpp\n@@ -425,15 +425,21 @@ void ArwDecoder::GetWB() {\n \n     // \"Decrypt\" IFD\n     const auto& ifd_crypt = priv->getRootIfdData();\n-    auto ifd_size = ifd_crypt.getSize();\n-    auto ifd_decoded = Buffer::Create(ifd_size);\n+    const auto EncryptedBuffer = ifd_crypt.getSubView(off, len);\n+    // We do have to prepend 'off' padding, because TIFF uses absolute offsets.\n+    const auto DecryptedBufferSize = off + EncryptedBuffer.getSize();\n+    auto DecryptedBuffer = Buffer::Create(DecryptedBufferSize);\n \n-    SonyDecrypt(reinterpret_cast<const uint32*>(ifd_crypt.getData(off, len)),\n-                reinterpret_cast<uint32*>(ifd_decoded.get() + off), len / 4,\n+    SonyDecrypt(reinterpret_cast<const uint32*>(EncryptedBuffer.begin()),\n+                reinterpret_cast<uint32*>(DecryptedBuffer.get() + off), len / 4,\n                 key);\n \n     NORangesSet<Buffer> ifds_decoded;\n-    Buffer decIFD(move(ifd_decoded), ifd_size);\n+    Buffer decIFD(std::move(DecryptedBuffer), DecryptedBufferSize);\n+    const Buffer Padding(decIFD.getSubView(0, off));\n+    // The Decrypted Root Ifd can not point to preceding padding buffer.\n+    ifds_decoded.emplace(Padding);\n+\n     DataBuffer dbIDD(decIFD, priv->getRootIfdData().getByteOrder());\n     TiffRootIFD encryptedIFD(nullptr, &ifds_decoded, dbIDD, off);\n "
            }
        },
        "relation2": {
            "identity": 20407,
            "start": 9902,
            "end": 9900,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 9900,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-7884"
            }
        }
    },
    {
        "baseNode": {
            "identity": 9900,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-7884"
            }
        },
        "relation1": {
            "identity": 20407,
            "start": 9900,
            "end": 9902,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 9902,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    -0.020761622115969658,
                    -0.02797684073448181,
                    -0.08975140750408173,
                    0.001999804750084877,
                    -0.03462762385606766,
                    0.03094826079905033,
                    0.00843004323542118,
                    0.05571369081735611,
                    -0.025940710678696632,
                    -0.004844529088586569,
                    0.02965850755572319,
                    0.04021488130092621,
                    -0.08575352281332016,
                    -0.05008227750658989,
                    0.04415971785783768,
                    -0.02620581164956093,
                    0.08903394639492035,
                    -0.09125161170959473,
                    -0.04583772271871567,
                    0.04113651439547539,
                    -0.06968992948532104,
                    -0.008695084601640701,
                    -0.06169112026691437,
                    0.09963105618953705,
                    -0.02527027763426304,
                    0.05676872283220291,
                    -0.05521740764379501,
                    -0.024318834766745567,
                    0.02769654616713524,
                    -0.030037034302949905,
                    -0.06043630838394165,
                    -0.10038153827190399,
                    0.06443329900503159,
                    -0.0007933545857667923,
                    0.047974519431591034,
                    0.03079208731651306,
                    -0.014996029436588287,
                    -0.06113704293966293,
                    0.06538087874650955,
                    0.07908664643764496,
                    -0.06194307655096054,
                    -0.05564046651124954,
                    0.0731285810470581,
                    -0.004024744965136051,
                    -0.09377651661634445,
                    0.0037386594340205193,
                    -0.0620507076382637,
                    -0.042804840952157974,
                    0.05151744559407234,
                    0.04411958158016205,
                    -0.04300716519355774,
                    0.046055540442466736,
                    -0.11333173513412476,
                    0.044743917882442474,
                    0.028440922498703003,
                    -0.030208898708224297,
                    -0.03789050877094269,
                    0.03813241422176361,
                    -0.11657308787107468,
                    -0.004269180353730917,
                    -0.05718669295310974,
                    -0.05868377909064293,
                    0.09270644932985306,
                    -0.027237366884946823,
                    -0.02669902890920639,
                    0.03759409859776497,
                    0.09161373972892761,
                    -0.03388608247041702,
                    0.05803864449262619,
                    -0.027624815702438354,
                    -0.013160662725567818,
                    0.15302325785160065,
                    -0.05099167674779892,
                    -0.021907055750489235,
                    -0.003558736527338624,
                    -0.012383915483951569,
                    -0.05745413154363632,
                    -0.06922826915979385,
                    0.06488949060440063,
                    -0.1015322357416153,
                    -0.010763954371213913,
                    -0.004547243006527424,
                    -0.034832246601581573,
                    0.06927928328514099,
                    0.09269414842128754,
                    -0.08487626910209656,
                    0.03369160369038582,
                    -0.06037396565079689,
                    0.013028069399297237,
                    0.020724711939692497,
                    0.08420060575008392,
                    -0.07206231355667114,
                    0.05001268535852432,
                    -0.03057074546813965,
                    0.02273985929787159,
                    -0.06900549679994583,
                    0.0266738124191761,
                    -0.10618472099304199,
                    0.012430734932422638,
                    -0.0272216796875,
                    0.03302537649869919,
                    -0.06081144139170647,
                    -0.04641231521964073,
                    -0.026172157377004623,
                    -0.017125241458415985,
                    0.0035556387156248093,
                    -0.10467533767223358,
                    0.06191713735461235,
                    0.015520241111516953,
                    -0.08208943158388138,
                    0.013319719582796097,
                    0.0430762842297554,
                    -0.030431360006332397,
                    -0.0312255397439003,
                    -0.044801294803619385,
                    -0.01272059790790081,
                    -0.031243594363331795,
                    -0.02948901057243347,
                    -0.03641573339700699,
                    0.014457393437623978,
                    0.11863423883914948,
                    0.04746735841035843,
                    -0.0048352256417274475,
                    -0.010654343292117119,
                    0.024874985218048096,
                    -0.030162334442138672,
                    0.03196435049176216,
                    0.03227885812520981,
                    0.11875252425670624,
                    0.12039106339216232,
                    -0.06018982082605362,
                    -0.001132134348154068,
                    -0.016706958413124084,
                    -0.0458856001496315,
                    -0.03252970054745674,
                    0.06981202960014343,
                    0.10722853243350983,
                    -0.02985442243516445,
                    0.10714630037546158,
                    0.027644729241728783,
                    0.023657184094190598,
                    0.06039128452539444,
                    0.04884229600429535,
                    0.08534932136535645,
                    -0.05852134898304939,
                    -0.01062268391251564,
                    0.09067694842815399,
                    -0.007002990692853928,
                    -0.06438707560300827,
                    -0.07320911437273026,
                    0.015611373819410801,
                    -0.04758374020457268,
                    0.0022391374222934246,
                    -0.08257844299077988,
                    0.09246063977479935,
                    0.050614114850759506,
                    0.05518772453069687,
                    -0.06172776222229004,
                    -0.0024595027789473534,
                    -0.01641186513006687,
                    -0.00550489965826273,
                    0.07668381929397583,
                    0.021168909966945648,
                    0.11234768480062485,
                    -0.02729143388569355,
                    0.10351619124412537,
                    -0.008791502565145493,
                    0.034087054431438446,
                    -0.007016240153461695,
                    0.062453821301460266,
                    -0.025973625481128693,
                    -0.021574540063738823,
                    -0.011657485738396645,
                    -0.06498245149850845,
                    0.07539226859807968,
                    -0.01305276807397604,
                    0.01768411323428154,
                    -0.025607306510210037,
                    0.038181062787771225,
                    -0.02092936635017395,
                    -0.03939877822995186,
                    0.005649838596582413,
                    -0.04968114197254181,
                    -0.08514118194580078,
                    -0.062078289687633514,
                    0.03787488117814064,
                    -0.03726494684815407,
                    0.06873738765716553,
                    -0.014741375111043453,
                    -0.02763678878545761,
                    0.04284662753343582,
                    -0.05177239328622818,
                    0.0947192907333374,
                    -0.08072991669178009,
                    -0.07732976227998734,
                    -0.033079687505960464,
                    0.014581817202270031,
                    0.005360197275876999,
                    -0.00777837447822094,
                    -0.06794721633195877,
                    -0.0632137730717659,
                    -0.02949339896440506,
                    -0.02867906168103218,
                    0.02911524474620819,
                    -0.08247529715299606,
                    -0.09145283699035645,
                    0.10097086429595947,
                    -0.030225787311792374,
                    0.03262840211391449,
                    0.05034548416733742,
                    0.014533773064613342,
                    -0.02142558991909027,
                    0.10531431436538696,
                    0.029164448380470276,
                    0.052600301802158356,
                    -0.023228589445352554,
                    -0.0396418496966362,
                    0.011236422695219517,
                    -0.04558756574988365,
                    -0.010579760186374187,
                    -0.07162317633628845,
                    -0.008259428665041924,
                    -0.027508240193128586,
                    0.018657952547073364,
                    0.059038858860731125,
                    -0.020111272111535072,
                    -0.00456999521702528,
                    0.04071073979139328,
                    0.09843720495700836,
                    0.09225452691316605,
                    -0.06368356943130493,
                    0.032785337418317795,
                    -0.028692809864878654,
                    -0.044628363102674484,
                    0.09093868732452393,
                    -0.04484636336565018,
                    0.06593196839094162,
                    -0.0012029558420181274,
                    -0.05389914661645889,
                    -0.07785981893539429,
                    0.010298659093677998,
                    0.015052289701998234,
                    -0.09041107445955276,
                    0.0016665048897266388,
                    0.05993293225765228,
                    -0.0486583337187767,
                    -0.07723705470561981,
                    0.11548569798469543,
                    -0.02974545955657959,
                    0.010112252086400986,
                    -0.022960111498832703,
                    -0.02819531410932541,
                    0.0972241684794426,
                    0.06913712620735168,
                    -0.07083188742399216,
                    -0.0030351560562849045
                ],
                "diffText": "diff --git a/src/librawspeed/decoders/ArwDecoder.cpp b/src/librawspeed/decoders/ArwDecoder.cpp\nindex 8b671f77..ff973605 100644\n--- a/src/librawspeed/decoders/ArwDecoder.cpp\n+++ b/src/librawspeed/decoders/ArwDecoder.cpp\n@@ -425,15 +425,21 @@ void ArwDecoder::GetWB() {\n \n     // \"Decrypt\" IFD\n     const auto& ifd_crypt = priv->getRootIfdData();\n-    auto ifd_size = ifd_crypt.getSize();\n-    auto ifd_decoded = Buffer::Create(ifd_size);\n+    const auto EncryptedBuffer = ifd_crypt.getSubView(off, len);\n+    // We do have to prepend 'off' padding, because TIFF uses absolute offsets.\n+    const auto DecryptedBufferSize = off + EncryptedBuffer.getSize();\n+    auto DecryptedBuffer = Buffer::Create(DecryptedBufferSize);\n \n-    SonyDecrypt(reinterpret_cast<const uint32*>(ifd_crypt.getData(off, len)),\n-                reinterpret_cast<uint32*>(ifd_decoded.get() + off), len / 4,\n+    SonyDecrypt(reinterpret_cast<const uint32*>(EncryptedBuffer.begin()),\n+                reinterpret_cast<uint32*>(DecryptedBuffer.get() + off), len / 4,\n                 key);\n \n     NORangesSet<Buffer> ifds_decoded;\n-    Buffer decIFD(move(ifd_decoded), ifd_size);\n+    Buffer decIFD(std::move(DecryptedBuffer), DecryptedBufferSize);\n+    const Buffer Padding(decIFD.getSubView(0, off));\n+    // The Decrypted Root Ifd can not point to preceding padding buffer.\n+    ifds_decoded.emplace(Padding);\n+\n     DataBuffer dbIDD(decIFD, priv->getRootIfdData().getByteOrder());\n     TiffRootIFD encryptedIFD(nullptr, &ifds_decoded, dbIDD, off);\n "
            }
        },
        "relation2": {
            "identity": 20406,
            "start": 9902,
            "end": 1874,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 1874,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "src/librawspeed/decoders/ArwDecoder.cpp"
            }
        }
    },
    {
        "baseNode": {
            "identity": 9900,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-7884"
            }
        },
        "relation1": {
            "identity": 20405,
            "start": 9900,
            "end": 759,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 759,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "librawspeed"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 9900,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-7884"
            }
        },
        "relation1": {
            "identity": 20404,
            "start": 9900,
            "end": 9901,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 9901,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "msan",
                "report_content": "INFO: Seed: 3324126958\nINFO: Loaded 1 modules   (12100 inline 8-bit counters): 12100 [0xc82e90, 0xc85dd4), \nINFO: Loaded 1 PC tables (12100 PCs): 12100 [0xc85dd8,0xcb5218), \n/out/TiffDecoderFuzzer-ArwDecoder: Running 1 inputs 1 time(s) each.\nRunning: /tmp/poc\n==1==WARNING: MemorySanitizer: use-of-uninitialized-value\n    #0 0x624b06 in rawspeed::TiffEntry::TiffEntry(rawspeed::TiffIFD*, rawspeed::ByteStream*) /src/librawspeed/src/librawspeed/tiff/TiffEntry.cpp:48:7\n    #1 0x628791 in std::__1::__unique_if<rawspeed::TiffEntry>::__unique_single std::__1::make_unique<rawspeed::TiffEntry, rawspeed::TiffIFD*, rawspeed::ByteStream*&>(rawspeed::TiffIFD*&&, rawspeed::ByteStream*&) /usr/local/bin/../include/c++/v1/memory:3075:32\n    #2 0x628791 in rawspeed::TiffIFD::parseIFDEntry(std::__1::set<rawspeed::Buffer, rawspeed::RangesOverlapCmp<rawspeed::Buffer>, std::__1::allocator<rawspeed::Buffer> >*, rawspeed::ByteStream*) /src/librawspeed/src/librawspeed/tiff/TiffIFD.cpp:51\n    #3 0x62fabb in rawspeed::TiffIFD::TiffIFD(rawspeed::TiffIFD*, std::__1::set<rawspeed::Buffer, rawspeed::RangesOverlapCmp<rawspeed::Buffer>, std::__1::allocator<rawspeed::Buffer> >*, rawspeed::DataBuffer const&, unsigned int) /src/librawspeed/src/librawspeed/tiff/TiffIFD.cpp:114:5\n    #4 0x524a11 in rawspeed::TiffRootIFD::TiffRootIFD(rawspeed::TiffIFD*, std::__1::set<rawspeed::Buffer, rawspeed::RangesOverlapCmp<rawspeed::Buffer>, std::__1::allocator<rawspeed::Buffer> >*, rawspeed::DataBuffer const&, unsigned int) /src/librawspeed/src/librawspeed/tiff/TiffIFD.h:104:9\n    #5 0x524a11 in rawspeed::ArwDecoder::GetWB() /src/librawspeed/src/librawspeed/decoders/ArwDecoder.cpp:440\n    #6 0x5219a9 in rawspeed::ArwDecoder::decodeMetaDataInternal(rawspeed::CameraMetaData const*) /src/librawspeed/src/librawspeed/decoders/ArwDecoder.cpp:359:7\n    #7 0x5be17e in rawspeed::RawDecoder::decodeMetaData(rawspeed::CameraMetaData const*) /src/librawspeed/src/librawspeed/decoders/RawDecoder.cpp:290:5\n    #8 0x4eafc2 in LLVMFuzzerTestOneInput /src/librawspeed/fuzz/librawspeed/decoders/TiffDecoders/main.cpp:77:14\n    #9 0x7a1846 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:515:13\n    #10 0x760e11 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:280:6\n    #11 0x775066 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:703:9\n    #12 0x75ff51 in main /src/libfuzzer/FuzzerMain.cpp:20:10\n    #13 0x7f8e08c3583f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n    #14 0x46c9b8 in _start (/out/TiffDecoderFuzzer-ArwDecoder+0x46c9b8)\n\nDEDUP_TOKEN: rawspeed::TiffEntry::TiffEntry(rawspeed::TiffIFD*, rawspeed::ByteStream*)--std::__1::__unique_if<rawspeed::TiffEntry>::__unique_single std::__1::make_unique<rawspeed::TiffEntry, rawspeed::TiffIFD*, rawspeed::ByteStream*&>(rawspeed::TiffIFD*&&, rawspeed::ByteStream*&)--rawspeed::TiffIFD::parseIFDEntry(std::__1::set<rawspeed::Buffer, rawspeed::RangesOverlapCmp<rawspeed::Buffer>, std::__1::allocator<rawspeed::Buffer> >*, rawspeed::ByteStream*)\n  Uninitialized value was created by a heap allocation\n    #0 0x4aa6d4 in __interceptor_posix_memalign /src/llvm/projects/compiler-rt/lib/msan/msan_interceptors.cc:173\n    #1 0x600f18 in rawspeed::alignedMalloc(unsigned long, unsigned long) /src/librawspeed/src/librawspeed/common/Memory.cpp:62:12\n    #2 0x508966 in unsigned char* rawspeed::alignedMalloc<unsigned char, 16ul>(unsigned long) /src/librawspeed/src/librawspeed/common/Memory.h:60:31\n    #3 0x508966 in rawspeed::Buffer::Create(unsigned int) /src/librawspeed/src/librawspeed/io/Buffer.cpp:39\n    #4 0x522e8e in rawspeed::ArwDecoder::GetWB() /src/librawspeed/src/librawspeed/decoders/ArwDecoder.cpp:431:24\n    #5 0x5219a9 in rawspeed::ArwDecoder::decodeMetaDataInternal(rawspeed::CameraMetaData const*) /src/librawspeed/src/librawspeed/decoders/ArwDecoder.cpp:359:7\n    #6 0x5be17e in rawspeed::RawDecoder::decodeMetaData(rawspeed::CameraMetaData const*) /src/librawspeed/src/librawspeed/decoders/RawDecoder.cpp:290:5\n    #7 0x4eafc2 in LLVMFuzzerTestOneInput /src/librawspeed/fuzz/librawspeed/decoders/TiffDecoders/main.cpp:77:14\n    #8 0x7a1846 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/libfuzzer/FuzzerLoop.cpp:515:13\n    #9 0x760e11 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/libfuzzer/FuzzerDriver.cpp:280:6\n    #10 0x775066 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/libfuzzer/FuzzerDriver.cpp:703:9\n    #11 0x75ff51 in main /src/libfuzzer/FuzzerMain.cpp:20:10\n    #12 0x7f8e08c3583f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n\nDEDUP_TOKEN: __interceptor_posix_memalign--rawspeed::alignedMalloc(unsigned long, unsigned long)--unsigned char* rawspeed::alignedMalloc<unsigned char, 16ul>(unsigned long)\nSUMMARY: MemorySanitizer: use-of-uninitialized-value /src/librawspeed/src/librawspeed/tiff/TiffEntry.cpp:48:7 in rawspeed::TiffEntry::TiffEntry(rawspeed::TiffIFD*, rawspeed::ByteStream*)\nUnique heap origins: 101\nStack depot allocated bytes: 8448\nUnique origin histories: 6\nHistory depot allocated bytes: 144\nExiting\n\nReturn Code: 77\n",
                "report_embeddings": [
                    0.005355326924473047,
                    0.031555429100990295,
                    -0.07337481528520584,
                    -0.007347314618527889,
                    0.018683576956391335,
                    0.014798554591834545,
                    -0.009190543554723263,
                    0.02624201774597168,
                    0.059426289051771164,
                    -0.07968713343143463,
                    0.05858898162841797,
                    -0.03753868490457535,
                    -0.04074982926249504,
                    -0.0005736731109209359,
                    0.06561131775379181,
                    -0.027291035279631615,
                    0.1134989857673645,
                    0.062475014477968216,
                    0.07449282705783844,
                    0.06186038255691528,
                    -0.032424140721559525,
                    0.0014867017744109035,
                    -0.031657300889492035,
                    -0.016745135188102722,
                    -0.0719430148601532,
                    0.04072657972574234,
                    -0.08852039277553558,
                    -0.03770461678504944,
                    1.542195604997687e-05,
                    -0.028411652892827988,
                    -0.07093890756368637,
                    -0.12999166548252106,
                    0.07721854746341705,
                    -0.03987174853682518,
                    0.03903483599424362,
                    -0.05995819717645645,
                    0.0038588077295571566,
                    -0.01014905795454979,
                    0.03034467063844204,
                    0.13530226051807404,
                    -0.07461245357990265,
                    -0.03731574863195419,
                    0.06747971475124359,
                    0.011727895587682724,
                    -0.07851777225732803,
                    0.0872458666563034,
                    0.03706398978829384,
                    -0.05507736653089523,
                    0.07581117004156113,
                    -0.020290030166506767,
                    -0.0931098610162735,
                    -0.002331699477508664,
                    -0.11169632524251938,
                    -0.06805860251188278,
                    -0.014327076263725758,
                    -0.11055468022823334,
                    0.012226416729390621,
                    0.09369709342718124,
                    -0.04850270599126816,
                    0.09031768143177032,
                    0.011294792406260967,
                    -0.040923021733760834,
                    0.06290070712566376,
                    -0.016361568123102188,
                    -0.015843898057937622,
                    0.002642907202243805,
                    0.060603320598602295,
                    0.01893005333840847,
                    0.05552578717470169,
                    0.010766290128231049,
                    0.018479643389582634,
                    0.17350426316261292,
                    -0.03855904936790466,
                    -0.10310318320989609,
                    0.0068005784414708614,
                    0.052523382008075714,
                    -0.005737473256886005,
                    0.0033141702879220247,
                    -0.023515617474913597,
                    -0.1286986768245697,
                    -0.033204417675733566,
                    0.030582726001739502,
                    0.04664082080125809,
                    0.07353987544775009,
                    0.01995859481394291,
                    0.04353805631399155,
                    -0.024083444848656654,
                    -0.052489567548036575,
                    0.00037887171492911875,
                    -0.033795591443777084,
                    0.05898582190275192,
                    -0.07415531575679779,
                    0.008499271236360073,
                    -0.05765523761510849,
                    0.0162019245326519,
                    -0.035026855766773224,
                    0.05845369026064873,
                    0.016218749806284904,
                    -0.022956447675824165,
                    -0.0016565561527386308,
                    -0.059813302010297775,
                    -0.08288842439651489,
                    0.03009643778204918,
                    -0.08413071930408478,
                    -0.04169846326112747,
                    0.001268777996301651,
                    -0.08166965842247009,
                    0.008663803339004517,
                    0.0026959911920130253,
                    -0.06037254258990288,
                    -0.020520884543657303,
                    -0.03762008622288704,
                    -0.014801889657974243,
                    0.08551938831806183,
                    0.10156760364770889,
                    -0.045844629406929016,
                    -0.019715337082743645,
                    -0.0920897051692009,
                    0.040140993893146515,
                    0.0735095962882042,
                    -0.01819845847785473,
                    0.02122669480741024,
                    -0.08917437493801117,
                    0.02058427594602108,
                    -0.040117792785167694,
                    -0.054951976984739304,
                    0.03815460950136185,
                    0.03224934637546539,
                    0.06394156813621521,
                    0.0861242413520813,
                    -0.030642515048384666,
                    -0.0022934910375624895,
                    0.04482373967766762,
                    0.026601608842611313,
                    0.011191874742507935,
                    0.04174403101205826,
                    0.11047405004501343,
                    -0.03929571434855461,
                    0.010171240195631981,
                    -0.027798602357506752,
                    0.061137594282627106,
                    0.050047166645526886,
                    -0.07426251471042633,
                    0.035915933549404144,
                    -0.0287180133163929,
                    -0.05428391695022583,
                    0.019249381497502327,
                    0.004155122675001621,
                    -0.029589500278234482,
                    -0.019004108384251595,
                    0.019676318392157555,
                    -0.0035539399832487106,
                    -0.12129747867584229,
                    -0.06088525056838989,
                    0.03269992396235466,
                    -0.0034529822878539562,
                    -0.04178993031382561,
                    -0.0250396691262722,
                    -0.11139695346355438,
                    -0.027526309713721275,
                    0.012794749811291695,
                    0.09808333218097687,
                    -0.002540078479796648,
                    0.1409451812505722,
                    -0.05000252649188042,
                    0.007665053941309452,
                    -0.010657158680260181,
                    -0.0014470011228695512,
                    -0.001086678123101592,
                    0.05122949928045273,
                    -0.019404135644435883,
                    0.005941490642726421,
                    0.02620820142328739,
                    -0.043833471834659576,
                    -0.0036549195647239685,
                    -0.02628958597779274,
                    -0.04810825735330582,
                    0.035053227096796036,
                    0.004422475583851337,
                    -0.0006955880089662969,
                    -0.05400563403964043,
                    0.013885946944355965,
                    -0.004907186143100262,
                    -0.08586923032999039,
                    -0.0037830874789506197,
                    0.11158987134695053,
                    -0.01653350703418255,
                    0.0072796763852238655,
                    0.01670501008629799,
                    -0.02845587767660618,
                    0.06558486074209213,
                    -0.07619356364011765,
                    0.02201187238097191,
                    -0.031198903918266296,
                    -0.1444566547870636,
                    0.03476140648126602,
                    0.0021517134737223387,
                    0.03452621400356293,
                    -0.008713985793292522,
                    -0.12633353471755981,
                    -0.09399307519197464,
                    -0.027528192847967148,
                    0.056474946439266205,
                    0.012655330821871758,
                    -0.02212238498032093,
                    -0.1013021320104599,
                    0.06494727730751038,
                    -0.017080824822187424,
                    0.043554626405239105,
                    -0.016152657568454742,
                    -0.00018461793661117554,
                    0.039941929280757904,
                    0.04975055903196335,
                    0.00686509907245636,
                    -0.006620916072279215,
                    -0.043562039732933044,
                    -0.008388392627239227,
                    -0.008206840604543686,
                    -0.0914575383067131,
                    -0.0018878750270232558,
                    -0.035996485501527786,
                    0.018581952899694443,
                    0.032951273024082184,
                    -0.0812617763876915,
                    0.04290322959423065,
                    -0.03423018008470535,
                    -0.030696004629135132,
                    0.12059891223907471,
                    0.05982205271720886,
                    0.035966575145721436,
                    -0.11656861007213593,
                    0.045655813068151474,
                    -0.03541010245680809,
                    -0.016570236533880234,
                    0.07042144984006882,
                    -0.014411961659789085,
                    0.14071927964687347,
                    0.046300195157527924,
                    -0.0014442162355408072,
                    -0.02463088370859623,
                    -0.0032963224221020937,
                    0.02745351567864418,
                    -0.04290720075368881,
                    0.00900171510875225,
                    0.13635358214378357,
                    -0.07868476957082748,
                    -0.07234770804643631,
                    0.016957523301243782,
                    -0.008422466926276684,
                    0.03812918812036514,
                    -0.032874587923288345,
                    -0.016002539545297623,
                    0.11127907037734985,
                    0.040284935384988785,
                    -0.00016497037722729146,
                    -0.06194644048810005
                ],
                "report_type": "Use-of-uninitialized-value",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 9900,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-7884"
            }
        },
        "relation1": {
            "identity": 20403,
            "start": 9900,
            "end": 8200,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 8200,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "ArwDecoder::GetWB(): slightly less broken handling of IFD decryption.\n\n1. We should only alloc off+len bytes for the new buffer,\n   not the entire size of original IFD buffer\n   Because we only decode [off, len).\n   Otherwise we'd end up with uninitialized garbage at the end.\n2. We do not decode [0, off), thus that contains uninitialized garbage.\n   Thus we should not allow IFD to point into that.\n",
                "sha": "ab959c2235ab69359cdc75372c5cdf7bcc324726",
                "repo": "librawspeed",
                "encoding": "UTF-8",
                "authored_date": 1529515931,
                "committer_tz_offset": -10800,
                "author_tz_offset": -10800,
                "committed_date": 1529515931
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 9900,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-7884"
            }
        },
        "relation1": {
            "identity": 20402,
            "start": 9900,
            "end": 8198,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 8198,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "KdcDecoder: read sensor dimensions from the appropriate entries.\n\nThese two entries, for two[*] samples that are currently working,\nresult in the very same final image dimensions that we'd get\nafter incrementing. But avoiding increment avoids overflow.\n\n* Kodak P880 and Z1015 IS\n  Other raws that should be handled by this path are mis-decoded already.\n\nZ1015 IS hash changes though, one last row is gone.\nMaybe we are still looking at the wrong tags.\nBut i'm not seeing the obvious visual symptom (stairstep)\nof a wrong width/pitch, so not sure yet.\n",
                "sha": "391feeebb3345309986ac5319175155613ab96cd",
                "repo": "librawspeed",
                "encoding": "UTF-8",
                "authored_date": 1529511084,
                "committer_tz_offset": -10800,
                "author_tz_offset": -10800,
                "committed_date": 1529512571
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]