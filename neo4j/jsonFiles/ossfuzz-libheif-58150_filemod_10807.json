[
    {
        "baseNode": {
            "identity": 10800,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-58150"
            }
        },
        "relation1": {
            "identity": 22356,
            "start": 10800,
            "end": 10807,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 10807,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.027451178058981895,
                    0.06414085626602173,
                    -0.13282740116119385,
                    0.03301507607102394,
                    0.02302037551999092,
                    -0.02817489765584469,
                    0.08056142926216125,
                    0.0602421835064888,
                    0.07235376536846161,
                    -0.10165204107761383,
                    0.05524712800979614,
                    0.06359249353408813,
                    -0.05913154035806656,
                    -0.11994393169879913,
                    -0.021031297743320465,
                    -0.01294486690312624,
                    0.1445566713809967,
                    -0.04056714475154877,
                    0.04370804503560066,
                    0.050928618758916855,
                    -0.023594452068209648,
                    0.06435522437095642,
                    0.024945886805653572,
                    -0.002650535199791193,
                    0.007345747202634811,
                    -0.021667800843715668,
                    -0.01757093518972397,
                    0.07619541138410568,
                    0.025384945794939995,
                    0.03447594866156578,
                    -0.09389801323413849,
                    -0.049545589834451675,
                    -0.0011666431091725826,
                    0.03722119703888893,
                    0.022077621892094612,
                    -0.03787323459982872,
                    0.006425222381949425,
                    -0.057249344885349274,
                    0.0014435454504564404,
                    0.10227382928133011,
                    -0.024448934942483902,
                    -0.08416798710823059,
                    0.0320507176220417,
                    -0.01640552096068859,
                    -0.07619115710258484,
                    0.03377607464790344,
                    -0.027412720024585724,
                    -0.03734511509537697,
                    0.0017860863590613008,
                    0.008520195260643959,
                    0.0113441227003932,
                    -0.08377228677272797,
                    -0.06472810357809067,
                    0.019676972180604935,
                    -0.052993517369031906,
                    0.054662760347127914,
                    -0.0530284084379673,
                    -0.07123561203479767,
                    -0.07781601697206497,
                    0.05981806665658951,
                    -0.07430294156074524,
                    -0.07162649929523468,
                    -0.113413505256176,
                    -0.008779685012996197,
                    0.023414498195052147,
                    -0.028158828616142273,
                    0.09121734648942947,
                    0.015292906202375889,
                    0.03785096853971481,
                    -0.061108916997909546,
                    0.05837824195623398,
                    0.0017378497868776321,
                    -0.08186180889606476,
                    0.03638116270303726,
                    -0.06945846974849701,
                    -0.03351612389087677,
                    -0.0434316024184227,
                    -0.10541693866252899,
                    -0.06443053483963013,
                    -0.0939098671078682,
                    0.0016223809216171503,
                    -0.023655029013752937,
                    0.021939128637313843,
                    -0.033409859985113144,
                    0.05567391961812973,
                    -0.05888696014881134,
                    0.15376387536525726,
                    0.06942812353372574,
                    0.0680915117263794,
                    -0.04297112300992012,
                    0.0002449000021442771,
                    0.025805503129959106,
                    0.07542288303375244,
                    -0.04568542167544365,
                    0.039322447031736374,
                    0.008347496390342712,
                    -0.058646656572818756,
                    -0.03554704785346985,
                    0.013000406324863434,
                    -0.024553904309868813,
                    -0.07603257894515991,
                    -0.13573062419891357,
                    -0.08838381618261337,
                    0.011812119744718075,
                    -0.08147941529750824,
                    -0.07049468904733658,
                    -0.0483437180519104,
                    0.07163465023040771,
                    0.06339290738105774,
                    -0.0434228777885437,
                    -0.047117963433265686,
                    0.008794669061899185,
                    0.018397711217403412,
                    0.12432097643613815,
                    0.06820143014192581,
                    -0.03237006068229675,
                    -0.04072630777955055,
                    -0.06903728097677231,
                    -0.001136957318522036,
                    0.08470053225755692,
                    -0.06290952116250992,
                    0.039198137819767,
                    0.08772828429937363,
                    -0.07075139880180359,
                    0.04198618233203888,
                    0.0008858768851496279,
                    0.03557034209370613,
                    0.02647104300558567,
                    0.04076876491308212,
                    0.08462124317884445,
                    -0.07948990911245346,
                    -0.08724023401737213,
                    0.05369238927960396,
                    -0.1025930792093277,
                    0.0600714311003685,
                    0.004050161689519882,
                    0.11476613581180573,
                    0.11114480346441269,
                    -0.026394428685307503,
                    -0.008531847037374973,
                    0.03811836615204811,
                    0.018306737765669823,
                    -0.0026108776219189167,
                    0.09607196599245071,
                    0.022167755290865898,
                    -0.029516080394387245,
                    0.044818777590990067,
                    -0.013590184040367603,
                    -0.12425598502159119,
                    -0.025796152651309967,
                    -0.03400643169879913,
                    -0.016955088824033737,
                    -0.17738014459609985,
                    0.007018425967544317,
                    0.06946995854377747,
                    0.0033849114552140236,
                    0.03161995857954025,
                    -0.04251181334257126,
                    0.048811107873916626,
                    -0.05373542010784149,
                    0.014712125062942505,
                    0.1661241501569748,
                    -0.0051790811121463776,
                    0.13958881795406342,
                    -0.013686100952327251,
                    0.03443469479680061,
                    -0.06134694442152977,
                    0.004376180935651064,
                    0.008081454783678055,
                    0.08808808028697968,
                    0.07080595195293427,
                    0.06867599487304688,
                    0.01283690519630909,
                    -0.01525485422462225,
                    0.055210087448358536,
                    -0.11830776929855347,
                    -0.012017722241580486,
                    -0.05631479620933533,
                    0.02214064449071884,
                    -0.021646693348884583,
                    0.10573561489582062,
                    0.024350274354219437,
                    -0.045717544853687286,
                    -0.02046002633869648,
                    -0.02977542206645012,
                    0.05379835516214371,
                    -0.06360723823308945,
                    -0.10837391018867493,
                    -0.052557799965143204,
                    -0.06472528725862503,
                    -0.06565942615270615,
                    -0.002248791977763176,
                    -0.07336799800395966,
                    -0.09723721444606781,
                    -0.1332818567752838,
                    0.040784165263175964,
                    0.0043716770596802235,
                    -0.007031769026070833,
                    0.007206927984952927,
                    -0.03299615532159805,
                    -0.14841067790985107,
                    -0.056426435708999634,
                    0.025322623550891876,
                    0.03274746239185333,
                    0.19935119152069092,
                    -0.07613255828619003,
                    0.10652060061693192,
                    -0.05162197723984718,
                    0.09143465757369995,
                    -0.029640071094036102,
                    -0.022227350622415543,
                    0.0440451018512249,
                    0.053934164345264435,
                    0.008804135955870152,
                    0.11824904382228851,
                    -0.05032071843743324,
                    0.04435257241129875,
                    -0.00414590910077095,
                    0.02166431024670601,
                    0.0006437549600377679,
                    -0.06319267302751541,
                    0.045881763100624084,
                    -0.0736517384648323,
                    -0.05332623049616814,
                    0.05383177846670151,
                    -0.01358078047633171,
                    0.04492612183094025,
                    -0.04069191589951515,
                    0.03989225625991821,
                    0.034399326890707016,
                    0.013791213743388653,
                    0.02467001974582672,
                    0.10149744898080826,
                    -0.06643591821193695,
                    0.015089843422174454,
                    -0.12231719493865967,
                    -0.012478137388825417,
                    0.05805348977446556,
                    0.052996277809143066,
                    -0.07900191098451614,
                    0.061257004737854004,
                    -0.002950318157672882,
                    -0.011257370933890343,
                    0.03774067014455795,
                    0.06047530844807625,
                    0.049594055861234665,
                    0.02473658323287964,
                    0.01927560195326805,
                    -0.04507853463292122,
                    -0.030454134568572044,
                    0.028498012572526932,
                    -0.03821755200624466,
                    0.050849609076976776,
                    0.13515445590019226,
                    -0.005882664117962122,
                    -0.05427961051464081
                ],
                "diffText": "diff --git a/libheif/region.cc b/libheif/region.cc\nindex 4c3fccc..417fade 100644\n--- a/libheif/region.cc\n+++ b/libheif/region.cc\n@@ -60,6 +60,11 @@ Error RegionItem::parse(const std::vector<uint8_t>& data)\n   uint8_t region_count = data[dataOffset];\n   dataOffset += 1;\n   for (int i = 0; i < region_count; i++) {\n+    if (data.size() <= dataOffset) {\n+      return Error(heif_error_Invalid_input, heif_suberror_Invalid_region_data,\n+                   \"Region data incomplete\");\n+    }\n+\n     uint8_t geometry_type = data[dataOffset];\n     dataOffset += 1;\n "
            }
        },
        "relation2": {
            "identity": 22356,
            "start": 10807,
            "end": 10800,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 10800,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-58150"
            }
        }
    },
    {
        "baseNode": {
            "identity": 10800,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-58150"
            }
        },
        "relation1": {
            "identity": 22356,
            "start": 10800,
            "end": 10807,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 10807,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.027451178058981895,
                    0.06414085626602173,
                    -0.13282740116119385,
                    0.03301507607102394,
                    0.02302037551999092,
                    -0.02817489765584469,
                    0.08056142926216125,
                    0.0602421835064888,
                    0.07235376536846161,
                    -0.10165204107761383,
                    0.05524712800979614,
                    0.06359249353408813,
                    -0.05913154035806656,
                    -0.11994393169879913,
                    -0.021031297743320465,
                    -0.01294486690312624,
                    0.1445566713809967,
                    -0.04056714475154877,
                    0.04370804503560066,
                    0.050928618758916855,
                    -0.023594452068209648,
                    0.06435522437095642,
                    0.024945886805653572,
                    -0.002650535199791193,
                    0.007345747202634811,
                    -0.021667800843715668,
                    -0.01757093518972397,
                    0.07619541138410568,
                    0.025384945794939995,
                    0.03447594866156578,
                    -0.09389801323413849,
                    -0.049545589834451675,
                    -0.0011666431091725826,
                    0.03722119703888893,
                    0.022077621892094612,
                    -0.03787323459982872,
                    0.006425222381949425,
                    -0.057249344885349274,
                    0.0014435454504564404,
                    0.10227382928133011,
                    -0.024448934942483902,
                    -0.08416798710823059,
                    0.0320507176220417,
                    -0.01640552096068859,
                    -0.07619115710258484,
                    0.03377607464790344,
                    -0.027412720024585724,
                    -0.03734511509537697,
                    0.0017860863590613008,
                    0.008520195260643959,
                    0.0113441227003932,
                    -0.08377228677272797,
                    -0.06472810357809067,
                    0.019676972180604935,
                    -0.052993517369031906,
                    0.054662760347127914,
                    -0.0530284084379673,
                    -0.07123561203479767,
                    -0.07781601697206497,
                    0.05981806665658951,
                    -0.07430294156074524,
                    -0.07162649929523468,
                    -0.113413505256176,
                    -0.008779685012996197,
                    0.023414498195052147,
                    -0.028158828616142273,
                    0.09121734648942947,
                    0.015292906202375889,
                    0.03785096853971481,
                    -0.061108916997909546,
                    0.05837824195623398,
                    0.0017378497868776321,
                    -0.08186180889606476,
                    0.03638116270303726,
                    -0.06945846974849701,
                    -0.03351612389087677,
                    -0.0434316024184227,
                    -0.10541693866252899,
                    -0.06443053483963013,
                    -0.0939098671078682,
                    0.0016223809216171503,
                    -0.023655029013752937,
                    0.021939128637313843,
                    -0.033409859985113144,
                    0.05567391961812973,
                    -0.05888696014881134,
                    0.15376387536525726,
                    0.06942812353372574,
                    0.0680915117263794,
                    -0.04297112300992012,
                    0.0002449000021442771,
                    0.025805503129959106,
                    0.07542288303375244,
                    -0.04568542167544365,
                    0.039322447031736374,
                    0.008347496390342712,
                    -0.058646656572818756,
                    -0.03554704785346985,
                    0.013000406324863434,
                    -0.024553904309868813,
                    -0.07603257894515991,
                    -0.13573062419891357,
                    -0.08838381618261337,
                    0.011812119744718075,
                    -0.08147941529750824,
                    -0.07049468904733658,
                    -0.0483437180519104,
                    0.07163465023040771,
                    0.06339290738105774,
                    -0.0434228777885437,
                    -0.047117963433265686,
                    0.008794669061899185,
                    0.018397711217403412,
                    0.12432097643613815,
                    0.06820143014192581,
                    -0.03237006068229675,
                    -0.04072630777955055,
                    -0.06903728097677231,
                    -0.001136957318522036,
                    0.08470053225755692,
                    -0.06290952116250992,
                    0.039198137819767,
                    0.08772828429937363,
                    -0.07075139880180359,
                    0.04198618233203888,
                    0.0008858768851496279,
                    0.03557034209370613,
                    0.02647104300558567,
                    0.04076876491308212,
                    0.08462124317884445,
                    -0.07948990911245346,
                    -0.08724023401737213,
                    0.05369238927960396,
                    -0.1025930792093277,
                    0.0600714311003685,
                    0.004050161689519882,
                    0.11476613581180573,
                    0.11114480346441269,
                    -0.026394428685307503,
                    -0.008531847037374973,
                    0.03811836615204811,
                    0.018306737765669823,
                    -0.0026108776219189167,
                    0.09607196599245071,
                    0.022167755290865898,
                    -0.029516080394387245,
                    0.044818777590990067,
                    -0.013590184040367603,
                    -0.12425598502159119,
                    -0.025796152651309967,
                    -0.03400643169879913,
                    -0.016955088824033737,
                    -0.17738014459609985,
                    0.007018425967544317,
                    0.06946995854377747,
                    0.0033849114552140236,
                    0.03161995857954025,
                    -0.04251181334257126,
                    0.048811107873916626,
                    -0.05373542010784149,
                    0.014712125062942505,
                    0.1661241501569748,
                    -0.0051790811121463776,
                    0.13958881795406342,
                    -0.013686100952327251,
                    0.03443469479680061,
                    -0.06134694442152977,
                    0.004376180935651064,
                    0.008081454783678055,
                    0.08808808028697968,
                    0.07080595195293427,
                    0.06867599487304688,
                    0.01283690519630909,
                    -0.01525485422462225,
                    0.055210087448358536,
                    -0.11830776929855347,
                    -0.012017722241580486,
                    -0.05631479620933533,
                    0.02214064449071884,
                    -0.021646693348884583,
                    0.10573561489582062,
                    0.024350274354219437,
                    -0.045717544853687286,
                    -0.02046002633869648,
                    -0.02977542206645012,
                    0.05379835516214371,
                    -0.06360723823308945,
                    -0.10837391018867493,
                    -0.052557799965143204,
                    -0.06472528725862503,
                    -0.06565942615270615,
                    -0.002248791977763176,
                    -0.07336799800395966,
                    -0.09723721444606781,
                    -0.1332818567752838,
                    0.040784165263175964,
                    0.0043716770596802235,
                    -0.007031769026070833,
                    0.007206927984952927,
                    -0.03299615532159805,
                    -0.14841067790985107,
                    -0.056426435708999634,
                    0.025322623550891876,
                    0.03274746239185333,
                    0.19935119152069092,
                    -0.07613255828619003,
                    0.10652060061693192,
                    -0.05162197723984718,
                    0.09143465757369995,
                    -0.029640071094036102,
                    -0.022227350622415543,
                    0.0440451018512249,
                    0.053934164345264435,
                    0.008804135955870152,
                    0.11824904382228851,
                    -0.05032071843743324,
                    0.04435257241129875,
                    -0.00414590910077095,
                    0.02166431024670601,
                    0.0006437549600377679,
                    -0.06319267302751541,
                    0.045881763100624084,
                    -0.0736517384648323,
                    -0.05332623049616814,
                    0.05383177846670151,
                    -0.01358078047633171,
                    0.04492612183094025,
                    -0.04069191589951515,
                    0.03989225625991821,
                    0.034399326890707016,
                    0.013791213743388653,
                    0.02467001974582672,
                    0.10149744898080826,
                    -0.06643591821193695,
                    0.015089843422174454,
                    -0.12231719493865967,
                    -0.012478137388825417,
                    0.05805348977446556,
                    0.052996277809143066,
                    -0.07900191098451614,
                    0.061257004737854004,
                    -0.002950318157672882,
                    -0.011257370933890343,
                    0.03774067014455795,
                    0.06047530844807625,
                    0.049594055861234665,
                    0.02473658323287964,
                    0.01927560195326805,
                    -0.04507853463292122,
                    -0.030454134568572044,
                    0.028498012572526932,
                    -0.03821755200624466,
                    0.050849609076976776,
                    0.13515445590019226,
                    -0.005882664117962122,
                    -0.05427961051464081
                ],
                "diffText": "diff --git a/libheif/region.cc b/libheif/region.cc\nindex 4c3fccc..417fade 100644\n--- a/libheif/region.cc\n+++ b/libheif/region.cc\n@@ -60,6 +60,11 @@ Error RegionItem::parse(const std::vector<uint8_t>& data)\n   uint8_t region_count = data[dataOffset];\n   dataOffset += 1;\n   for (int i = 0; i < region_count; i++) {\n+    if (data.size() <= dataOffset) {\n+      return Error(heif_error_Invalid_input, heif_suberror_Invalid_region_data,\n+                   \"Region data incomplete\");\n+    }\n+\n     uint8_t geometry_type = data[dataOffset];\n     dataOffset += 1;\n "
            }
        },
        "relation2": {
            "identity": 22355,
            "start": 10807,
            "end": 10806,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 10806,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "libheif/region.cc"
            }
        }
    },
    {
        "baseNode": {
            "identity": 10800,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-58150"
            }
        },
        "relation1": {
            "identity": 22352,
            "start": 10800,
            "end": 5009,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 5009,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "libheif"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 10800,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-58150"
            }
        },
        "relation1": {
            "identity": 22351,
            "start": 10800,
            "end": 10805,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 10805,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "INFO: Running with entropic power schedule (0xFF, 100).\nINFO: Seed: 2015735127\nINFO: Loaded 1 modules   (140655 inline 8-bit counters): 140655 [0x28ad4a0, 0x28cfa0f), \nINFO: Loaded 1 PC tables (140655 PCs): 140655 [0x28cfa10,0x2af5100), \n/out/file-fuzzer: Running 1 inputs 1 time(s) each.\nRunning: /tmp/poc\n=================================================================\n==1==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x603000000c60 at pc 0x0000006f9de6 bp 0x7fffc2000ed0 sp 0x7fffc2000ec8\nREAD of size 1 at 0x603000000c60 thread T0\nSCARINESS: 12 (1-byte-read-heap-buffer-overflow)\n    #0 0x6f9de5 in RegionItem::parse(std::__1::vector<unsigned char, std::__1::allocator<unsigned char> > const&) /src/libheif/libheif/region.cc:63:29\n    #1 0x66bba6 in heif::HeifContext::interpret_heif_file() /src/libheif/libheif/heif_context.cc:959:20\n    #2 0x67057e in heif::HeifContext::read_from_memory(void const*, unsigned long, bool) /src/libheif/libheif/heif_context.cc:447:10\n    #3 0x62844f in heif_context_read_from_memory /src/libheif/libheif/heif.cc:447:29\n    #4 0x716349 in LLVMFuzzerTestOneInput /src/libheif/libheif/file_fuzzer.cc:95:9\n    #5 0x441573 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15\n    #6 0x42ccd2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6\n    #7 0x43257c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9\n    #8 0x45bab2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #9 0x7f29f6a73082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: eebe5d5f4b608b8a53ec446b63981bba373ca0ca)\n    #10 0x422e9d in _start (/out/file-fuzzer+0x422e9d)\n\nDEDUP_TOKEN: RegionItem::parse(std::__1::vector<unsigned char, std::__1::allocator<unsigned char> > const&)--heif::HeifContext::interpret_heif_file()--heif::HeifContext::read_from_memory(void const*, unsigned long, bool)\n0x603000000c60 is located 0 bytes to the right of 32-byte region [0x603000000c40,0x603000000c60)\nallocated by thread T0 here:\n    #0 0x56d54d in operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:95:3\n    #1 0x57703a in __libcpp_operator_new<unsigned long> /usr/local/bin/../include/c++/v1/new:245:10\n    #2 0x57703a in __libcpp_allocate /usr/local/bin/../include/c++/v1/new:271:10\n    #3 0x57703a in allocate /usr/local/bin/../include/c++/v1/__memory/allocator.h:105:38\n    #4 0x57703a in allocate /usr/local/bin/../include/c++/v1/__memory/allocator_traits.h:262:20\n    #5 0x57703a in __split_buffer /usr/local/bin/../include/c++/v1/__split_buffer:306:29\n    #6 0x57703a in std::__1::vector<unsigned char, std::__1::allocator<unsigned char> >::__append(unsigned long) /usr/local/bin/../include/c++/v1/vector:1031:53\n    #7 0x597268 in resize /usr/local/bin/../include/c++/v1/vector:1902:15\n    #8 0x597268 in heif::Box_iloc::read_data(heif::Box_iloc::Item const&, std::__1::shared_ptr<heif::StreamReader> const&, std::__1::shared_ptr<heif::Box_idat> const&, std::__1::vector<unsigned char, std::__1::allocator<unsigned char> >*) const /src/libheif/libheif/box.cc:1170:13\n    #9 0x5fe26b in heif::HeifFile::get_compressed_image_data(unsigned int, std::__1::vector<unsigned char, std::__1::allocator<unsigned char> >*) const /src/libheif/libheif/heif_file.cc:722:27\n    #10 0x66bae2 in heif::HeifContext::interpret_heif_file() /src/libheif/libheif/heif_context.cc:955:32\n    #11 0x67057e in heif::HeifContext::read_from_memory(void const*, unsigned long, bool) /src/libheif/libheif/heif_context.cc:447:10\n    #12 0x62844f in heif_context_read_from_memory /src/libheif/libheif/heif.cc:447:29\n    #13 0x716349 in LLVMFuzzerTestOneInput /src/libheif/libheif/file_fuzzer.cc:95:9\n    #14 0x441573 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15\n    #15 0x42ccd2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6\n    #16 0x43257c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9\n    #17 0x45bab2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #18 0x7f29f6a73082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: eebe5d5f4b608b8a53ec446b63981bba373ca0ca)\n\nDEDUP_TOKEN: operator new(unsigned long)--__libcpp_operator_new<unsigned long>--__libcpp_allocate\nSUMMARY: AddressSanitizer: heap-buffer-overflow /src/libheif/libheif/region.cc:63:29 in RegionItem::parse(std::__1::vector<unsigned char, std::__1::allocator<unsigned char> > const&)\nShadow bytes around the buggy address:\n  0x0c067fff8130: fd fd fa fa 00 00 00 00 fa fa 00 00 00 fa fa fa\n  0x0c067fff8140: 00 00 00 fa fa fa fd fd fd fd fa fa 00 00 00 fa\n  0x0c067fff8150: fa fa 00 00 00 fa fa fa fd fd fd fd fa fa fd fd\n  0x0c067fff8160: fd fd fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa\n  0x0c067fff8170: fd fd fd fd fa fa fd fd fd fa fa fa fd fd fd fa\n=>0x0c067fff8180: fa fa fd fd fd fd fa fa 00 00 00 00[fa]fa fa fa\n  0x0c067fff8190: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c067fff81a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c067fff81b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c067fff81c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c067fff81d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.04802198335528374,
                    0.07409197837114334,
                    -0.10123997181653976,
                    0.012806541286408901,
                    -0.009886926971375942,
                    -0.01541641354560852,
                    0.0030649788677692413,
                    0.0371471531689167,
                    0.05745700001716614,
                    -0.04169104993343353,
                    0.008504749275743961,
                    -0.0013131474843248725,
                    -0.04150776192545891,
                    -0.01590404100716114,
                    0.03443838283419609,
                    0.0015092402463778853,
                    0.11478368192911148,
                    0.04325047507882118,
                    0.050214383751153946,
                    0.05175158008933067,
                    -0.03696037828922272,
                    0.02565678395330906,
                    -0.004638089332729578,
                    -0.02418256551027298,
                    -0.03258409723639488,
                    -0.026228489354252815,
                    -0.11984621733427048,
                    -0.01641550101339817,
                    -0.029236475005745888,
                    -0.03315981104969978,
                    -0.10948818176984787,
                    -0.15665891766548157,
                    0.0016216362128034234,
                    -0.0326145775616169,
                    -0.003000040305778384,
                    -0.020352130755782127,
                    0.005681127309799194,
                    0.0007753670797683299,
                    0.05500997602939606,
                    0.10404044389724731,
                    -0.06355535984039307,
                    -0.0545790009200573,
                    0.021874381229281425,
                    -0.018816059455275536,
                    -0.07132934778928757,
                    0.035521283745765686,
                    0.02758985012769699,
                    -0.049305785447359085,
                    0.05021880194544792,
                    -0.020042994990944862,
                    -0.12180260568857193,
                    -0.001073856488801539,
                    -0.054060932248830795,
                    -0.06896597892045975,
                    -0.061303962022066116,
                    -0.042015258222818375,
                    0.022198984399437904,
                    0.0617765374481678,
                    -0.04786745831370354,
                    0.10968214273452759,
                    0.019986366853117943,
                    -0.04823972284793854,
                    0.007923906669020653,
                    0.011921497993171215,
                    -0.05860154703259468,
                    0.04622909426689148,
                    0.07930349558591843,
                    0.049831002950668335,
                    0.03543457016348839,
                    -0.012099611572921276,
                    0.049831997603178024,
                    0.13841651380062103,
                    -0.08135861158370972,
                    -0.1251026839017868,
                    -0.04913696274161339,
                    0.019542193040251732,
                    -0.043220553547143936,
                    0.003966370597481728,
                    -0.05703642964363098,
                    -0.11916356533765793,
                    -0.06033286824822426,
                    0.02546110935509205,
                    0.045644789934158325,
                    0.026665860787034035,
                    0.02550773322582245,
                    0.028533846139907837,
                    -0.027009600773453712,
                    -0.04274435713887215,
                    0.005716439336538315,
                    -0.013824187219142914,
                    0.04746444895863533,
                    -0.08990409970283508,
                    -0.0118534155189991,
                    -0.025525307282805443,
                    0.038029495626688004,
                    0.02175244875252247,
                    -0.00926608219742775,
                    -0.013800646178424358,
                    -0.03771359100937843,
                    0.01795515976846218,
                    -0.07085781544446945,
                    -0.04183951020240784,
                    -0.025978488847613335,
                    -0.032985370606184006,
                    -0.006355601828545332,
                    -0.014705844223499298,
                    -0.048718150705099106,
                    -0.010655884630978107,
                    -0.005377419758588076,
                    -0.021115677431225777,
                    -0.037108853459358215,
                    -0.011207436211407185,
                    -0.003920952323824167,
                    0.060581859201192856,
                    0.06624574214220047,
                    -0.05584610626101494,
                    -0.009825480170547962,
                    -0.06530154496431351,
                    0.018242426216602325,
                    0.025822797790169716,
                    0.013944316655397415,
                    -0.0026419542264193296,
                    -0.01741766557097435,
                    -0.0006833113729953766,
                    0.00207650288939476,
                    -0.00986212957650423,
                    0.019066190347075462,
                    0.03294091299176216,
                    0.03320768103003502,
                    0.06933194398880005,
                    -0.01681963913142681,
                    0.028147295117378235,
                    0.05039161443710327,
                    -0.005119409412145615,
                    -0.019800325855612755,
                    0.02621678076684475,
                    0.0955832228064537,
                    -0.012593197636306286,
                    0.00799719337373972,
                    -0.026652289554476738,
                    0.02332666516304016,
                    0.007586780935525894,
                    -0.04969889298081398,
                    0.007292224559932947,
                    0.04493218660354614,
                    -0.071925587952137,
                    0.06404583901166916,
                    0.007643524557352066,
                    -0.019998282194137573,
                    0.004839710425585508,
                    -0.01375108677893877,
                    -0.005789201240986586,
                    -0.12071340531110764,
                    -0.0056017544120550156,
                    0.011545530520379543,
                    -0.016153035685420036,
                    0.008874361403286457,
                    0.012604561634361744,
                    -0.04089635610580444,
                    0.0112747922539711,
                    0.008222685195505619,
                    0.11676768213510513,
                    -0.005907408427447081,
                    0.15191443264484406,
                    -0.06753453612327576,
                    0.08226355910301208,
                    -0.05556078627705574,
                    -0.011847350746393204,
                    0.014070180244743824,
                    -0.005360342562198639,
                    -0.031564414501190186,
                    -2.5465464204899035e-05,
                    0.020938748493790627,
                    -0.0211241003125906,
                    0.005510661751031876,
                    -0.021319419145584106,
                    -0.03522387146949768,
                    0.056144699454307556,
                    0.01673164777457714,
                    0.024464577436447144,
                    0.019823551177978516,
                    0.05905771255493164,
                    -0.03287734463810921,
                    -0.05448069050908089,
                    -0.020693399012088776,
                    0.0436970479786396,
                    -0.07051046937704086,
                    -0.04477139189839363,
                    -0.024142436683177948,
                    0.00026599690318107605,
                    0.004015777725726366,
                    -0.025418175384402275,
                    0.04534805193543434,
                    -0.02210688404738903,
                    -0.12249213457107544,
                    -5.64983747608494e-05,
                    0.000526408024597913,
                    0.02038419060409069,
                    0.015389823354780674,
                    -0.13577088713645935,
                    -0.06620781868696213,
                    -0.047416042536497116,
                    0.09164738655090332,
                    -0.013135015964508057,
                    0.03929263725876808,
                    -0.10165544599294662,
                    0.08423421531915665,
                    0.00970472116023302,
                    0.08082973957061768,
                    -0.024458052590489388,
                    0.009388819336891174,
                    0.04049227014183998,
                    0.09431234747171402,
                    0.04700171574950218,
                    0.01673915423452854,
                    -0.0573386549949646,
                    0.05462893843650818,
                    -0.014349479228258133,
                    -0.07738969475030899,
                    0.023828981444239616,
                    -0.0492265559732914,
                    -0.011693832464516163,
                    -0.03916969522833824,
                    -0.06377281993627548,
                    0.08123549073934555,
                    -0.022171149030327797,
                    -0.028967127203941345,
                    0.07097005844116211,
                    0.07056926190853119,
                    0.03632090985774994,
                    -0.050974491983652115,
                    -0.0026198390405625105,
                    -0.0005273902788758278,
                    0.010245171375572681,
                    -0.008036485873162746,
                    0.004616423510015011,
                    0.0882464051246643,
                    0.058970529586076736,
                    -0.0138884661719203,
                    -0.0493960976600647,
                    0.01698603667318821,
                    -0.023730890825390816,
                    -0.03045964054763317,
                    -0.031703073531389236,
                    0.11517880111932755,
                    -0.0881551206111908,
                    -0.06507965177297592,
                    0.0577038936316967,
                    -0.0401439405977726,
                    0.02538408152759075,
                    -0.02222537435591221,
                    0.000561046355869621,
                    0.10061037540435791,
                    0.026057781651616096,
                    0.04002590477466583,
                    -0.019881082698702812
                ],
                "report_type": "Heap-buffer-overflow READ 1",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 10800,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-58150"
            }
        },
        "relation1": {
            "identity": 22350,
            "start": 10800,
            "end": 10804,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 10804,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "fix out-of-bounds read (oss-fuzz Issue 58150)\n",
                "sha": "f2d7c57c71a0810b25fc2bead63c5ab35e5d0284",
                "repo": "libheif",
                "encoding": "UTF-8",
                "authored_date": 1681854555,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1681854555
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 10800,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-58150"
            }
        },
        "relation1": {
            "identity": 22345,
            "start": 10800,
            "end": 10801,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 10801,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "compute scaled region coordinates\n",
                "sha": "af0fd4faf8a62f40675c6fc8ac8db79fecb0a67b",
                "repo": "libheif",
                "encoding": "UTF-8",
                "authored_date": 1681755984,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1681760703
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]