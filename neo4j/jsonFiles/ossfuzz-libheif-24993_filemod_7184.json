[
    {
        "baseNode": {
            "identity": 7179,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-24993"
            }
        },
        "relation1": {
            "identity": 14473,
            "start": 7179,
            "end": 7184,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 7184,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.027310999110341072,
                    0.0385594516992569,
                    -0.09813035279512405,
                    0.08510950207710266,
                    -0.023370712995529175,
                    0.00048114839592017233,
                    0.011237408965826035,
                    0.04889971390366554,
                    0.02347930334508419,
                    -0.005013708025217056,
                    -0.024248303845524788,
                    -0.01070158090442419,
                    -0.02973846159875393,
                    -0.004241412039846182,
                    0.07692790031433105,
                    -0.023342132568359375,
                    0.142653226852417,
                    -0.016132092103362083,
                    -0.04436192288994789,
                    0.07931756228208542,
                    -0.046640485525131226,
                    0.047409337013959885,
                    -0.02305953949689865,
                    0.000924264604691416,
                    0.02176915481686592,
                    0.007501298561692238,
                    -0.12298208475112915,
                    0.10846089571714401,
                    -0.0023187773767858744,
                    -0.035788681358098984,
                    -0.11894027143716812,
                    -0.07760497182607651,
                    0.013558118604123592,
                    0.0006507034413516521,
                    -0.03534838929772377,
                    0.062459755688905716,
                    -0.052369389683008194,
                    -0.06228293851017952,
                    -0.02649819292128086,
                    0.10652659088373184,
                    -0.12825097143650055,
                    -0.03585430979728699,
                    -0.04128725081682205,
                    0.04119142144918442,
                    -0.06238701939582825,
                    -0.023265190422534943,
                    0.03491952642798424,
                    -0.03427071496844292,
                    0.032945480197668076,
                    0.02865298092365265,
                    -0.01872062310576439,
                    -0.04860386252403259,
                    -0.04832053929567337,
                    0.033440373837947845,
                    -0.10725577920675278,
                    0.007680392358452082,
                    -0.04614832252264023,
                    0.1174250990152359,
                    -0.07970915734767914,
                    0.021460596472024918,
                    -0.041266199201345444,
                    -0.14810822904109955,
                    -0.013941126875579357,
                    -0.039224687963724136,
                    0.0751645565032959,
                    -0.018777675926685333,
                    0.07716595381498337,
                    -0.06830226629972458,
                    0.04772324487566948,
                    -0.02914162166416645,
                    0.06363023072481155,
                    0.01797415316104889,
                    -0.10994023829698563,
                    -0.009647143073379993,
                    -0.08957760781049728,
                    -0.08376610279083252,
                    -0.05508323013782501,
                    -0.020209478214383125,
                    -0.05761440843343735,
                    -0.16749797761440277,
                    -0.07233201712369919,
                    0.08122433722019196,
                    -0.017937077209353447,
                    0.02558562159538269,
                    0.0890273004770279,
                    -0.051528118550777435,
                    0.0526205450296402,
                    -0.023045837879180908,
                    0.015726860612630844,
                    -0.029173482209444046,
                    0.015146157704293728,
                    -0.018604621291160583,
                    0.07924460619688034,
                    0.0007810778333805501,
                    0.010759076103568077,
                    0.06847316771745682,
                    -0.006483231205493212,
                    -0.037618763744831085,
                    -0.03843750059604645,
                    0.03808291628956795,
                    0.02861839346587658,
                    -0.038352325558662415,
                    -0.07802112400531769,
                    -0.10366103053092957,
                    -0.029491031542420387,
                    -0.03492250666022301,
                    -0.12588243186473846,
                    0.07170620560646057,
                    0.04237981140613556,
                    -0.042624976485967636,
                    0.022271325811743736,
                    0.02536124549806118,
                    -0.11314116418361664,
                    0.0721663311123848,
                    0.023837175220251083,
                    -0.1334325224161148,
                    -0.046446237713098526,
                    -0.0418822355568409,
                    0.008951278403401375,
                    0.11988911032676697,
                    0.09593161195516586,
                    0.007028806488960981,
                    -0.03102538175880909,
                    -0.03380806744098663,
                    -0.03383423015475273,
                    -0.08312492817640305,
                    -0.05428521707653999,
                    0.14922074973583221,
                    0.05461942031979561,
                    0.0915522649884224,
                    -0.034353841096162796,
                    -0.08119499683380127,
                    0.029237981885671616,
                    0.011529379524290562,
                    0.04323681816458702,
                    0.09592586010694504,
                    0.020740244537591934,
                    0.006291127298027277,
                    0.14006896317005157,
                    0.011515557765960693,
                    0.008893932215869427,
                    0.06651768833398819,
                    -0.04796305671334267,
                    0.013888862915337086,
                    0.009806271642446518,
                    0.029515529051423073,
                    0.11737964302301407,
                    -0.001793822506442666,
                    -0.009974988177418709,
                    0.02268514409661293,
                    0.06360705941915512,
                    -0.0916195958852768,
                    -0.07394225895404816,
                    -0.07780119776725769,
                    0.03908862546086311,
                    0.013793602585792542,
                    -0.028705773875117302,
                    0.04133103787899017,
                    0.02411595545709133,
                    -0.11060585826635361,
                    0.01495506800711155,
                    0.02728622406721115,
                    -0.014545097947120667,
                    0.11838690936565399,
                    0.0647684633731842,
                    0.0005343857919797301,
                    -0.04137112945318222,
                    0.05054172873497009,
                    -0.008809656836092472,
                    0.09354803711175919,
                    0.021658146753907204,
                    0.04768616333603859,
                    0.026873454451560974,
                    -0.0033863703720271587,
                    0.04013599455356598,
                    -0.08471394330263138,
                    0.03416392207145691,
                    0.0639236718416214,
                    0.046289604157209396,
                    -0.023495683446526527,
                    0.0996507853269577,
                    -0.003842704463750124,
                    -0.13828210532665253,
                    -0.07118753343820572,
                    0.01574627310037613,
                    0.07989922165870667,
                    0.011759941466152668,
                    -0.11668011546134949,
                    -0.05134252831339836,
                    0.10631776601076126,
                    -0.018686989322304726,
                    -0.05457420274615288,
                    0.03180304169654846,
                    -0.08455722033977509,
                    -0.07611759752035141,
                    0.0917942076921463,
                    -0.09578614681959152,
                    0.02718932181596756,
                    -0.04555952548980713,
                    -0.01006973534822464,
                    -0.06799271702766418,
                    -0.07869784533977509,
                    0.11533680558204651,
                    0.03852387145161629,
                    -0.0408826507627964,
                    -0.07111315429210663,
                    0.05639529600739479,
                    -0.07589753717184067,
                    0.12020310759544373,
                    -0.04242810606956482,
                    -0.002024484798312187,
                    -0.033477261662483215,
                    0.05268321558833122,
                    0.12755532562732697,
                    -0.029363105073571205,
                    -0.02729487419128418,
                    -0.023818323388695717,
                    -0.01268291100859642,
                    -0.06569737195968628,
                    -0.02918774075806141,
                    -0.05752837285399437,
                    0.023605044931173325,
                    0.02389899641275406,
                    0.06365480273962021,
                    0.08601465076208115,
                    -0.0063572474755346775,
                    0.00524240592494607,
                    -0.017807763069868088,
                    0.0952501893043518,
                    0.06706184893846512,
                    -0.014563430100679398,
                    0.11633619666099548,
                    -0.003977883607149124,
                    -0.03232618793845177,
                    0.04817089065909386,
                    -0.07176723331212997,
                    0.029683567583560944,
                    0.04967658594250679,
                    0.008748375810682774,
                    -0.07322078198194504,
                    0.043177999556064606,
                    0.03194864094257355,
                    0.020266208797693253,
                    -0.011586676351726055,
                    0.054683372378349304,
                    -0.033621665090322495,
                    -0.009558542631566525,
                    0.04453941807150841,
                    -0.1057291179895401,
                    0.013105577789247036,
                    0.07557670772075653,
                    0.11533252894878387,
                    0.09905322641134262,
                    0.1327323615550995,
                    -0.04989803582429886,
                    -0.026290474459528923
                ],
                "diffText": "diff --git a/libheif/heif_colorconversion.cc b/libheif/heif_colorconversion.cc\nindex 70cf848..52a9870 100644\n--- a/libheif/heif_colorconversion.cc\n+++ b/libheif/heif_colorconversion.cc\n@@ -692,8 +692,9 @@ Op_RGB_to_YCbCr<Pixel>::convert_colorspace(const std::shared_ptr<const HeifPixel\n \n \n   if (has_alpha) {\n+    int copyWidth = (hdr ? width*2 : width);\n     for (y = 0; y < height; y++) {\n-      memcpy(&out_a[y * out_a_stride], &in_a[y * in_a_stride], width * 2);\n+      memcpy(&out_a[y * out_a_stride], &in_a[y * in_a_stride], copyWidth);\n     }\n   }\n "
            }
        },
        "relation2": {
            "identity": 14473,
            "start": 7184,
            "end": 7179,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 7179,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-24993"
            }
        }
    },
    {
        "baseNode": {
            "identity": 7179,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-24993"
            }
        },
        "relation1": {
            "identity": 14473,
            "start": 7179,
            "end": 7184,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 7184,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.027310999110341072,
                    0.0385594516992569,
                    -0.09813035279512405,
                    0.08510950207710266,
                    -0.023370712995529175,
                    0.00048114839592017233,
                    0.011237408965826035,
                    0.04889971390366554,
                    0.02347930334508419,
                    -0.005013708025217056,
                    -0.024248303845524788,
                    -0.01070158090442419,
                    -0.02973846159875393,
                    -0.004241412039846182,
                    0.07692790031433105,
                    -0.023342132568359375,
                    0.142653226852417,
                    -0.016132092103362083,
                    -0.04436192288994789,
                    0.07931756228208542,
                    -0.046640485525131226,
                    0.047409337013959885,
                    -0.02305953949689865,
                    0.000924264604691416,
                    0.02176915481686592,
                    0.007501298561692238,
                    -0.12298208475112915,
                    0.10846089571714401,
                    -0.0023187773767858744,
                    -0.035788681358098984,
                    -0.11894027143716812,
                    -0.07760497182607651,
                    0.013558118604123592,
                    0.0006507034413516521,
                    -0.03534838929772377,
                    0.062459755688905716,
                    -0.052369389683008194,
                    -0.06228293851017952,
                    -0.02649819292128086,
                    0.10652659088373184,
                    -0.12825097143650055,
                    -0.03585430979728699,
                    -0.04128725081682205,
                    0.04119142144918442,
                    -0.06238701939582825,
                    -0.023265190422534943,
                    0.03491952642798424,
                    -0.03427071496844292,
                    0.032945480197668076,
                    0.02865298092365265,
                    -0.01872062310576439,
                    -0.04860386252403259,
                    -0.04832053929567337,
                    0.033440373837947845,
                    -0.10725577920675278,
                    0.007680392358452082,
                    -0.04614832252264023,
                    0.1174250990152359,
                    -0.07970915734767914,
                    0.021460596472024918,
                    -0.041266199201345444,
                    -0.14810822904109955,
                    -0.013941126875579357,
                    -0.039224687963724136,
                    0.0751645565032959,
                    -0.018777675926685333,
                    0.07716595381498337,
                    -0.06830226629972458,
                    0.04772324487566948,
                    -0.02914162166416645,
                    0.06363023072481155,
                    0.01797415316104889,
                    -0.10994023829698563,
                    -0.009647143073379993,
                    -0.08957760781049728,
                    -0.08376610279083252,
                    -0.05508323013782501,
                    -0.020209478214383125,
                    -0.05761440843343735,
                    -0.16749797761440277,
                    -0.07233201712369919,
                    0.08122433722019196,
                    -0.017937077209353447,
                    0.02558562159538269,
                    0.0890273004770279,
                    -0.051528118550777435,
                    0.0526205450296402,
                    -0.023045837879180908,
                    0.015726860612630844,
                    -0.029173482209444046,
                    0.015146157704293728,
                    -0.018604621291160583,
                    0.07924460619688034,
                    0.0007810778333805501,
                    0.010759076103568077,
                    0.06847316771745682,
                    -0.006483231205493212,
                    -0.037618763744831085,
                    -0.03843750059604645,
                    0.03808291628956795,
                    0.02861839346587658,
                    -0.038352325558662415,
                    -0.07802112400531769,
                    -0.10366103053092957,
                    -0.029491031542420387,
                    -0.03492250666022301,
                    -0.12588243186473846,
                    0.07170620560646057,
                    0.04237981140613556,
                    -0.042624976485967636,
                    0.022271325811743736,
                    0.02536124549806118,
                    -0.11314116418361664,
                    0.0721663311123848,
                    0.023837175220251083,
                    -0.1334325224161148,
                    -0.046446237713098526,
                    -0.0418822355568409,
                    0.008951278403401375,
                    0.11988911032676697,
                    0.09593161195516586,
                    0.007028806488960981,
                    -0.03102538175880909,
                    -0.03380806744098663,
                    -0.03383423015475273,
                    -0.08312492817640305,
                    -0.05428521707653999,
                    0.14922074973583221,
                    0.05461942031979561,
                    0.0915522649884224,
                    -0.034353841096162796,
                    -0.08119499683380127,
                    0.029237981885671616,
                    0.011529379524290562,
                    0.04323681816458702,
                    0.09592586010694504,
                    0.020740244537591934,
                    0.006291127298027277,
                    0.14006896317005157,
                    0.011515557765960693,
                    0.008893932215869427,
                    0.06651768833398819,
                    -0.04796305671334267,
                    0.013888862915337086,
                    0.009806271642446518,
                    0.029515529051423073,
                    0.11737964302301407,
                    -0.001793822506442666,
                    -0.009974988177418709,
                    0.02268514409661293,
                    0.06360705941915512,
                    -0.0916195958852768,
                    -0.07394225895404816,
                    -0.07780119776725769,
                    0.03908862546086311,
                    0.013793602585792542,
                    -0.028705773875117302,
                    0.04133103787899017,
                    0.02411595545709133,
                    -0.11060585826635361,
                    0.01495506800711155,
                    0.02728622406721115,
                    -0.014545097947120667,
                    0.11838690936565399,
                    0.0647684633731842,
                    0.0005343857919797301,
                    -0.04137112945318222,
                    0.05054172873497009,
                    -0.008809656836092472,
                    0.09354803711175919,
                    0.021658146753907204,
                    0.04768616333603859,
                    0.026873454451560974,
                    -0.0033863703720271587,
                    0.04013599455356598,
                    -0.08471394330263138,
                    0.03416392207145691,
                    0.0639236718416214,
                    0.046289604157209396,
                    -0.023495683446526527,
                    0.0996507853269577,
                    -0.003842704463750124,
                    -0.13828210532665253,
                    -0.07118753343820572,
                    0.01574627310037613,
                    0.07989922165870667,
                    0.011759941466152668,
                    -0.11668011546134949,
                    -0.05134252831339836,
                    0.10631776601076126,
                    -0.018686989322304726,
                    -0.05457420274615288,
                    0.03180304169654846,
                    -0.08455722033977509,
                    -0.07611759752035141,
                    0.0917942076921463,
                    -0.09578614681959152,
                    0.02718932181596756,
                    -0.04555952548980713,
                    -0.01006973534822464,
                    -0.06799271702766418,
                    -0.07869784533977509,
                    0.11533680558204651,
                    0.03852387145161629,
                    -0.0408826507627964,
                    -0.07111315429210663,
                    0.05639529600739479,
                    -0.07589753717184067,
                    0.12020310759544373,
                    -0.04242810606956482,
                    -0.002024484798312187,
                    -0.033477261662483215,
                    0.05268321558833122,
                    0.12755532562732697,
                    -0.029363105073571205,
                    -0.02729487419128418,
                    -0.023818323388695717,
                    -0.01268291100859642,
                    -0.06569737195968628,
                    -0.02918774075806141,
                    -0.05752837285399437,
                    0.023605044931173325,
                    0.02389899641275406,
                    0.06365480273962021,
                    0.08601465076208115,
                    -0.0063572474755346775,
                    0.00524240592494607,
                    -0.017807763069868088,
                    0.0952501893043518,
                    0.06706184893846512,
                    -0.014563430100679398,
                    0.11633619666099548,
                    -0.003977883607149124,
                    -0.03232618793845177,
                    0.04817089065909386,
                    -0.07176723331212997,
                    0.029683567583560944,
                    0.04967658594250679,
                    0.008748375810682774,
                    -0.07322078198194504,
                    0.043177999556064606,
                    0.03194864094257355,
                    0.020266208797693253,
                    -0.011586676351726055,
                    0.054683372378349304,
                    -0.033621665090322495,
                    -0.009558542631566525,
                    0.04453941807150841,
                    -0.1057291179895401,
                    0.013105577789247036,
                    0.07557670772075653,
                    0.11533252894878387,
                    0.09905322641134262,
                    0.1327323615550995,
                    -0.04989803582429886,
                    -0.026290474459528923
                ],
                "diffText": "diff --git a/libheif/heif_colorconversion.cc b/libheif/heif_colorconversion.cc\nindex 70cf848..52a9870 100644\n--- a/libheif/heif_colorconversion.cc\n+++ b/libheif/heif_colorconversion.cc\n@@ -692,8 +692,9 @@ Op_RGB_to_YCbCr<Pixel>::convert_colorspace(const std::shared_ptr<const HeifPixel\n \n \n   if (has_alpha) {\n+    int copyWidth = (hdr ? width*2 : width);\n     for (y = 0; y < height; y++) {\n-      memcpy(&out_a[y * out_a_stride], &in_a[y * in_a_stride], width * 2);\n+      memcpy(&out_a[y * out_a_stride], &in_a[y * in_a_stride], copyWidth);\n     }\n   }\n "
            }
        },
        "relation2": {
            "identity": 14472,
            "start": 7184,
            "end": 5017,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 5017,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "libheif/heif_colorconversion.cc"
            }
        }
    },
    {
        "baseNode": {
            "identity": 7179,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-24993"
            }
        },
        "relation1": {
            "identity": 14470,
            "start": 7179,
            "end": 5009,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 5009,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "libheif"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 7179,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-24993"
            }
        },
        "relation1": {
            "identity": 14469,
            "start": 7179,
            "end": 7183,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 7183,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "======================= INFO =========================\nThis binary is built for AFL-fuzz.\nTo run the target function on individual input(s) execute this:\n  /out/file-fuzzer < INPUT_FILE\nor\n  /out/file-fuzzer INPUT_FILE1 [INPUT_FILE2 ... ]\nTo fuzz with afl-fuzz execute this:\n  afl-fuzz [afl-flags] /out/file-fuzzer [-N]\nafl-fuzz will run N iterations before re-spawning the process (default: 1000)\n======================================================\nReading 817 bytes from /tmp/poc\n=================================================================\n==1==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62100001c90f at pc 0x000000497be7 bp 0x7ffd8deb5f90 sp 0x7ffd8deb5758\nREAD of size 128 at 0x62100001c90f thread T0\nSCARINESS: 26 (multi-byte-read-heap-buffer-overflow)\n    #0 0x497be6 in __asan_memcpy /src/llvm-project/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3\n    #1 0x60385e in Op_RGB_to_YCbCr<unsigned char>::convert_colorspace(std::__1::shared_ptr<heif::HeifPixelImage const> const&, heif::ColorState, heif::ColorConversionOptions) /src/libheif/libheif/heif_colorconversion.cc:541:7\n    #2 0x5f0169 in heif::ColorConversionPipeline::convert_image(std::__1::shared_ptr<heif::HeifPixelImage> const&) /src/libheif/libheif/heif_colorconversion.cc:2340:15\n    #3 0x56ef8b in heif::convert_colorspace(std::__1::shared_ptr<heif::HeifPixelImage> const&, heif_colorspace, heif_chroma, int) /src/libheif/libheif/heif_image.cc:418:19\n    #4 0x5a0a99 in heif::HeifContext::decode_image_user(unsigned int, std::__1::shared_ptr<heif::HeifPixelImage>&, heif_colorspace, heif_chroma, heif_decoding_options const*) const /src/libheif/libheif/heif_context.cc:903:11\n    #5 0x583283 in heif_decode_image /src/libheif/libheif/heif.cc:681:35\n    #6 0x615cd7 in TestDecodeImage(heif_context*, heif_image_handle const*, unsigned long) /src/libheif/libheif/file_fuzzer.cc:59:9\n    #7 0x61568d in LLVMFuzzerTestOneInput /src/libheif/libheif/file_fuzzer.cc:98:5\n    #8 0x61636e in ExecuteFilesOnyByOne /src/libfuzzer/afl/afl_driver.cpp:217:5\n    #9 0x61636e in main /src/libfuzzer/afl/afl_driver.cpp:254:12\n    #10 0x7fab7b2c683f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n    #11 0x420478 in _start (/out/file-fuzzer+0x420478)\n\nDEDUP_TOKEN: __asan_memcpy--Op_RGB_to_YCbCr<unsigned char>::convert_colorspace(std::__1::shared_ptr<heif::HeifPixelImage const> const&, heif::ColorState, heif::ColorConversionOptions)--heif::ColorConversionPipeline::convert_image(std::__1::shared_ptr<heif::HeifPixelImage> const&)\n0x62100001c90f is located 0 bytes to the right of 4111-byte region [0x62100001b900,0x62100001c90f)\nallocated by thread T0 here:\n    #0 0x4c828d in operator new[](unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:102:3\n    #1 0x56c16b in heif::HeifPixelImage::add_plane(heif_channel, int, int, int) /src/libheif/libheif/heif_image.cc:168:27\n    #2 0x5f8fbb in Op_YCbCr_to_RGB<unsigned char>::convert_colorspace(std::__1::shared_ptr<heif::HeifPixelImage const> const&, heif::ColorState, heif::ColorConversionOptions) /src/libheif/libheif/heif_colorconversion.cc:311:11\n    #3 0x5f0169 in heif::ColorConversionPipeline::convert_image(std::__1::shared_ptr<heif::HeifPixelImage> const&) /src/libheif/libheif/heif_colorconversion.cc:2340:15\n    #4 0x56ef8b in heif::convert_colorspace(std::__1::shared_ptr<heif::HeifPixelImage> const&, heif_colorspace, heif_chroma, int) /src/libheif/libheif/heif_image.cc:418:19\n    #5 0x5a26de in heif::HeifContext::decode_image_planar(unsigned int, std::__1::shared_ptr<heif::HeifPixelImage>&, heif_colorspace, heif_decoding_options const*) const /src/libheif/libheif/heif_context.cc:999:13\n    #6 0x5a12a8 in heif::HeifContext::decode_image_planar(unsigned int, std::__1::shared_ptr<heif::HeifPixelImage>&, heif_colorspace, heif_decoding_options const*) const /src/libheif/libheif/heif_context.cc:1055:19\n    #7 0x5a095c in heif::HeifContext::decode_image_user(unsigned int, std::__1::shared_ptr<heif::HeifPixelImage>&, heif_colorspace, heif_chroma, heif_decoding_options const*) const /src/libheif/libheif/heif_context.cc:883:15\n    #8 0x583283 in heif_decode_image /src/libheif/libheif/heif.cc:681:35\n    #9 0x615cd7 in TestDecodeImage(heif_context*, heif_image_handle const*, unsigned long) /src/libheif/libheif/file_fuzzer.cc:59:9\n    #10 0x61568d in LLVMFuzzerTestOneInput /src/libheif/libheif/file_fuzzer.cc:98:5\n    #11 0x61636e in ExecuteFilesOnyByOne /src/libfuzzer/afl/afl_driver.cpp:217:5\n    #12 0x61636e in main /src/libfuzzer/afl/afl_driver.cpp:254:12\n    #13 0x7fab7b2c683f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n\nDEDUP_TOKEN: operator new[](unsigned long)--heif::HeifPixelImage::add_plane(heif_channel, int, int, int)--Op_YCbCr_to_RGB<unsigned char>::convert_colorspace(std::__1::shared_ptr<heif::HeifPixelImage const> const&, heif::ColorState, heif::ColorConversionOptions)\nSUMMARY: AddressSanitizer: heap-buffer-overflow /src/llvm-project/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cpp:22:3 in __asan_memcpy\nShadow bytes around the buggy address:\n  0x0c427fffb8d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c427fffb8e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c427fffb8f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c427fffb900: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c427fffb910: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=>0x0c427fffb920: 00[07]fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffb930: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffb940: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffb950: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffb960: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c427fffb970: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n  Shadow gap:              cc\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.05121723189949989,
                    0.08731529861688614,
                    -0.08441612124443054,
                    0.0009749879245646298,
                    -0.03350772708654404,
                    0.021215179935097694,
                    -0.025260895490646362,
                    0.020939849317073822,
                    0.034868814051151276,
                    -0.041515473276376724,
                    -0.053417641669511795,
                    -0.005853760521858931,
                    -0.05446770414710045,
                    0.014757751487195492,
                    0.044161658734083176,
                    0.007780879735946655,
                    0.10222933441400528,
                    0.04418056085705757,
                    0.01113834511488676,
                    0.04571392759680748,
                    -0.03269219398498535,
                    0.010830387473106384,
                    -0.01977464184165001,
                    -0.039727602154016495,
                    0.020792633295059204,
                    0.01506782602518797,
                    -0.12193047255277634,
                    0.010987465269863605,
                    -0.040019240230321884,
                    -0.015142135322093964,
                    -0.1061127781867981,
                    -0.1537276953458786,
                    -0.012378666549921036,
                    -0.00039481883868575096,
                    0.009013393893837929,
                    0.012184406630694866,
                    -0.011104072444140911,
                    -0.018756648525595665,
                    0.014429338276386261,
                    0.12273160368204117,
                    -0.1040647104382515,
                    -0.029857760295271873,
                    -0.012630246579647064,
                    -0.007572713773697615,
                    -0.07666675746440887,
                    0.029254749417304993,
                    0.019542284309864044,
                    -0.031659651547670364,
                    0.05897821485996246,
                    0.00037019109004177153,
                    -0.08701809495687485,
                    -0.030504396185278893,
                    -0.01568365842103958,
                    -0.039365753531455994,
                    -0.0371854268014431,
                    -0.05570787191390991,
                    -0.01102060079574585,
                    0.08538340777158737,
                    -0.047015536576509476,
                    0.041058365255594254,
                    0.0033912435173988342,
                    -0.0943698063492775,
                    0.006359985563904047,
                    -0.021847784519195557,
                    0.00956394337117672,
                    0.05066375806927681,
                    0.09995380789041519,
                    0.005549570079892874,
                    0.039062660187482834,
                    -0.028225766494870186,
                    0.04152897372841835,
                    0.12639020383358002,
                    -0.07615353912115097,
                    -0.11896931380033493,
                    -0.04302811622619629,
                    0.019273830577731133,
                    -0.03875209391117096,
                    0.00800419319421053,
                    -0.05222540721297264,
                    -0.1413094699382782,
                    -0.08935248851776123,
                    0.03605152294039726,
                    0.00028937807655893266,
                    0.0072733559645712376,
                    0.052777085453271866,
                    0.020075025036931038,
                    -0.02446831203997135,
                    -0.046977218240499496,
                    0.020175814628601074,
                    -0.0010987730929628015,
                    0.03642610087990761,
                    -0.08619240671396255,
                    -0.005713118240237236,
                    -0.02001912333071232,
                    -0.022105230018496513,
                    0.031017711386084557,
                    0.019904514774680138,
                    -0.05092550441622734,
                    -0.03755287453532219,
                    0.023913949728012085,
                    -0.009988067671656609,
                    -0.026719840243458748,
                    -0.04558819532394409,
                    -0.06962724775075912,
                    -0.023350456729531288,
                    -0.011475729756057262,
                    -0.04888831079006195,
                    -0.005597798153758049,
                    0.010322054848074913,
                    -0.0347142368555069,
                    -0.0015601454069837928,
                    -0.008605723269283772,
                    -0.036568645387887955,
                    0.03945695981383324,
                    0.045801639556884766,
                    -0.07554387301206589,
                    -0.01382265705615282,
                    -0.05535942316055298,
                    0.0010711625218391418,
                    0.044140662997961044,
                    0.0481690876185894,
                    -0.0003127573581878096,
                    0.015637638047337532,
                    -0.013988521881401539,
                    -0.034818679094314575,
                    -0.01061601284891367,
                    0.03646029159426689,
                    0.03858622536063194,
                    0.06217488273978233,
                    0.11883550137281418,
                    -0.038600675761699677,
                    0.027224773541092873,
                    0.019497571513056755,
                    -0.013719298876821995,
                    -0.0006812407518737018,
                    0.028166398406028748,
                    0.06020693853497505,
                    -0.004514079075306654,
                    0.05780143663287163,
                    -0.0071044727228581905,
                    0.0396539606153965,
                    0.03985326364636421,
                    -0.0562451034784317,
                    -0.008574706502258778,
                    0.06080213561654091,
                    -0.004618484061211348,
                    0.019350266084074974,
                    0.010032127611339092,
                    0.011189509183168411,
                    0.017551755532622337,
                    0.01903030090034008,
                    -0.028253057971596718,
                    -0.03771404176950455,
                    -0.051230162382125854,
                    0.05862884595990181,
                    -0.008651635609567165,
                    -0.017405889928340912,
                    0.015329086221754551,
                    -0.043032970279455185,
                    -0.015578175894916058,
                    0.02623041905462742,
                    0.06748984009027481,
                    -0.02535995841026306,
                    0.13301889598369598,
                    -0.00770570570603013,
                    0.05811097100377083,
                    -0.07571735978126526,
                    0.0030242784414440393,
                    0.009989728219807148,
                    0.0399727039039135,
                    -0.028521448373794556,
                    0.031191177666187286,
                    0.024845359846949577,
                    -0.005260331556200981,
                    0.009984445758163929,
                    -0.04683585837483406,
                    -0.03485686704516411,
                    0.0418059416115284,
                    0.04957209900021553,
                    -0.0018733994802460074,
                    0.028175897896289825,
                    0.0668603703379631,
                    -0.076384536921978,
                    -0.07900743931531906,
                    -0.020665349438786507,
                    0.047914743423461914,
                    -0.0571708120405674,
                    -0.06373900920152664,
                    -0.029221028089523315,
                    0.03990205004811287,
                    0.015214708633720875,
                    -0.06040163338184357,
                    0.06544501334428787,
                    -0.021931437775492668,
                    -0.12988384068012238,
                    0.023945486173033714,
                    -0.043226733803749084,
                    0.011264230124652386,
                    -0.0162813663482666,
                    -0.07397487759590149,
                    -0.04476568475365639,
                    -0.07622745633125305,
                    0.08560489863157272,
                    0.021019242703914642,
                    0.03692081943154335,
                    -0.06615018099546432,
                    0.07398385554552078,
                    -0.006723098456859589,
                    0.10363537818193436,
                    -0.04495061933994293,
                    -0.014000602066516876,
                    0.019369367510080338,
                    0.10449781268835068,
                    0.053569819778203964,
                    -0.01996113546192646,
                    -0.02949848771095276,
                    0.020196111872792244,
                    -0.017357559874653816,
                    -0.08869993686676025,
                    0.02814692258834839,
                    -0.029069915413856506,
                    0.015041758306324482,
                    -0.011982428841292858,
                    -0.011293689720332623,
                    0.052152231335639954,
                    0.017287932336330414,
                    -0.029858624562621117,
                    0.029082804918289185,
                    0.09945259243249893,
                    0.06033320724964142,
                    -0.06856467574834824,
                    0.056179702281951904,
                    0.004335617646574974,
                    0.010275636799633503,
                    -0.0034029099624603987,
                    -0.016781462356448174,
                    0.06224976107478142,
                    0.05263980105519295,
                    -0.014058445580303669,
                    -0.04362398758530617,
                    0.015232902951538563,
                    0.015156477689743042,
                    -0.021684015169739723,
                    -0.04089706763625145,
                    0.0871477797627449,
                    -0.04795531928539276,
                    -0.05541506037116051,
                    0.07333176583051682,
                    -0.02597583271563053,
                    0.05337822809815407,
                    -0.015161792747676373,
                    0.02971687912940979,
                    0.14193670451641083,
                    0.046705011278390884,
                    0.010279758833348751,
                    -0.04051382094621658
                ],
                "report_type": "Heap-buffer-overflow READ {*}",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 7179,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-24993"
            }
        },
        "relation1": {
            "identity": 14468,
            "start": 7179,
            "end": 7182,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 7182,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "fix crash on copying non-HDR alpha plane\n",
                "sha": "5f80153e95109741dd1779b12ff13554dee6affc",
                "repo": "libheif",
                "encoding": "UTF-8",
                "authored_date": 1597142348,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1597142348
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 7179,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-24993"
            }
        },
        "relation1": {
            "identity": 14463,
            "start": 7179,
            "end": 7180,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 7180,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "add API function to free nclx profile (#276)\n",
                "sha": "ab9c1a5b1dadd9e2ffca621fb5b9cd3c87a5e4ca",
                "repo": "libheif",
                "encoding": "UTF-8",
                "authored_date": 1597140917,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1597140917
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]