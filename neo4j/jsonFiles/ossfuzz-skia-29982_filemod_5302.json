[
    {
        "baseNode": {
            "identity": 5296,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-skia-29982"
            }
        },
        "relation1": {
            "identity": 10473,
            "start": 5296,
            "end": 5302,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 5302,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.04010647162795067,
                    -0.03700326755642891,
                    -0.16553330421447754,
                    0.051033031195402145,
                    -0.02705339342355728,
                    -0.03974662721157074,
                    -0.014275194145739079,
                    -0.005388703662902117,
                    0.026355689391493797,
                    0.02199019119143486,
                    -0.017540642991662025,
                    0.033052247017621994,
                    -0.04023648053407669,
                    -0.03962472081184387,
                    0.019465960562229156,
                    -0.0798361524939537,
                    0.12590020895004272,
                    -0.015199060551822186,
                    0.026798970997333527,
                    0.08662592619657516,
                    -0.07687602937221527,
                    0.06506083905696869,
                    -0.06217792630195618,
                    -0.046168867498636246,
                    -0.056736089289188385,
                    -0.05815517157316208,
                    -0.054100822657346725,
                    0.020460600033402443,
                    0.01297080423682928,
                    -0.06481839716434479,
                    -0.16878356039524078,
                    -0.12887509167194366,
                    -0.0847468450665474,
                    -0.02254483662545681,
                    -0.07927832007408142,
                    -0.014186381362378597,
                    0.03616992011666298,
                    -0.039902348071336746,
                    -0.06941362470388412,
                    0.09392964839935303,
                    -0.05075356364250183,
                    -0.10515382885932922,
                    0.027133552357554436,
                    0.029162095859646797,
                    -0.030860314145684242,
                    0.017506016418337822,
                    -0.029497811570763588,
                    -0.007688742596656084,
                    0.08961773663759232,
                    0.057769183069467545,
                    -0.031142551451921463,
                    -0.0078816469758749,
                    -0.08992363512516022,
                    -0.08646202087402344,
                    -0.01423079427331686,
                    0.022280769422650337,
                    -0.005787822417914867,
                    0.04503406211733818,
                    -0.11086693406105042,
                    0.11050516366958618,
                    -0.0287394430488348,
                    -0.057928938418626785,
                    -0.005746158305555582,
                    -0.011563889682292938,
                    -0.024135349318385124,
                    -0.04859958589076996,
                    -0.004109401721507311,
                    -0.02789798006415367,
                    0.025207839906215668,
                    0.05912403017282486,
                    -0.001196632394567132,
                    0.11079812049865723,
                    -0.11451350152492523,
                    0.04776092246174812,
                    0.006687577348202467,
                    -0.00602592620998621,
                    0.01389994751662016,
                    -0.09101548790931702,
                    -0.01848476566374302,
                    0.013996024616062641,
                    0.07264631241559982,
                    -0.0015744843985885382,
                    0.05626560375094414,
                    -0.01658758334815502,
                    0.0029645480681210756,
                    -0.07075760513544083,
                    0.029615899547934532,
                    0.038406822830438614,
                    0.005855537485331297,
                    0.06594699621200562,
                    0.05227607488632202,
                    -0.03919370844960213,
                    0.16051842272281647,
                    -0.07891195267438889,
                    0.016713334247469902,
                    0.02323373593389988,
                    0.012964950874447823,
                    0.00588591955602169,
                    -0.03162367269396782,
                    -0.0055087655782699585,
                    -0.06696408241987228,
                    -0.01393689215183258,
                    -0.01907457411289215,
                    -0.03887480869889259,
                    0.04565970227122307,
                    0.027861932292580605,
                    -0.11074113845825195,
                    0.1031418964266777,
                    -0.062399499118328094,
                    -0.034042540937662125,
                    0.020618390291929245,
                    0.04847422614693642,
                    -0.0494491346180439,
                    0.03176530823111534,
                    -0.0519547313451767,
                    -0.08869711309671402,
                    0.009186582639813423,
                    0.03591016307473183,
                    0.07009129971265793,
                    0.10608068853616714,
                    0.06746707111597061,
                    -0.03590722382068634,
                    0.04823559150099754,
                    -0.027588963508605957,
                    -0.0032259062863886356,
                    -0.010261662304401398,
                    -0.006845980882644653,
                    0.03728237375617027,
                    0.019214307889342308,
                    -0.05684145167469978,
                    -0.009820478968322277,
                    -0.043961621820926666,
                    -0.012178728356957436,
                    -0.1224033534526825,
                    0.10149170458316803,
                    -0.011871241964399815,
                    0.18834349513053894,
                    0.01395804900676012,
                    0.07857055962085724,
                    -0.005219601560384035,
                    0.03289223089814186,
                    0.09109693020582199,
                    0.023872463032603264,
                    0.01472371444106102,
                    0.020655155181884766,
                    0.024649985134601593,
                    0.149772047996521,
                    0.060288093984127045,
                    -0.10709922760725021,
                    0.009150264784693718,
                    0.03971368074417114,
                    -0.0823277160525322,
                    -0.1230359673500061,
                    -0.02850652113556862,
                    0.011293948628008366,
                    -0.005200745537877083,
                    -0.05132884904742241,
                    0.020593814551830292,
                    -0.0642286017537117,
                    -0.1250641942024231,
                    -0.021304231137037277,
                    0.0746622085571289,
                    0.07178448885679245,
                    0.0787946805357933,
                    -0.024335460737347603,
                    0.08259616792201996,
                    -0.03609682247042656,
                    0.10143277049064636,
                    -0.016989650204777718,
                    0.04295254498720169,
                    -0.018698647618293762,
                    0.06804638355970383,
                    0.03904363140463829,
                    -0.041924137622117996,
                    0.0483894869685173,
                    -0.04622221738100052,
                    -0.060907360166311264,
                    0.010964562185108662,
                    -0.004031687509268522,
                    0.04132825881242752,
                    -0.006476261653006077,
                    0.05850451439619064,
                    -0.0665479525923729,
                    0.004367987159639597,
                    0.02293992042541504,
                    -0.013524221256375313,
                    0.03315717726945877,
                    -0.07098989188671112,
                    -0.030769936740398407,
                    -0.03975315019488335,
                    0.02410152368247509,
                    -0.0017864368855953217,
                    0.030496833845973015,
                    0.10259207338094711,
                    -0.13393427431583405,
                    0.14320029318332672,
                    0.02810177206993103,
                    0.12257076054811478,
                    -0.04379060119390488,
                    -0.06311547011137009,
                    -0.06587159633636475,
                    -0.02712625451385975,
                    0.0446668416261673,
                    -0.07886376231908798,
                    -0.004462749231606722,
                    -0.029397988691926003,
                    0.08739233762025833,
                    -0.1337813436985016,
                    -0.04548994451761246,
                    0.048385486006736755,
                    0.06323069334030151,
                    0.05707062780857086,
                    0.0483987033367157,
                    0.0539834126830101,
                    0.013472065329551697,
                    -0.11154722422361374,
                    0.08780372142791748,
                    0.03097361885011196,
                    0.013356709852814674,
                    0.052848320454359055,
                    -0.04581289365887642,
                    -0.03999446704983711,
                    0.006576654501259327,
                    0.00995918270200491,
                    0.10770922899246216,
                    -0.10361168533563614,
                    -0.016764149069786072,
                    0.031125515699386597,
                    0.04797791317105293,
                    0.02471460960805416,
                    -0.00409807451069355,
                    0.11098404973745346,
                    0.023375404998660088,
                    0.020240264013409615,
                    -0.007211803924292326,
                    -0.11192728579044342,
                    0.02517380751669407,
                    0.10407844930887222,
                    -0.10214004665613174,
                    -0.05334377661347389,
                    0.04166358709335327,
                    0.06392402946949005,
                    -0.012014716863632202,
                    -0.02900206297636032,
                    0.05033294856548309,
                    -0.11298724263906479,
                    -0.0861257016658783,
                    0.050634898245334625,
                    -0.12051697075366974,
                    -0.0850742757320404,
                    0.07414626330137253,
                    0.025991329923272133,
                    0.12201244384050369,
                    0.07000546157360077,
                    -0.003298930125311017,
                    0.04029889404773712
                ],
                "diffText": "diff --git a/src/sksl/SkSLCompiler.cpp b/src/sksl/SkSLCompiler.cpp\nindex fe119cee6d..6c15890fe8 100644\n--- a/src/sksl/SkSLCompiler.cpp\n+++ b/src/sksl/SkSLCompiler.cpp\n@@ -945,15 +945,14 @@ void Compiler::simplifyExpression(DefinitionMap& definitions,\n                         }\n                         currBit <<= 1;\n                     }\n-                    auto optimized = std::unique_ptr<Expression>(\n-                            new Constructor(c.fOffset, &c.type(), std::move(flattened)));\n-                    // No fUsage change; no references have been added or removed anywhere.\n+                    std::unique_ptr<Expression> replacement(new Constructor(c.fOffset, &c.type(),\n+                                                                            std::move(flattened)));\n+                    // We're replacing an expression with a cloned version; we'll need a rescan.\n+                    // No fUsage change: `float2(float(x), y)` and `float2(x, y)` have equivalent\n+                    // reference counts.\n+                    try_replace_expression(&b, iter, &replacement);\n                     optimizationContext->fUpdated = true;\n-                    if (!try_replace_expression(&b, iter, &optimized)) {\n-                        optimizationContext->fNeedsRescan = true;\n-                        return;\n-                    }\n-                    SkASSERT((*iter)->isExpression());\n+                    optimizationContext->fNeedsRescan = true;\n                     break;\n                 }\n             }"
            }
        },
        "relation2": {
            "identity": 10473,
            "start": 5302,
            "end": 5296,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 5296,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-skia-29982"
            }
        }
    },
    {
        "baseNode": {
            "identity": 5296,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-skia-29982"
            }
        },
        "relation1": {
            "identity": 10473,
            "start": 5296,
            "end": 5302,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 5302,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.04010647162795067,
                    -0.03700326755642891,
                    -0.16553330421447754,
                    0.051033031195402145,
                    -0.02705339342355728,
                    -0.03974662721157074,
                    -0.014275194145739079,
                    -0.005388703662902117,
                    0.026355689391493797,
                    0.02199019119143486,
                    -0.017540642991662025,
                    0.033052247017621994,
                    -0.04023648053407669,
                    -0.03962472081184387,
                    0.019465960562229156,
                    -0.0798361524939537,
                    0.12590020895004272,
                    -0.015199060551822186,
                    0.026798970997333527,
                    0.08662592619657516,
                    -0.07687602937221527,
                    0.06506083905696869,
                    -0.06217792630195618,
                    -0.046168867498636246,
                    -0.056736089289188385,
                    -0.05815517157316208,
                    -0.054100822657346725,
                    0.020460600033402443,
                    0.01297080423682928,
                    -0.06481839716434479,
                    -0.16878356039524078,
                    -0.12887509167194366,
                    -0.0847468450665474,
                    -0.02254483662545681,
                    -0.07927832007408142,
                    -0.014186381362378597,
                    0.03616992011666298,
                    -0.039902348071336746,
                    -0.06941362470388412,
                    0.09392964839935303,
                    -0.05075356364250183,
                    -0.10515382885932922,
                    0.027133552357554436,
                    0.029162095859646797,
                    -0.030860314145684242,
                    0.017506016418337822,
                    -0.029497811570763588,
                    -0.007688742596656084,
                    0.08961773663759232,
                    0.057769183069467545,
                    -0.031142551451921463,
                    -0.0078816469758749,
                    -0.08992363512516022,
                    -0.08646202087402344,
                    -0.01423079427331686,
                    0.022280769422650337,
                    -0.005787822417914867,
                    0.04503406211733818,
                    -0.11086693406105042,
                    0.11050516366958618,
                    -0.0287394430488348,
                    -0.057928938418626785,
                    -0.005746158305555582,
                    -0.011563889682292938,
                    -0.024135349318385124,
                    -0.04859958589076996,
                    -0.004109401721507311,
                    -0.02789798006415367,
                    0.025207839906215668,
                    0.05912403017282486,
                    -0.001196632394567132,
                    0.11079812049865723,
                    -0.11451350152492523,
                    0.04776092246174812,
                    0.006687577348202467,
                    -0.00602592620998621,
                    0.01389994751662016,
                    -0.09101548790931702,
                    -0.01848476566374302,
                    0.013996024616062641,
                    0.07264631241559982,
                    -0.0015744843985885382,
                    0.05626560375094414,
                    -0.01658758334815502,
                    0.0029645480681210756,
                    -0.07075760513544083,
                    0.029615899547934532,
                    0.038406822830438614,
                    0.005855537485331297,
                    0.06594699621200562,
                    0.05227607488632202,
                    -0.03919370844960213,
                    0.16051842272281647,
                    -0.07891195267438889,
                    0.016713334247469902,
                    0.02323373593389988,
                    0.012964950874447823,
                    0.00588591955602169,
                    -0.03162367269396782,
                    -0.0055087655782699585,
                    -0.06696408241987228,
                    -0.01393689215183258,
                    -0.01907457411289215,
                    -0.03887480869889259,
                    0.04565970227122307,
                    0.027861932292580605,
                    -0.11074113845825195,
                    0.1031418964266777,
                    -0.062399499118328094,
                    -0.034042540937662125,
                    0.020618390291929245,
                    0.04847422614693642,
                    -0.0494491346180439,
                    0.03176530823111534,
                    -0.0519547313451767,
                    -0.08869711309671402,
                    0.009186582639813423,
                    0.03591016307473183,
                    0.07009129971265793,
                    0.10608068853616714,
                    0.06746707111597061,
                    -0.03590722382068634,
                    0.04823559150099754,
                    -0.027588963508605957,
                    -0.0032259062863886356,
                    -0.010261662304401398,
                    -0.006845980882644653,
                    0.03728237375617027,
                    0.019214307889342308,
                    -0.05684145167469978,
                    -0.009820478968322277,
                    -0.043961621820926666,
                    -0.012178728356957436,
                    -0.1224033534526825,
                    0.10149170458316803,
                    -0.011871241964399815,
                    0.18834349513053894,
                    0.01395804900676012,
                    0.07857055962085724,
                    -0.005219601560384035,
                    0.03289223089814186,
                    0.09109693020582199,
                    0.023872463032603264,
                    0.01472371444106102,
                    0.020655155181884766,
                    0.024649985134601593,
                    0.149772047996521,
                    0.060288093984127045,
                    -0.10709922760725021,
                    0.009150264784693718,
                    0.03971368074417114,
                    -0.0823277160525322,
                    -0.1230359673500061,
                    -0.02850652113556862,
                    0.011293948628008366,
                    -0.005200745537877083,
                    -0.05132884904742241,
                    0.020593814551830292,
                    -0.0642286017537117,
                    -0.1250641942024231,
                    -0.021304231137037277,
                    0.0746622085571289,
                    0.07178448885679245,
                    0.0787946805357933,
                    -0.024335460737347603,
                    0.08259616792201996,
                    -0.03609682247042656,
                    0.10143277049064636,
                    -0.016989650204777718,
                    0.04295254498720169,
                    -0.018698647618293762,
                    0.06804638355970383,
                    0.03904363140463829,
                    -0.041924137622117996,
                    0.0483894869685173,
                    -0.04622221738100052,
                    -0.060907360166311264,
                    0.010964562185108662,
                    -0.004031687509268522,
                    0.04132825881242752,
                    -0.006476261653006077,
                    0.05850451439619064,
                    -0.0665479525923729,
                    0.004367987159639597,
                    0.02293992042541504,
                    -0.013524221256375313,
                    0.03315717726945877,
                    -0.07098989188671112,
                    -0.030769936740398407,
                    -0.03975315019488335,
                    0.02410152368247509,
                    -0.0017864368855953217,
                    0.030496833845973015,
                    0.10259207338094711,
                    -0.13393427431583405,
                    0.14320029318332672,
                    0.02810177206993103,
                    0.12257076054811478,
                    -0.04379060119390488,
                    -0.06311547011137009,
                    -0.06587159633636475,
                    -0.02712625451385975,
                    0.0446668416261673,
                    -0.07886376231908798,
                    -0.004462749231606722,
                    -0.029397988691926003,
                    0.08739233762025833,
                    -0.1337813436985016,
                    -0.04548994451761246,
                    0.048385486006736755,
                    0.06323069334030151,
                    0.05707062780857086,
                    0.0483987033367157,
                    0.0539834126830101,
                    0.013472065329551697,
                    -0.11154722422361374,
                    0.08780372142791748,
                    0.03097361885011196,
                    0.013356709852814674,
                    0.052848320454359055,
                    -0.04581289365887642,
                    -0.03999446704983711,
                    0.006576654501259327,
                    0.00995918270200491,
                    0.10770922899246216,
                    -0.10361168533563614,
                    -0.016764149069786072,
                    0.031125515699386597,
                    0.04797791317105293,
                    0.02471460960805416,
                    -0.00409807451069355,
                    0.11098404973745346,
                    0.023375404998660088,
                    0.020240264013409615,
                    -0.007211803924292326,
                    -0.11192728579044342,
                    0.02517380751669407,
                    0.10407844930887222,
                    -0.10214004665613174,
                    -0.05334377661347389,
                    0.04166358709335327,
                    0.06392402946949005,
                    -0.012014716863632202,
                    -0.02900206297636032,
                    0.05033294856548309,
                    -0.11298724263906479,
                    -0.0861257016658783,
                    0.050634898245334625,
                    -0.12051697075366974,
                    -0.0850742757320404,
                    0.07414626330137253,
                    0.025991329923272133,
                    0.12201244384050369,
                    0.07000546157360077,
                    -0.003298930125311017,
                    0.04029889404773712
                ],
                "diffText": "diff --git a/src/sksl/SkSLCompiler.cpp b/src/sksl/SkSLCompiler.cpp\nindex fe119cee6d..6c15890fe8 100644\n--- a/src/sksl/SkSLCompiler.cpp\n+++ b/src/sksl/SkSLCompiler.cpp\n@@ -945,15 +945,14 @@ void Compiler::simplifyExpression(DefinitionMap& definitions,\n                         }\n                         currBit <<= 1;\n                     }\n-                    auto optimized = std::unique_ptr<Expression>(\n-                            new Constructor(c.fOffset, &c.type(), std::move(flattened)));\n-                    // No fUsage change; no references have been added or removed anywhere.\n+                    std::unique_ptr<Expression> replacement(new Constructor(c.fOffset, &c.type(),\n+                                                                            std::move(flattened)));\n+                    // We're replacing an expression with a cloned version; we'll need a rescan.\n+                    // No fUsage change: `float2(float(x), y)` and `float2(x, y)` have equivalent\n+                    // reference counts.\n+                    try_replace_expression(&b, iter, &replacement);\n                     optimizationContext->fUpdated = true;\n-                    if (!try_replace_expression(&b, iter, &optimized)) {\n-                        optimizationContext->fNeedsRescan = true;\n-                        return;\n-                    }\n-                    SkASSERT((*iter)->isExpression());\n+                    optimizationContext->fNeedsRescan = true;\n                     break;\n                 }\n             }"
            }
        },
        "relation2": {
            "identity": 10472,
            "start": 5302,
            "end": 1579,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 1579,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "src/sksl/SkSLCompiler.cpp"
            }
        }
    },
    {
        "baseNode": {
            "identity": 5296,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-skia-29982"
            }
        },
        "relation1": {
            "identity": 10470,
            "start": 5296,
            "end": 195,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 195,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "skia"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 5296,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-skia-29982"
            }
        },
        "relation1": {
            "identity": 10469,
            "start": 5296,
            "end": 5301,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 5301,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "Accepting input from '/tmp/poc'\nUsage for fuzzing: honggfuzz -P [flags] -- /out/sksl2pipeline\n=================================================================\n==1==ERROR: AddressSanitizer: use-after-poison on address 0x6310000009f8 at pc 0x0000006e4eef bp 0x7ffddd401a50 sp 0x7ffddd401a48\nREAD of size 8 at 0x6310000009f8 thread T0\nSCARINESS: 33 (8-byte-read-use-after-poison)\n    #0 0x6e4eee in std::__1::unique_ptr<SkSL::Expression, std::__1::default_delete<SkSL::Expression> >::operator->() const /usr/local/bin/../include/c++/v1/memory:2352:19\n    #1 0x8468ca in SkSL::VariableReference::constantPropagate(SkSL::IRGenerator const&, SkTHashMap<SkSL::Variable const*, std::__1::unique_ptr<SkSL::Expression, std::__1::default_delete<SkSL::Expression> >*, SkGoodHash> const&) /src/skia/out/Fuzz/../../src/sksl/ir/SkSLVariableReference.cpp:62:34\n    #2 0x6e1e29 in SkSL::Compiler::simplifyExpression(SkTHashMap<SkSL::Variable const*, std::__1::unique_ptr<SkSL::Expression, std::__1::default_delete<SkSL::Expression> >*, SkGoodHash>&, SkSL::BasicBlock&, std::__1::__wrap_iter<SkSL::BasicBlock::Node*>*, SkSL::Compiler::OptimizationContext*) /src/skia/out/Fuzz/../../src/sksl/SkSLCompiler.cpp:839:55\n    #3 0x6ea48e in SkSL::Compiler::scanCFG(SkSL::FunctionDefinition&, SkSL::ProgramUsage*) /src/skia/out/Fuzz/../../src/sksl/SkSLCompiler.cpp:1606:27\n    #4 0x6eced0 in SkSL::Compiler::optimize(SkSL::Program&) /src/skia/out/Fuzz/../../src/sksl/SkSLCompiler.cpp:1728:38\n    #5 0x6ec25d in SkSL::Compiler::convertProgram(SkSL::Program::Kind, SkSL::String, SkSL::Program::Settings const&, std::__1::vector<std::__1::unique_ptr<SkSL::ExternalValue, std::__1::default_delete<SkSL::ExternalValue> >, std::__1::allocator<std::__1::unique_ptr<SkSL::ExternalValue, std::__1::default_delete<SkSL::ExternalValue> > > > const*) /src/skia/out/Fuzz/../../src/sksl/SkSLCompiler.cpp:1705:45\n    #6 0x50183e in FuzzSKSL2Pipeline(sk_sp<SkData>) /src/skia/out/Fuzz/../../fuzz/oss_fuzz/FuzzSKSL2Pipeline.cpp:17:55\n    #7 0x502102 in LLVMFuzzerTestOneInput /src/skia/out/Fuzz/../../fuzz/oss_fuzz/FuzzSKSL2Pipeline.cpp:35:5\n    #8 0x4f7abb in main (/out/sksl2pipeline+0x4f7abb)\n    #9 0x7fc65eb6183f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n    #10 0x450d68 in _start (/out/sksl2pipeline+0x450d68)\n\nDEDUP_TOKEN: std::__1::unique_ptr<SkSL::Expression, std::__1::default_delete<SkSL::Expression> >::operator->() const--SkSL::VariableReference::constantPropagate(SkSL::IRGenerator const&, SkTHashMap<SkSL::Variable const*, std::__1::unique_ptr<SkSL::Expression, std::__1::default_delete<SkSL::Expression> >*, SkGoodHash> const&)--SkSL::Compiler::simplifyExpression(SkTHashMap<SkSL::Variable const*, std::__1::unique_ptr<SkSL::Expression, std::__1::default_delete<SkSL::Expression> >*, SkGoodHash>&, SkSL::BasicBlock&, std::__1::__wrap_iter<SkSL::BasicBlock::Node*>*, SkSL::Compiler::OptimizationContext*)\n0x6310000009f8 is located 504 bytes inside of 65536-byte region [0x631000000800,0x631000010800)\nallocated by thread T0 here:\n    #0 0x4f4bcd in operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:99:3\n    #1 0x8a258c in GrMemoryPool::Make(unsigned long, unsigned long) /src/skia/out/Fuzz/../../src/gpu/GrMemoryPool.cpp:27:17\n    #2 0x8247ec in SkSL::Pool::Create() /src/skia/out/Fuzz/../../src/sksl/SkSLPool.cpp:67:22\n    #3 0x6ec05a in SkSL::Compiler::convertProgram(SkSL::Program::Kind, SkSL::String, SkSL::Program::Settings const&, std::__1::vector<std::__1::unique_ptr<SkSL::ExternalValue, std::__1::default_delete<SkSL::ExternalValue> >, std::__1::allocator<std::__1::unique_ptr<SkSL::ExternalValue, std::__1::default_delete<SkSL::ExternalValue> > > > const*) /src/skia/out/Fuzz/../../src/sksl/SkSLCompiler.cpp:1687:34\n    #4 0x50183e in FuzzSKSL2Pipeline(sk_sp<SkData>) /src/skia/out/Fuzz/../../fuzz/oss_fuzz/FuzzSKSL2Pipeline.cpp:17:55\n    #5 0x502102 in LLVMFuzzerTestOneInput /src/skia/out/Fuzz/../../fuzz/oss_fuzz/FuzzSKSL2Pipeline.cpp:35:5\n    #6 0x4f7abb in main (/out/sksl2pipeline+0x4f7abb)\n\nDEDUP_TOKEN: operator new(unsigned long)--GrMemoryPool::Make(unsigned long, unsigned long)--SkSL::Pool::Create()\nSUMMARY: AddressSanitizer: use-after-poison /usr/local/bin/../include/c++/v1/memory:2352:19 in std::__1::unique_ptr<SkSL::Expression, std::__1::default_delete<SkSL::Expression> >::operator->() const\nShadow bytes around the buggy address:\n  0x0c627fff80e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c627fff80f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c627fff8100: 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 00\n  0x0c627fff8110: 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 04\n  0x0c627fff8120: 00 00 00 00 00 00 00 00 00 f7 f7 f7 f7 f7 f7 f7\n=>0x0c627fff8130: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7[f7]\n  0x0c627fff8140: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7\n  0x0c627fff8150: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7\n  0x0c627fff8160: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7\n  0x0c627fff8170: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7\n  0x0c627fff8180: f7 f7 f7 f7 f7 f7 f7 f7 00 04 00 00 00 00 00 00\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n  Shadow gap:              cc\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.052662402391433716,
                    0.03533077985048294,
                    -0.07320504635572433,
                    0.010220527648925781,
                    -0.08020350337028503,
                    0.0014956211671233177,
                    -0.009706417098641396,
                    0.001786535605788231,
                    0.03717200085520744,
                    0.011817446909844875,
                    -0.024754708632826805,
                    -0.017859572544693947,
                    -0.06339461356401443,
                    -0.0063323951326310635,
                    0.017666349187493324,
                    -0.017077190801501274,
                    0.04354127123951912,
                    0.004350048955529928,
                    -0.0028655293863266706,
                    0.07363469153642654,
                    -0.025369642302393913,
                    0.05256371572613716,
                    -0.03114732913672924,
                    -0.032099369913339615,
                    -0.0229624155908823,
                    0.042536523193120956,
                    -0.08760160207748413,
                    -0.045709844678640366,
                    -0.02936323545873165,
                    -0.014320208691060543,
                    -0.09134257584810257,
                    -0.13087202608585358,
                    -0.045204561203718185,
                    -0.036349669098854065,
                    0.012341144494712353,
                    0.01076092291623354,
                    0.01612417958676815,
                    0.03242824599146843,
                    0.035136133432388306,
                    0.09945091605186462,
                    -0.028015220537781715,
                    -0.026834307238459587,
                    0.004572870675474405,
                    0.02421635203063488,
                    -0.06482283025979996,
                    0.04860147461295128,
                    0.06442561000585556,
                    -0.06126333400607109,
                    0.05380476638674736,
                    0.008261670358479023,
                    -0.14024618268013,
                    -0.010371541604399681,
                    -0.0014823254896327853,
                    -0.05974245071411133,
                    -0.00939737819135189,
                    -0.04565064236521721,
                    0.003157084807753563,
                    0.02798357792198658,
                    -0.07577434927225113,
                    0.11062373965978622,
                    0.04971987009048462,
                    -0.052433330565690994,
                    0.04240337386727333,
                    -0.025623761117458344,
                    -0.045542437583208084,
                    0.04030631482601166,
                    0.04752332344651222,
                    0.07103810459375381,
                    0.015597510151565075,
                    0.0054707881063222885,
                    0.04680892452597618,
                    0.1540544480085373,
                    -0.03810292109847069,
                    -0.16344572603702545,
                    0.02318001724779606,
                    0.03037712536752224,
                    -0.05687567591667175,
                    0.020383810624480247,
                    -0.05276753008365631,
                    -0.059566155076026917,
                    -0.026570983231067657,
                    -0.03359565511345863,
                    0.0034287050366401672,
                    0.036291759461164474,
                    -0.06096617877483368,
                    0.03732196241617203,
                    -0.01434857677668333,
                    -0.024348244071006775,
                    -0.039956528693437576,
                    -0.03439236432313919,
                    0.08300313353538513,
                    -0.06689921766519547,
                    0.014077376574277878,
                    -0.020278319716453552,
                    -0.010893943719565868,
                    0.06317594647407532,
                    -0.02213088981807232,
                    -0.002974696457386017,
                    -0.04000134393572807,
                    -0.003663555486127734,
                    -0.045983653515577316,
                    -0.0324363112449646,
                    0.0018317137146368623,
                    0.0031747601460665464,
                    0.0030800458043813705,
                    0.05611009895801544,
                    -0.053282011300325394,
                    -0.009830985218286514,
                    0.008572861552238464,
                    -0.036890123039484024,
                    -0.05943712592124939,
                    -0.012161292135715485,
                    -0.049029599875211716,
                    0.023745834827423096,
                    0.04658697172999382,
                    0.019476696848869324,
                    -0.014433939941227436,
                    -0.011924277059733868,
                    -0.03481015935540199,
                    0.039531461894512177,
                    0.06009407714009285,
                    -0.01911519095301628,
                    -0.01148224901407957,
                    -0.03423747420310974,
                    -0.040657177567481995,
                    0.01642802357673645,
                    0.014688730239868164,
                    0.010583554394543171,
                    0.03181798383593559,
                    0.06381198018789291,
                    -0.06973273307085037,
                    0.025071144104003906,
                    2.5256847948185168e-05,
                    -0.03145340085029602,
                    -0.0030632473062723875,
                    -0.0019647555891424417,
                    0.08851855993270874,
                    -0.002656545490026474,
                    0.0356268472969532,
                    0.021753020584583282,
                    0.07114750891923904,
                    0.018925776705145836,
                    0.003161999164149165,
                    0.005358079914003611,
                    0.032536789774894714,
                    0.003141478868201375,
                    0.04859381541609764,
                    0.07040975242853165,
                    -0.024947194382548332,
                    0.008001890033483505,
                    0.0031234314665198326,
                    0.00397934764623642,
                    -0.08479683846235275,
                    -0.023322300985455513,
                    -0.01731882430613041,
                    0.024374598637223244,
                    -0.026451855897903442,
                    -0.010086906142532825,
                    -0.007405234035104513,
                    -0.02003643475472927,
                    -0.01566748321056366,
                    0.06752818077802658,
                    -0.06761745363473892,
                    0.14550547301769257,
                    -0.06893881410360336,
                    0.08362483233213425,
                    -0.06993430107831955,
                    0.0487821139395237,
                    0.03570541366934776,
                    0.006169700995087624,
                    -0.041879165917634964,
                    0.03479280695319176,
                    0.011103157885372639,
                    0.005020448938012123,
                    0.022040465846657753,
                    0.025186926126480103,
                    -0.04538802430033684,
                    0.03940432891249657,
                    0.021523544564843178,
                    0.04196219518780708,
                    -0.002972268732264638,
                    0.09710710495710373,
                    -0.029257124289870262,
                    -0.04746571555733681,
                    -0.010762588120996952,
                    -0.010355939157307148,
                    -0.0995672270655632,
                    -0.05854169651865959,
                    0.0016676088562235236,
                    0.00072469562292099,
                    0.009831960313022137,
                    0.020752588286995888,
                    0.038800325244665146,
                    0.04162435606122017,
                    -0.10563827306032181,
                    0.03722993656992912,
                    -0.012884662486612797,
                    0.013653906993567944,
                    -0.008121454156935215,
                    -0.0671638771891594,
                    -0.06946729868650436,
                    -0.035416699945926666,
                    0.0503169447183609,
                    0.0524185448884964,
                    0.010450816713273525,
                    -0.07591664046049118,
                    0.11279384046792984,
                    -0.059443145990371704,
                    0.05460524931550026,
                    0.018008168786764145,
                    0.0001569679006934166,
                    0.01980471797287464,
                    0.07835794240236282,
                    -0.007354439701884985,
                    -0.022932017222046852,
                    -0.027819305658340454,
                    0.06622972339391708,
                    -0.04083438590168953,
                    -0.03322450816631317,
                    -1.309936214966001e-05,
                    -0.019969642162322998,
                    -0.05201311036944389,
                    -0.050868887454271317,
                    -0.0433492548763752,
                    0.029372459277510643,
                    0.025275519117712975,
                    -0.005790819879621267,
                    0.03135034441947937,
                    0.06340449303388596,
                    0.017835306003689766,
                    -0.04585973918437958,
                    0.016051344573497772,
                    -0.03941759094595909,
                    0.018125159665942192,
                    0.039948102086782455,
                    -0.02768966555595398,
                    0.07121141999959946,
                    0.0037453959230333567,
                    -0.043250661343336105,
                    -0.05885474011301994,
                    0.02315574698150158,
                    0.03735813498497009,
                    0.027767827734351158,
                    -0.015384998172521591,
                    0.07560305297374725,
                    -0.09118553251028061,
                    -0.05859563127160072,
                    0.046217311173677444,
                    -0.048609133809804916,
                    0.048372212797403336,
                    -0.016562972217798233,
                    0.0223712008446455,
                    0.14813871681690216,
                    -0.013456766493618488,
                    0.025749413296580315,
                    -0.05063404142856598
                ],
                "report_type": "Use-after-poison READ 8",
                "severity": "High"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 5296,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-skia-29982"
            }
        },
        "relation1": {
            "identity": 10468,
            "start": 5296,
            "end": 5300,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 5300,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Fix use-after-free discovered by the fuzzer.\n\nThe optimization which replaces unnecessarily nested constructors is\ncreating a new constructor from whole cloth, obliterating the original\nconstructor and its arguments. This can invalidate the definition map.\nFor now, this is fixed by forcing a rescan when this optimization is\napplied.\n\nChange-Id: I8a46bccf3b6422282eaf95409cd4fa50b8ad3187\nBug: oss-fuzz:29994\nReviewed-on: https://skia-review.googlesource.com/c/skia/+/369324\nCommit-Queue: John Stiles <johnstiles@google.com>\nCommit-Queue: Ethan Nicholas <ethannicholas@google.com>\nAuto-Submit: John Stiles <johnstiles@google.com>\nReviewed-by: Ethan Nicholas <ethannicholas@google.com>\n",
                "sha": "1b91c0e29bc802b515f509d6a0e9396f2318b066",
                "repo": "skia",
                "encoding": "UTF-8",
                "authored_date": 1613061789,
                "committer_tz_offset": 0,
                "author_tz_offset": 18000,
                "committed_date": 1613065963
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 5296,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-skia-29982"
            }
        },
        "relation1": {
            "identity": 10462,
            "start": 5296,
            "end": 5297,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 5297,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Don't forget to call putBackVertices from the stroke tessellator\n\nChange-Id: I80652861841ec4f049336f1759c1c26a934c309a\nReviewed-on: https://skia-review.googlesource.com/c/skia/+/369261\nReviewed-by: Brian Osman <brianosman@google.com>\nCommit-Queue: Chris Dalton <csmartdalton@google.com>\n",
                "sha": "53ab360418132cc5fce9a10cb153f210b3c19c2a",
                "repo": "skia",
                "encoding": "UTF-8",
                "authored_date": 1613032056,
                "committer_tz_offset": 0,
                "author_tz_offset": 25200,
                "committed_date": 1613065220
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]