[
    {
        "baseNode": {
            "identity": 9907,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36043"
            }
        },
        "relation1": {
            "identity": 20420,
            "start": 9907,
            "end": 9909,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 9909,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.021839933469891548,
                    -0.11051204800605774,
                    -0.05605997145175934,
                    0.11938586086034775,
                    0.001923891482874751,
                    -0.009809578768908978,
                    -0.0990995392203331,
                    0.011165454052388668,
                    0.02448423206806183,
                    0.02803841605782509,
                    -0.011984950862824917,
                    -0.024076176807284355,
                    -0.10864868015050888,
                    -0.06390351802110672,
                    -0.03987060859799385,
                    -0.09941582381725311,
                    -0.012283539399504662,
                    0.04511374980211258,
                    -0.00014441485109273344,
                    0.04590047895908356,
                    -0.03643449768424034,
                    0.03036460280418396,
                    -0.05764415115118027,
                    0.05155548080801964,
                    0.0942155122756958,
                    0.029908280819654465,
                    0.04104721546173096,
                    -0.055365562438964844,
                    -0.0325833298265934,
                    -0.04724710434675217,
                    -0.09758742153644562,
                    -0.09102053940296173,
                    0.030632728710770607,
                    0.044765789061784744,
                    -0.04093637317419052,
                    0.04412698373198509,
                    0.009391631931066513,
                    -0.03674947842955589,
                    0.001912157516926527,
                    0.06851934641599655,
                    -0.06045809015631676,
                    -0.08424931019544601,
                    -0.021535133942961693,
                    0.04526727274060249,
                    -0.15340833365917206,
                    -0.021975763142108917,
                    0.06340533494949341,
                    -0.10291686654090881,
                    0.017330264672636986,
                    0.06857125461101532,
                    -0.0646618902683258,
                    -0.026293553411960602,
                    -0.09982768446207047,
                    0.015187006443738937,
                    -0.02797527238726616,
                    -0.0025164894759655,
                    -0.024159930646419525,
                    -0.04808393120765686,
                    -0.15167319774627686,
                    0.0001183085041702725,
                    -0.012555777095258236,
                    -0.016359733417630196,
                    0.0350954569876194,
                    -0.11804139614105225,
                    0.13129131495952606,
                    -0.06507250666618347,
                    0.10605573654174805,
                    0.007172897923737764,
                    0.08215564489364624,
                    -0.07998974621295929,
                    0.09771492332220078,
                    -0.0022448066156357527,
                    -0.12469252943992615,
                    0.07662926614284515,
                    -0.02659844234585762,
                    0.03540670871734619,
                    0.003520725993439555,
                    -0.006100357044488192,
                    0.0512191504240036,
                    -0.06886381655931473,
                    0.017704570665955544,
                    -0.008863012306392193,
                    -0.008008070290088654,
                    -0.015626100823283195,
                    0.024012675508856773,
                    -0.027238233014941216,
                    0.13800930976867676,
                    0.026393551379442215,
                    0.1758597046136856,
                    -0.0068449778482317924,
                    6.925451452843845e-05,
                    -0.01397736743092537,
                    -0.036035530269145966,
                    0.0743398666381836,
                    -0.09126275777816772,
                    -0.02962956763803959,
                    -0.009715714491903782,
                    -0.01204870454967022,
                    -0.04942828789353371,
                    -0.04114089533686638,
                    -0.051292020827531815,
                    -0.039161909371614456,
                    -0.11638245731592178,
                    -0.05462270602583885,
                    -0.013966192491352558,
                    -0.015354527160525322,
                    -0.05793221667408943,
                    0.046050313860177994,
                    -0.006412360351532698,
                    -0.062151115387678146,
                    0.04940798878669739,
                    0.05189468339085579,
                    0.019753213971853256,
                    0.03716593235731125,
                    0.048396363854408264,
                    -0.08896655589342117,
                    -0.10209473222494125,
                    0.014823328703641891,
                    0.043280649930238724,
                    0.009974082931876183,
                    0.1166437417268753,
                    0.07146771252155304,
                    -0.05731729418039322,
                    -0.14138279855251312,
                    -0.07973960787057877,
                    -0.02973063290119171,
                    -0.020847750827670097,
                    0.13980814814567566,
                    0.0871710255742073,
                    0.04800523445010185,
                    -0.08765453100204468,
                    0.029400570318102837,
                    -0.0007288090419024229,
                    -0.03477713465690613,
                    0.061194468289613724,
                    0.02657102793455124,
                    0.0698641911149025,
                    0.0014422470703721046,
                    0.10727126151323318,
                    0.005100558511912823,
                    -0.02944500371813774,
                    0.09575816988945007,
                    0.10161323100328445,
                    0.03339025005698204,
                    0.030261602252721786,
                    -0.027262795716524124,
                    -0.005673582665622234,
                    0.002295220736414194,
                    -0.09113173186779022,
                    -0.11515714228153229,
                    -0.044041622430086136,
                    -0.0463084913790226,
                    -0.08884967863559723,
                    -0.05585448443889618,
                    0.020406672731041908,
                    0.1241861879825592,
                    -0.0506720095872879,
                    0.016920991241931915,
                    0.04220804572105408,
                    0.017057381570339203,
                    -0.013893882744014263,
                    -0.00012913826503790915,
                    0.07290130108594894,
                    0.1258416622877121,
                    0.08515240252017975,
                    0.09566139429807663,
                    0.014073784463107586,
                    -0.019239742308855057,
                    -0.04311027377843857,
                    0.013563555665314198,
                    0.03078836388885975,
                    0.0948500707745552,
                    0.0702599361538887,
                    -0.030565202236175537,
                    0.037027228623628616,
                    -0.0552179180085659,
                    0.022282391786575317,
                    -0.02027197927236557,
                    0.014018845744431019,
                    -0.06503571569919586,
                    0.030570421367883682,
                    0.05191445350646973,
                    -0.02959091030061245,
                    -0.0031551753636449575,
                    0.07289383560419083,
                    -0.048244867473840714,
                    -0.02329665794968605,
                    -0.1470193862915039,
                    -0.0667111799120903,
                    0.03333361819386482,
                    0.0867576003074646,
                    -0.014613096602261066,
                    0.0038218325935304165,
                    -0.021092796698212624,
                    -0.062310073524713516,
                    -0.00399694312363863,
                    0.009694830514490604,
                    -0.024006132036447525,
                    0.01924612931907177,
                    -0.05262593924999237,
                    -0.042937956750392914,
                    0.0010498290648683906,
                    -0.03145540878176689,
                    0.09818901121616364,
                    0.03482748568058014,
                    0.05215778201818466,
                    0.04987883195281029,
                    -0.16133275628089905,
                    0.034478574991226196,
                    0.05625227838754654,
                    0.1115519106388092,
                    -0.04225250706076622,
                    0.1523459553718567,
                    0.10935892909765244,
                    -0.010178877040743828,
                    -0.07292511314153671,
                    -0.0019649325404316187,
                    0.11811792105436325,
                    0.09527470171451569,
                    0.08321899175643921,
                    -0.0017900436650961637,
                    -0.027168750762939453,
                    -0.0032262387685477734,
                    -0.06400278955698013,
                    0.040817514061927795,
                    0.008482512086629868,
                    0.01295573078095913,
                    -0.007965886034071445,
                    0.0240167323499918,
                    0.032522838562726974,
                    -0.040216680616140366,
                    0.01944642886519432,
                    0.01720871403813362,
                    -0.008686603978276253,
                    0.09788215160369873,
                    -0.03248133882880211,
                    0.032640330493450165,
                    0.03741703927516937,
                    -0.005161586217582226,
                    -0.10633736103773117,
                    0.012854625470936298,
                    0.02110402099788189,
                    -0.06603366136550903,
                    -0.03645768016576767,
                    0.05488545447587967,
                    -0.014769420959055424,
                    -0.060868553817272186,
                    0.03706047311425209,
                    -0.09958099573850632,
                    0.02132248878479004,
                    0.04326798766851425,
                    0.043718121945858,
                    -0.021165363490581512,
                    0.06273113936185837,
                    -0.0780724287033081,
                    -0.12169495970010757
                ],
                "diffText": "diff --git a/lib/jxl/modular/transform/squeeze.cc b/lib/jxl/modular/transform/squeeze.cc\nindex c1940e4a..fd8867b7 100644\n--- a/lib/jxl/modular/transform/squeeze.cc\n+++ b/lib/jxl/modular/transform/squeeze.cc\n@@ -235,6 +235,15 @@ Status MetaSqueeze(Image &image, std::vector<SqueezeParams> *parameters) {\n     uint32_t endc = (*parameters)[i].begin_c + (*parameters)[i].num_c - 1;\n \n     uint32_t offset;\n+    if (beginc < image.nb_meta_channels) {\n+      if (endc >= image.nb_meta_channels) {\n+        return JXL_FAILURE(\"Invalid squeeze: mix of meta and nonmeta channels\");\n+      }\n+      if (!in_place)\n+        return JXL_FAILURE(\n+            \"Invalid squeeze: meta channels require in-place residuals\");\n+      image.nb_meta_channels += (*parameters)[i].num_c;\n+    }\n     if (in_place) {\n       offset = endc + 1;\n     } else {"
            }
        },
        "relation2": {
            "identity": 20420,
            "start": 9909,
            "end": 9907,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 9907,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36043"
            }
        }
    },
    {
        "baseNode": {
            "identity": 9907,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36043"
            }
        },
        "relation1": {
            "identity": 20420,
            "start": 9907,
            "end": 9909,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 9909,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.021839933469891548,
                    -0.11051204800605774,
                    -0.05605997145175934,
                    0.11938586086034775,
                    0.001923891482874751,
                    -0.009809578768908978,
                    -0.0990995392203331,
                    0.011165454052388668,
                    0.02448423206806183,
                    0.02803841605782509,
                    -0.011984950862824917,
                    -0.024076176807284355,
                    -0.10864868015050888,
                    -0.06390351802110672,
                    -0.03987060859799385,
                    -0.09941582381725311,
                    -0.012283539399504662,
                    0.04511374980211258,
                    -0.00014441485109273344,
                    0.04590047895908356,
                    -0.03643449768424034,
                    0.03036460280418396,
                    -0.05764415115118027,
                    0.05155548080801964,
                    0.0942155122756958,
                    0.029908280819654465,
                    0.04104721546173096,
                    -0.055365562438964844,
                    -0.0325833298265934,
                    -0.04724710434675217,
                    -0.09758742153644562,
                    -0.09102053940296173,
                    0.030632728710770607,
                    0.044765789061784744,
                    -0.04093637317419052,
                    0.04412698373198509,
                    0.009391631931066513,
                    -0.03674947842955589,
                    0.001912157516926527,
                    0.06851934641599655,
                    -0.06045809015631676,
                    -0.08424931019544601,
                    -0.021535133942961693,
                    0.04526727274060249,
                    -0.15340833365917206,
                    -0.021975763142108917,
                    0.06340533494949341,
                    -0.10291686654090881,
                    0.017330264672636986,
                    0.06857125461101532,
                    -0.0646618902683258,
                    -0.026293553411960602,
                    -0.09982768446207047,
                    0.015187006443738937,
                    -0.02797527238726616,
                    -0.0025164894759655,
                    -0.024159930646419525,
                    -0.04808393120765686,
                    -0.15167319774627686,
                    0.0001183085041702725,
                    -0.012555777095258236,
                    -0.016359733417630196,
                    0.0350954569876194,
                    -0.11804139614105225,
                    0.13129131495952606,
                    -0.06507250666618347,
                    0.10605573654174805,
                    0.007172897923737764,
                    0.08215564489364624,
                    -0.07998974621295929,
                    0.09771492332220078,
                    -0.0022448066156357527,
                    -0.12469252943992615,
                    0.07662926614284515,
                    -0.02659844234585762,
                    0.03540670871734619,
                    0.003520725993439555,
                    -0.006100357044488192,
                    0.0512191504240036,
                    -0.06886381655931473,
                    0.017704570665955544,
                    -0.008863012306392193,
                    -0.008008070290088654,
                    -0.015626100823283195,
                    0.024012675508856773,
                    -0.027238233014941216,
                    0.13800930976867676,
                    0.026393551379442215,
                    0.1758597046136856,
                    -0.0068449778482317924,
                    6.925451452843845e-05,
                    -0.01397736743092537,
                    -0.036035530269145966,
                    0.0743398666381836,
                    -0.09126275777816772,
                    -0.02962956763803959,
                    -0.009715714491903782,
                    -0.01204870454967022,
                    -0.04942828789353371,
                    -0.04114089533686638,
                    -0.051292020827531815,
                    -0.039161909371614456,
                    -0.11638245731592178,
                    -0.05462270602583885,
                    -0.013966192491352558,
                    -0.015354527160525322,
                    -0.05793221667408943,
                    0.046050313860177994,
                    -0.006412360351532698,
                    -0.062151115387678146,
                    0.04940798878669739,
                    0.05189468339085579,
                    0.019753213971853256,
                    0.03716593235731125,
                    0.048396363854408264,
                    -0.08896655589342117,
                    -0.10209473222494125,
                    0.014823328703641891,
                    0.043280649930238724,
                    0.009974082931876183,
                    0.1166437417268753,
                    0.07146771252155304,
                    -0.05731729418039322,
                    -0.14138279855251312,
                    -0.07973960787057877,
                    -0.02973063290119171,
                    -0.020847750827670097,
                    0.13980814814567566,
                    0.0871710255742073,
                    0.04800523445010185,
                    -0.08765453100204468,
                    0.029400570318102837,
                    -0.0007288090419024229,
                    -0.03477713465690613,
                    0.061194468289613724,
                    0.02657102793455124,
                    0.0698641911149025,
                    0.0014422470703721046,
                    0.10727126151323318,
                    0.005100558511912823,
                    -0.02944500371813774,
                    0.09575816988945007,
                    0.10161323100328445,
                    0.03339025005698204,
                    0.030261602252721786,
                    -0.027262795716524124,
                    -0.005673582665622234,
                    0.002295220736414194,
                    -0.09113173186779022,
                    -0.11515714228153229,
                    -0.044041622430086136,
                    -0.0463084913790226,
                    -0.08884967863559723,
                    -0.05585448443889618,
                    0.020406672731041908,
                    0.1241861879825592,
                    -0.0506720095872879,
                    0.016920991241931915,
                    0.04220804572105408,
                    0.017057381570339203,
                    -0.013893882744014263,
                    -0.00012913826503790915,
                    0.07290130108594894,
                    0.1258416622877121,
                    0.08515240252017975,
                    0.09566139429807663,
                    0.014073784463107586,
                    -0.019239742308855057,
                    -0.04311027377843857,
                    0.013563555665314198,
                    0.03078836388885975,
                    0.0948500707745552,
                    0.0702599361538887,
                    -0.030565202236175537,
                    0.037027228623628616,
                    -0.0552179180085659,
                    0.022282391786575317,
                    -0.02027197927236557,
                    0.014018845744431019,
                    -0.06503571569919586,
                    0.030570421367883682,
                    0.05191445350646973,
                    -0.02959091030061245,
                    -0.0031551753636449575,
                    0.07289383560419083,
                    -0.048244867473840714,
                    -0.02329665794968605,
                    -0.1470193862915039,
                    -0.0667111799120903,
                    0.03333361819386482,
                    0.0867576003074646,
                    -0.014613096602261066,
                    0.0038218325935304165,
                    -0.021092796698212624,
                    -0.062310073524713516,
                    -0.00399694312363863,
                    0.009694830514490604,
                    -0.024006132036447525,
                    0.01924612931907177,
                    -0.05262593924999237,
                    -0.042937956750392914,
                    0.0010498290648683906,
                    -0.03145540878176689,
                    0.09818901121616364,
                    0.03482748568058014,
                    0.05215778201818466,
                    0.04987883195281029,
                    -0.16133275628089905,
                    0.034478574991226196,
                    0.05625227838754654,
                    0.1115519106388092,
                    -0.04225250706076622,
                    0.1523459553718567,
                    0.10935892909765244,
                    -0.010178877040743828,
                    -0.07292511314153671,
                    -0.0019649325404316187,
                    0.11811792105436325,
                    0.09527470171451569,
                    0.08321899175643921,
                    -0.0017900436650961637,
                    -0.027168750762939453,
                    -0.0032262387685477734,
                    -0.06400278955698013,
                    0.040817514061927795,
                    0.008482512086629868,
                    0.01295573078095913,
                    -0.007965886034071445,
                    0.0240167323499918,
                    0.032522838562726974,
                    -0.040216680616140366,
                    0.01944642886519432,
                    0.01720871403813362,
                    -0.008686603978276253,
                    0.09788215160369873,
                    -0.03248133882880211,
                    0.032640330493450165,
                    0.03741703927516937,
                    -0.005161586217582226,
                    -0.10633736103773117,
                    0.012854625470936298,
                    0.02110402099788189,
                    -0.06603366136550903,
                    -0.03645768016576767,
                    0.05488545447587967,
                    -0.014769420959055424,
                    -0.060868553817272186,
                    0.03706047311425209,
                    -0.09958099573850632,
                    0.02132248878479004,
                    0.04326798766851425,
                    0.043718121945858,
                    -0.021165363490581512,
                    0.06273113936185837,
                    -0.0780724287033081,
                    -0.12169495970010757
                ],
                "diffText": "diff --git a/lib/jxl/modular/transform/squeeze.cc b/lib/jxl/modular/transform/squeeze.cc\nindex c1940e4a..fd8867b7 100644\n--- a/lib/jxl/modular/transform/squeeze.cc\n+++ b/lib/jxl/modular/transform/squeeze.cc\n@@ -235,6 +235,15 @@ Status MetaSqueeze(Image &image, std::vector<SqueezeParams> *parameters) {\n     uint32_t endc = (*parameters)[i].begin_c + (*parameters)[i].num_c - 1;\n \n     uint32_t offset;\n+    if (beginc < image.nb_meta_channels) {\n+      if (endc >= image.nb_meta_channels) {\n+        return JXL_FAILURE(\"Invalid squeeze: mix of meta and nonmeta channels\");\n+      }\n+      if (!in_place)\n+        return JXL_FAILURE(\n+            \"Invalid squeeze: meta channels require in-place residuals\");\n+      image.nb_meta_channels += (*parameters)[i].num_c;\n+    }\n     if (in_place) {\n       offset = endc + 1;\n     } else {"
            }
        },
        "relation2": {
            "identity": 20419,
            "start": 9909,
            "end": 1017,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 1017,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "lib/jxl/modular/transform/squeeze.cc"
            }
        }
    },
    {
        "baseNode": {
            "identity": 9907,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36043"
            }
        },
        "relation1": {
            "identity": 20418,
            "start": 9907,
            "end": 1007,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 1007,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "libjxl"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 9907,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36043"
            }
        },
        "relation1": {
            "identity": 20417,
            "start": 9907,
            "end": 9908,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 9908,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "msan",
                "report_content": "INFO: Running with entropic power schedule (0xFF, 100).\nINFO: Seed: 1721668034\nINFO: Loaded 1 modules   (31879 inline 8-bit counters): 31879 [0x5651787b6b28, 0x5651787be7af), \nINFO: Loaded 1 PC tables (31879 PCs): 31879 [0x5651787be7b0,0x56517883b020), \n/out/djxl_fuzzer: Running 1 inputs 1 time(s) each.\nRunning: /tmp/poc\n==1==WARNING: MemorySanitizer: use-of-uninitialized-value\n    #0 0x565177baeb4f in jxl::palette_internal::GetPaletteValue(int const*, int, unsigned long, int, int, int) /src/libjxl/lib/jxl/modular/transform/palette.h:43:7\n    #1 0x565177bb2b63 in operator() /src/libjxl/lib/jxl/modular/transform/palette.h:256:21\n    #2 0x565177bb2b63 in jxl::ThreadPool::RunCallState<jxl::Status (unsigned long), jxl::InvPalette(jxl::Image&, unsigned int, unsigned int, unsigned int, jxl::Predictor, jxl::weighted::Header const&, jxl::ThreadPool*)::$_4>::CallDataFunc(void*, unsigned int, unsigned long) /src/libjxl/lib/jxl/base/data_parallel.h:88:14\n    #3 0x565177be4c8c in jxl::ThreadPool::SequentialRunnerStatic(void*, void*, int (*)(void*, unsigned long), void (*)(void*, unsigned int, unsigned long), unsigned int, unsigned int) /src/libjxl/lib/jxl/base/data_parallel.cc:18:5\n    #4 0x565177ba78f1 in Run<jxl::Status (unsigned long), (lambda at /src/libjxl/lib/jxl/modular/transform/palette.h:247:11)> /src/libjxl/lib/jxl/base/data_parallel.h:51:12\n    #5 0x565177ba78f1 in Run<(lambda at /src/libjxl/lib/jxl/modular/transform/palette.h:247:11)> /src/libjxl/lib/jxl/base/data_parallel.h:60:12\n    #6 0x565177ba78f1 in RunOnPool<jxl::ThreadPool::SkipInit, (lambda at /src/libjxl/lib/jxl/modular/transform/palette.h:247:11)> /src/libjxl/lib/jxl/base/data_parallel.h:115:24\n    #7 0x565177ba78f1 in InvPalette /src/libjxl/lib/jxl/modular/transform/palette.h:245:7\n    #8 0x565177ba78f1 in jxl::Transform::Inverse(jxl::Image&, jxl::weighted::Header const&, jxl::ThreadPool*) /src/libjxl/lib/jxl/modular/transform/transform.cc:30:14\n    #9 0x565177b9c718 in jxl::Image::undo_transforms(jxl::weighted::Header const&, int, jxl::ThreadPool*) /src/libjxl/lib/jxl/modular/modular_image.cc:20:23\n    #10 0x565177e3cf25 in jxl::ModularFrameDecoder::FinalizeDecoding(jxl::PassesDecoderState*, jxl::ThreadPool*, jxl::ImageBundle*) /src/libjxl/lib/jxl/dec_modular.cc:435:6\n    #11 0x565177c861fb in jxl::FrameDecoder::Flush() /src/libjxl/lib/jxl/dec_frame.cc:812:3\n    #12 0x565177c74ae0 in jxl::FrameDecoder::FinalizeFrame() /src/libjxl/lib/jxl/dec_frame.cc:910:3\n    #13 0x565177c6b356 in jxl::DecodeFrame(jxl::DecompressParams const&, jxl::PassesDecoderState*, jxl::ThreadPool*, jxl::BitReader*, jxl::ImageBundle*, jxl::CodecMetadata const&, jxl::SizeConstraints const*, bool) /src/libjxl/lib/jxl/dec_frame.cc:230:3\n    #14 0x565177a33be0 in jxl::(anonymous namespace)::JxlDecoderProcessInternal(JxlDecoderStruct*, unsigned char const*, unsigned long) /src/libjxl/lib/jxl/decode.cc:1062:12\n    #15 0x565177a24062 in JxlDecoderProcessInput /src/libjxl/lib/jxl/decode.cc:1712:14\n    #16 0x565177a09ccf in DecodeJpegXl /src/libjxl/tools/djxl_fuzzer.cc:163:31\n    #17 0x565177a09ccf in TestOneInput /src/libjxl/tools/djxl_fuzzer.cc:472:3\n    #18 0x565177a09ccf in LLVMFuzzerTestOneInput /src/libjxl/tools/djxl_fuzzer.cc:482:10\n    #19 0x56517793a263 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15\n    #20 0x5651779259a2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6\n    #21 0x56517792b67e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9\n    #22 0x565177955172 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #23 0x7fc149ed483f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n    #24 0x565177900a48 in _start (/out/djxl_fuzzer+0x100a48)\n\nDEDUP_TOKEN: jxl::palette_internal::GetPaletteValue(int const*, int, unsigned long, int, int, int)--operator()--jxl::ThreadPool::RunCallState<jxl::Status (unsigned long), jxl::InvPalette(jxl::Image&, unsigned int, unsigned int, unsigned int, jxl::Predictor, jxl::weighted::Header const&, jxl::ThreadPool*)::$_4>::CallDataFunc(void*, unsigned int, unsigned long)\n  Uninitialized value was stored to memory at\n    #0 0x5651779af7e9 in __msan_memcpy /src/llvm-project/compiler-rt/lib/msan/msan_interceptors.cpp:1558:3\n    #1 0x565177baafdb in CopyImageTo<int> /src/libjxl/lib/jxl/image_ops.h:30:5\n    #2 0x565177baafdb in jxl::Plane<int> jxl::CopyImage<int>(jxl::Plane<int> const&) /src/libjxl/lib/jxl/image_ops.h:38:3\n    #3 0x565177ba66c7 in InvPalette /src/libjxl/lib/jxl/modular/transform/palette.h:178:22\n    #4 0x565177ba66c7 in jxl::Transform::Inverse(jxl::Image&, jxl::weighted::Header const&, jxl::ThreadPool*) /src/libjxl/lib/jxl/modular/transform/transform.cc:30:14\n    #5 0x565177b9c718 in jxl::Image::undo_transforms(jxl::weighted::Header const&, int, jxl::ThreadPool*) /src/libjxl/lib/jxl/modular/modular_image.cc:20:23\n    #6 0x565177e3cf25 in jxl::ModularFrameDecoder::FinalizeDecoding(jxl::PassesDecoderState*, jxl::ThreadPool*, jxl::ImageBundle*) /src/libjxl/lib/jxl/dec_modular.cc:435:6\n    #7 0x565177c861fb in jxl::FrameDecoder::Flush() /src/libjxl/lib/jxl/dec_frame.cc:812:3\n    #8 0x565177c74ae0 in jxl::FrameDecoder::FinalizeFrame() /src/libjxl/lib/jxl/dec_frame.cc:910:3\n    #9 0x565177c6b356 in jxl::DecodeFrame(jxl::DecompressParams const&, jxl::PassesDecoderState*, jxl::ThreadPool*, jxl::BitReader*, jxl::ImageBundle*, jxl::CodecMetadata const&, jxl::SizeConstraints const*, bool) /src/libjxl/lib/jxl/dec_frame.cc:230:3\n    #10 0x565177a33be0 in jxl::(anonymous namespace)::JxlDecoderProcessInternal(JxlDecoderStruct*, unsigned char const*, unsigned long) /src/libjxl/lib/jxl/decode.cc:1062:12\n    #11 0x565177a24062 in JxlDecoderProcessInput /src/libjxl/lib/jxl/decode.cc:1712:14\n    #12 0x565177a09ccf in DecodeJpegXl /src/libjxl/tools/djxl_fuzzer.cc:163:31\n    #13 0x565177a09ccf in TestOneInput /src/libjxl/tools/djxl_fuzzer.cc:472:3\n    #14 0x565177a09ccf in LLVMFuzzerTestOneInput /src/libjxl/tools/djxl_fuzzer.cc:482:10\n    #15 0x56517793a263 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15\n    #16 0x5651779259a2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6\n    #17 0x56517792b67e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9\n    #18 0x565177955172 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #19 0x7fc149ed483f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n\nDEDUP_TOKEN: __msan_memcpy--CopyImageTo<int>--jxl::Plane<int> jxl::CopyImage<int>(jxl::Plane<int> const&)\n  Uninitialized value was created by a heap allocation\n    #0 0x5651779b629d in malloc /src/llvm-project/compiler-rt/lib/msan/msan_interceptors.cpp:901:3\n    #1 0x565177be4486 in jxl::CacheAligned::Allocate(unsigned long, unsigned long) /src/libjxl/lib/jxl/base/cache_aligned.cc:85:21\n    #2 0x565177aa5af1 in Allocate /src/libjxl/lib/jxl/base/cache_aligned.h:43:12\n    #3 0x565177aa5af1 in AllocateArray /src/libjxl/lib/jxl/base/cache_aligned.h:61:29\n    #4 0x565177aa5af1 in jxl::PlaneBase::PlaneBase(unsigned long, unsigned long, unsigned long) /src/libjxl/lib/jxl/image.cc:93:14\n    #5 0x565177ba957b in Plane /src/libjxl/lib/jxl/image.h:147:9\n    #6 0x565177ba957b in Channel /src/libjxl/lib/jxl/modular/modular_image.h:40:9\n    #7 0x565177ba957b in MetaPalette /src/libjxl/lib/jxl/modular/transform/palette.h:294:11\n    #8 0x565177ba957b in jxl::Transform::MetaApply(jxl::Image&) /src/libjxl/lib/jxl/modular/transform/transform.cc:66:14\n    #9 0x565177b82af9 in jxl::ModularDecode(jxl::BitReader*, jxl::Image&, jxl::GroupHeader&, unsigned long, jxl::ModularOptions*, std::__1::vector<jxl::PropertyDecisionNode, std::__1::allocator<jxl::PropertyDecisionNode> > const*, jxl::ANSCode const*, std::__1::vector<unsigned char, std::__1::allocator<unsigned char> > const*, bool) /src/libjxl/lib/jxl/modular/encoding/encoding.cc:394:5\n    #10 0x565177b85ca5 in jxl::ModularGenericDecompress(jxl::BitReader*, jxl::Image&, jxl::GroupHeader*, unsigned long, jxl::ModularOptions*, int, std::__1::vector<jxl::PropertyDecisionNode, std::__1::allocator<jxl::PropertyDecisionNode> > const*, jxl::ANSCode const*, std::__1::vector<unsigned char, std::__1::allocator<unsigned char> > const*, bool) /src/libjxl/lib/jxl/modular/encoding/encoding.cc:505:21\n    #11 0x565177e302b1 in jxl::ModularFrameDecoder::DecodeGlobalInfo(jxl::BitReader*, jxl::FrameHeader const&, bool) /src/libjxl/lib/jxl/dec_modular.cc:207:23\n    #12 0x565177c7968d in jxl::FrameDecoder::ProcessDCGlobal(jxl::BitReader*) /src/libjxl/lib/jxl/dec_frame.cc:374:46\n    #13 0x565177c7111c in jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*) /src/libjxl/lib/jxl/dec_frame.cc:654:31\n    #14 0x565177c6a6d9 in jxl::DecodeFrame(jxl::DecompressParams const&, jxl::PassesDecoderState*, jxl::ThreadPool*, jxl::BitReader*, jxl::ImageBundle*, jxl::CodecMetadata const&, jxl::SizeConstraints const*, bool) /src/libjxl/lib/jxl/dec_frame.cc:208:5\n    #15 0x565177a33be0 in jxl::(anonymous namespace)::JxlDecoderProcessInternal(JxlDecoderStruct*, unsigned char const*, unsigned long) /src/libjxl/lib/jxl/decode.cc:1062:12\n    #16 0x565177a24062 in JxlDecoderProcessInput /src/libjxl/lib/jxl/decode.cc:1712:14\n    #17 0x565177a09ccf in DecodeJpegXl /src/libjxl/tools/djxl_fuzzer.cc:163:31\n    #18 0x565177a09ccf in TestOneInput /src/libjxl/tools/djxl_fuzzer.cc:472:3\n    #19 0x565177a09ccf in LLVMFuzzerTestOneInput /src/libjxl/tools/djxl_fuzzer.cc:482:10\n    #20 0x56517793a263 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15\n    #21 0x5651779259a2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6\n    #22 0x56517792b67e in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9\n    #23 0x565177955172 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #24 0x7fc149ed483f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n\nDEDUP_TOKEN: malloc--jxl::CacheAligned::Allocate(unsigned long, unsigned long)--Allocate\nSUMMARY: MemorySanitizer: use-of-uninitialized-value /src/libjxl/lib/jxl/modular/transform/palette.h:43:7 in jxl::palette_internal::GetPaletteValue(int const*, int, unsigned long, int, int, int)\nUnique heap origins: 1717\nStack depot allocated bytes: 253112\nUnique origin histories: 148\nHistory depot allocated bytes: 3552\nExiting\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.015273716300725937,
                    0.03328968957066536,
                    -0.07315172255039215,
                    1.6903039067983627e-05,
                    -0.03658052906394005,
                    0.029295025393366814,
                    -0.034846968948841095,
                    0.04199712350964546,
                    0.029351601377129555,
                    -0.014184482395648956,
                    -0.011193710379302502,
                    0.010300644673407078,
                    -0.029801011085510254,
                    0.003552942769601941,
                    0.037365615367889404,
                    -0.019867029041051865,
                    0.12763775885105133,
                    0.02669285051524639,
                    -0.006485611200332642,
                    0.05698283016681671,
                    -0.055127162486314774,
                    -0.008788258768618107,
                    -0.018512438982725143,
                    0.01758558116853237,
                    0.004403919447213411,
                    0.020966647192835808,
                    -0.08640437573194504,
                    -0.05600335821509361,
                    0.0033558346331119537,
                    -0.06396353989839554,
                    -0.15035896003246307,
                    -0.13987688720226288,
                    0.04626220092177391,
                    -0.018644776195287704,
                    -0.056464944034814835,
                    -0.02151973731815815,
                    0.010871159844100475,
                    0.010183443315327168,
                    0.0016683420399203897,
                    0.09541865438222885,
                    -0.06225569546222687,
                    -0.04477832838892937,
                    0.02364463545382023,
                    -0.03119738958775997,
                    -0.025368772447109222,
                    0.010377285070717335,
                    -0.002652594819664955,
                    -0.07311157137155533,
                    0.053421501070261,
                    -0.01892230100929737,
                    -0.08809701353311539,
                    0.004251222126185894,
                    -0.05917324498295784,
                    -0.03359352424740791,
                    -0.044417958706617355,
                    -0.059133272618055344,
                    -0.00984047632664442,
                    0.031053824350237846,
                    -0.05901871621608734,
                    0.06414464861154556,
                    0.041058752685785294,
                    -0.06901013851165771,
                    0.01878095604479313,
                    -0.04966741427779198,
                    0.0011291293194517493,
                    -0.02561075985431671,
                    0.025477305054664612,
                    -0.03699982166290283,
                    0.04549716040492058,
                    -0.019916795194149017,
                    -0.0029822010546922684,
                    0.11616551876068115,
                    -0.0959404930472374,
                    -0.06878360360860825,
                    -0.01526166032999754,
                    -0.0005163748865015805,
                    -0.010683052241802216,
                    0.004911575932055712,
                    -0.005699658766388893,
                    -0.13171987235546112,
                    -0.02947956882417202,
                    0.062468379735946655,
                    -0.012651552446186543,
                    0.0358673594892025,
                    0.03860306739807129,
                    0.029662901535630226,
                    -0.012262382544577122,
                    -0.01204648893326521,
                    0.005455827806144953,
                    -0.05350634455680847,
                    0.0019041243940591812,
                    -0.06986358761787415,
                    0.009664424695074558,
                    -0.015783939510583878,
                    -0.049439191818237305,
                    -0.012739550322294235,
                    0.0414755642414093,
                    -0.014216817915439606,
                    -0.03144568204879761,
                    0.015606607310473919,
                    -0.00864412635564804,
                    -0.06921525299549103,
                    -0.08073439449071884,
                    -0.039839308708906174,
                    0.023907216265797615,
                    -0.04712303355336189,
                    -0.06198559328913689,
                    -0.028284067288041115,
                    0.03127071633934975,
                    -0.012715128250420094,
                    -0.018253197893500328,
                    -0.039977747946977615,
                    -0.015076813288033009,
                    0.06812983006238937,
                    0.00971513707190752,
                    -0.06701505929231644,
                    -0.019151678308844566,
                    -0.03205821290612221,
                    -0.02942494861781597,
                    -0.04089048132300377,
                    0.02159622125327587,
                    0.03145549073815346,
                    -0.014265504665672779,
                    -0.020057128742337227,
                    -0.02812091074883938,
                    0.043750837445259094,
                    0.0685599073767662,
                    0.025096124038100243,
                    0.07191513478755951,
                    0.072384312748909,
                    -0.037082042545080185,
                    0.04623923823237419,
                    0.019758550450205803,
                    -0.011056150309741497,
                    0.02021791972219944,
                    0.024767989292740822,
                    0.07016528397798538,
                    -0.00824185460805893,
                    0.03694026544690132,
                    -0.05720279738306999,
                    0.06535500288009644,
                    0.006170346867293119,
                    -0.07700438052415848,
                    0.0001956464839167893,
                    -0.022500060498714447,
                    -0.0864025428891182,
                    0.047770868986845016,
                    0.02262771688401699,
                    -0.046468283981084824,
                    -0.024081910029053688,
                    -0.012964446097612381,
                    -0.07415569573640823,
                    -0.0627099797129631,
                    -0.019142186269164085,
                    0.04318845272064209,
                    0.02926771342754364,
                    -0.047851886600255966,
                    -0.01533679198473692,
                    -0.04117163270711899,
                    -0.03911527246236801,
                    0.015261556953191757,
                    0.0990607738494873,
                    -0.03440660983324051,
                    0.12586307525634766,
                    -0.0183604434132576,
                    0.1049143448472023,
                    -0.06163862347602844,
                    -0.009333258494734764,
                    -0.004412154201418161,
                    0.01958736963570118,
                    -0.049681831151247025,
                    0.03633198142051697,
                    0.062209319323301315,
                    -0.013026595115661621,
                    -0.020825469866394997,
                    4.11613546020817e-05,
                    -0.03197794035077095,
                    0.03209464251995087,
                    -0.010043014772236347,
                    0.0016789566725492477,
                    0.0221924539655447,
                    0.03903607651591301,
                    -0.028348227962851524,
                    -0.012639964930713177,
                    0.008550501428544521,
                    0.02782544307410717,
                    -0.011235172860324383,
                    0.013975061476230621,
                    0.004029103089123964,
                    0.05578708276152611,
                    0.056849103420972824,
                    -0.052041176706552505,
                    0.03831476345658302,
                    -0.001219123019836843,
                    -0.14987486600875854,
                    0.058177050203084946,
                    -0.012836071662604809,
                    -0.0436624176800251,
                    0.05640118196606636,
                    -0.11851630359888077,
                    -0.05734905228018761,
                    -0.03272583708167076,
                    0.05062175914645195,
                    0.04145393148064613,
                    -0.028405025601387024,
                    -0.07215059548616409,
                    0.04059039428830147,
                    -0.07189260423183441,
                    0.04959545657038689,
                    -0.02539670467376709,
                    -0.011271349154412746,
                    0.0007080249488353729,
                    0.1311703324317932,
                    0.0602717362344265,
                    -0.0394776351749897,
                    -0.0328383632004261,
                    0.02152927778661251,
                    0.013761769980192184,
                    -0.09908115118741989,
                    0.05248456075787544,
                    -0.0630236342549324,
                    -0.0290217325091362,
                    -0.018857179209589958,
                    -0.04968373849987984,
                    0.050313759595155716,
                    -0.014766346663236618,
                    -0.03059941716492176,
                    0.042801279574632645,
                    0.09874135255813599,
                    0.050834815949201584,
                    -0.0919344499707222,
                    0.049581632018089294,
                    -0.017964420840144157,
                    -0.01676558144390583,
                    0.0807592049241066,
                    -0.025710294023156166,
                    0.07926595211029053,
                    0.029242249205708504,
                    0.004587305709719658,
                    -0.054740164428949356,
                    0.009878226555883884,
                    0.04632550850510597,
                    -0.09200546890497208,
                    0.009077080525457859,
                    0.08475533127784729,
                    -0.12129024416208267,
                    -0.049987003207206726,
                    0.06230976805090904,
                    -0.031542401760816574,
                    0.023314690217375755,
                    -0.030894242227077484,
                    0.05209727585315704,
                    0.0794076919555664,
                    0.04986393824219704,
                    -0.007168104872107506,
                    -0.07380069047212601
                ],
                "report_type": "Use-of-uninitialized-value",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 9907,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36043"
            }
        },
        "relation1": {
            "identity": 20416,
            "start": 9907,
            "end": 4496,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 4496,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "fuzz / bitstream bug: squeezing meta-channnels\n",
                "sha": "84c6421732054399e9b8046f1cdf2e999dbaaab2",
                "repo": "libjxl",
                "encoding": "UTF-8",
                "authored_date": 1626637564,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1626852435
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 9907,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36043"
            }
        },
        "relation1": {
            "identity": 20415,
            "start": 9907,
            "end": 4494,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 4494,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Refactor ConvertToExternal to use an array of ImageF* (#338)\n\nThe new `ConvertChannelsToExternal` uses a list of channels (ImageF*)\r\ninstead of repeating the logic of deciding which channels to include\r\nin every lambda. This should make it easier to include a function to\r\nconvert extra channels.\r\n\r\nIn x86, this makes dec_external_image.o .text about 600 bytes smaller.",
                "sha": "518691a3646e830d7daf0492966f24bc44e32912",
                "repo": "libjxl",
                "encoding": "UTF-8",
                "authored_date": 1626813361,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1626813361
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]