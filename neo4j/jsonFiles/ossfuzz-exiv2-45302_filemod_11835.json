[
    {
        "baseNode": {
            "identity": 11828,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-exiv2-45302"
            }
        },
        "relation1": {
            "identity": 24598,
            "start": 11828,
            "end": 11835,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11835,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    -0.046667858958244324,
                    -0.05854853242635727,
                    -0.11618591099977493,
                    0.029636835679411888,
                    -0.006589849479496479,
                    0.01563315838575363,
                    -0.051960885524749756,
                    0.062295734882354736,
                    -0.014045157469809055,
                    -0.06005275622010231,
                    0.0068583921529352665,
                    0.09944192320108414,
                    -0.14885208010673523,
                    0.0057266391813755035,
                    0.053547453135252,
                    -0.034343235194683075,
                    0.04063238203525543,
                    -0.07457543909549713,
                    -0.04303150996565819,
                    -0.022984527051448822,
                    -0.01724943518638611,
                    -0.01917724311351776,
                    -0.056486815214157104,
                    0.046321235597133636,
                    0.03012659028172493,
                    0.012217697687447071,
                    0.017907965928316116,
                    0.020689187571406364,
                    -0.025993449613451958,
                    -0.04975825175642967,
                    -0.05214794725179672,
                    -0.08214215189218521,
                    0.03763376548886299,
                    -0.004755348898470402,
                    0.007753489073365927,
                    0.004189260303974152,
                    0.0013642478734254837,
                    0.02508712373673916,
                    0.005637805908918381,
                    0.07730397582054138,
                    -0.09599509835243225,
                    -0.1352931261062622,
                    0.07967042922973633,
                    -0.0007403353229165077,
                    -0.07828671485185623,
                    0.004187621176242828,
                    -0.04946279525756836,
                    -0.07441186904907227,
                    -0.011094159446656704,
                    0.05056694149971008,
                    -0.032484270632267,
                    0.04669241979718208,
                    -0.09592658281326294,
                    -0.03163636848330498,
                    -0.02313109114766121,
                    0.0677797794342041,
                    -0.019437162205576897,
                    -0.02760017104446888,
                    -0.057891931384801865,
                    0.09619395434856415,
                    -0.07427828013896942,
                    -0.11412907391786575,
                    0.04512752965092659,
                    0.013440664857625961,
                    0.007961641997098923,
                    0.05883338302373886,
                    0.07820871472358704,
                    -0.030165202915668488,
                    0.06411071866750717,
                    0.02778015099465847,
                    0.08203445374965668,
                    0.07994367182254791,
                    -0.05175072327256203,
                    -0.05073938146233559,
                    0.02504757046699524,
                    0.024603772908449173,
                    -0.058850161731243134,
                    -0.12601317465305328,
                    0.0450000986456871,
                    -0.001759316772222519,
                    -0.019134201109409332,
                    0.017781047150492668,
                    -0.01738659106194973,
                    -0.03623129427433014,
                    0.04543841630220413,
                    -0.0105958953499794,
                    0.0400845929980278,
                    -0.039224423468112946,
                    0.05767130106687546,
                    0.03378675505518913,
                    0.033071499317884445,
                    -0.13542123138904572,
                    0.07167929410934448,
                    -0.12337034940719604,
                    -0.057414937764406204,
                    0.049173906445503235,
                    -0.01825357973575592,
                    -0.07542116194963455,
                    -0.01666766218841076,
                    0.010608591139316559,
                    -0.01904730126261711,
                    -0.0545918345451355,
                    -0.012678956612944603,
                    -0.08798494935035706,
                    -0.03291105106472969,
                    0.0019522812217473984,
                    -0.1214398518204689,
                    -0.011888219974935055,
                    0.0005397379864007235,
                    -0.011947603896260262,
                    -0.0459173284471035,
                    0.07362855970859528,
                    0.02849988266825676,
                    -0.0037346621975302696,
                    -0.00943327322602272,
                    -0.010991164483129978,
                    -0.01052679494023323,
                    0.0057081663981080055,
                    -0.016346685588359833,
                    0.02047796919941902,
                    0.10487711429595947,
                    0.005110747646540403,
                    0.019191745668649673,
                    0.03479500487446785,
                    0.005811193026602268,
                    0.05854093283414841,
                    -0.01745085045695305,
                    -0.021365320309996605,
                    0.12112079560756683,
                    0.08433462679386139,
                    0.0013170158490538597,
                    -0.017368514090776443,
                    0.01648431271314621,
                    -0.008371732197701931,
                    -0.09296692907810211,
                    0.0031701354309916496,
                    0.07816905528306961,
                    0.04561551287770271,
                    0.053939588367938995,
                    0.03017973154783249,
                    0.044151850044727325,
                    0.08678467571735382,
                    0.043510545045137405,
                    0.15540367364883423,
                    -0.022768717259168625,
                    -0.04699494689702988,
                    0.004147564526647329,
                    0.0438847616314888,
                    -0.07032855600118637,
                    -0.0577692873775959,
                    0.0008881259709596634,
                    -0.017749590799212456,
                    -0.05575988069176674,
                    -0.013179521076381207,
                    0.0987577885389328,
                    0.042513407766819,
                    -0.023087983950972557,
                    0.01073439884930849,
                    -0.010004108771681786,
                    0.034823112189769745,
                    -0.019911935552954674,
                    0.09759476780891418,
                    0.020156558603048325,
                    0.14604966342449188,
                    0.12175128608942032,
                    0.04753900319337845,
                    0.020777210593223572,
                    -0.03606465831398964,
                    -0.0638444796204567,
                    -0.00017319247126579285,
                    -0.027088508009910583,
                    0.11696621030569077,
                    -0.0091033224016428,
                    -0.02070288546383381,
                    0.04668521136045456,
                    -0.046839639544487,
                    0.004291302524507046,
                    0.035885125398635864,
                    -0.012900600209832191,
                    -0.06026947498321533,
                    -0.06380538642406464,
                    -0.0065703485161066055,
                    -0.054341353476047516,
                    -0.10650613158941269,
                    0.022464338690042496,
                    0.017839282751083374,
                    -0.028538525104522705,
                    -0.06589330732822418,
                    -0.035899095237255096,
                    -0.01889723911881447,
                    0.0871272161602974,
                    -0.022879892960190773,
                    0.141916424036026,
                    0.007736708037555218,
                    -0.011868108063936234,
                    0.03409513086080551,
                    -0.08610004186630249,
                    0.0346289798617363,
                    -0.08828529715538025,
                    -0.07357683777809143,
                    0.05901850014925003,
                    0.016686690971255302,
                    0.03451388329267502,
                    -0.00979591254144907,
                    -0.06460050493478775,
                    -0.020935483276844025,
                    0.06180128827691078,
                    -0.03783290088176727,
                    0.035812102258205414,
                    -0.0005705785006284714,
                    0.09925387799739838,
                    -0.011103741824626923,
                    0.04051472991704941,
                    0.051171429455280304,
                    -0.05367213115096092,
                    0.08113403618335724,
                    -0.031686775386333466,
                    0.05838533490896225,
                    -0.044600628316402435,
                    -0.035068415105342865,
                    0.0046516302973032,
                    -0.005434183403849602,
                    -0.04681142419576645,
                    -0.05834052711725235,
                    0.058041833341121674,
                    -0.04110407829284668,
                    -0.027125589549541473,
                    0.03258875757455826,
                    0.10076655447483063,
                    0.02085069939494133,
                    0.007125081494450569,
                    0.03471517935395241,
                    -0.04258909076452255,
                    -0.04426392912864685,
                    0.023078404366970062,
                    -0.09025433659553528,
                    -0.05053502321243286,
                    0.06848307698965073,
                    -0.01856343075633049,
                    -0.04164592921733856,
                    -0.025616822764277458,
                    0.0012929495424032211,
                    -0.06379841268062592,
                    -0.013068683445453644,
                    0.020271701738238335,
                    -0.04813391715288162,
                    0.006561375223100185,
                    0.12271074205636978,
                    0.0031807762570679188,
                    0.013889860361814499,
                    -0.0425405278801918,
                    -0.04587801545858383,
                    0.05184811353683472,
                    0.04953618720173836,
                    -0.10484795272350311,
                    -0.08898508548736572
                ],
                "diffText": "diff --git a/src/jpgimage.cpp b/src/jpgimage.cpp\nindex 01b22f33d..efe0050d6 100644\n--- a/src/jpgimage.cpp\n+++ b/src/jpgimage.cpp\n@@ -178,18 +178,21 @@ DataBuf Photoshop::setIptcIrb(const byte* pPsData, size_t sizePsData, const Iptc\n   // Write existing stuff after record,\n   // skip the current and all remaining IPTC blocks\n   size_t pos = sizeFront;\n-  while (0 == Photoshop::locateIptcIrb(pPsData + pos, sizePsData - pos, &record, &sizeHdr, &sizeIptc)) {\n+  long nextSizeData = Safe::add<long>(static_cast<long>(sizePsData), -static_cast<long>(pos));\n+  enforce(nextSizeData >= 0, ErrorCode::kerCorruptedMetadata);\n+  while (0 == Photoshop::locateIptcIrb(pPsData + pos, nextSizeData, &record, &sizeHdr, &sizeIptc)) {\n     const auto newPos = static_cast<size_t>(record - pPsData);\n-    // Copy data up to the IPTC IRB\n-    if (newPos > pos) {\n+    if (newPos > pos) {  // Copy data up to the IPTC IRB\n       append(psBlob, pPsData + pos, newPos - pos);\n     }\n-    // Skip the IPTC IRB\n-    pos = newPos + sizeHdr + sizeIptc + (sizeIptc & 1);\n+    pos = newPos + sizeHdr + sizeIptc + (sizeIptc & 1);  // Skip the IPTC IRB\n+    nextSizeData = Safe::add<long>(static_cast<long>(sizePsData), -static_cast<long>(pos));\n+    enforce(nextSizeData >= 0, ErrorCode::kerCorruptedMetadata);\n   }\n   if (pos < sizePsData) {\n     append(psBlob, pPsData + pos, sizePsData - pos);\n   }\n+\n   // Data is rounded to be even\n   if (!psBlob.empty())\n     rc = DataBuf(&psBlob[0], psBlob.size());"
            }
        },
        "relation2": {
            "identity": 24598,
            "start": 11835,
            "end": 11828,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 11828,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-exiv2-45302"
            }
        }
    },
    {
        "baseNode": {
            "identity": 11828,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-exiv2-45302"
            }
        },
        "relation1": {
            "identity": 24598,
            "start": 11828,
            "end": 11835,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11835,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    -0.046667858958244324,
                    -0.05854853242635727,
                    -0.11618591099977493,
                    0.029636835679411888,
                    -0.006589849479496479,
                    0.01563315838575363,
                    -0.051960885524749756,
                    0.062295734882354736,
                    -0.014045157469809055,
                    -0.06005275622010231,
                    0.0068583921529352665,
                    0.09944192320108414,
                    -0.14885208010673523,
                    0.0057266391813755035,
                    0.053547453135252,
                    -0.034343235194683075,
                    0.04063238203525543,
                    -0.07457543909549713,
                    -0.04303150996565819,
                    -0.022984527051448822,
                    -0.01724943518638611,
                    -0.01917724311351776,
                    -0.056486815214157104,
                    0.046321235597133636,
                    0.03012659028172493,
                    0.012217697687447071,
                    0.017907965928316116,
                    0.020689187571406364,
                    -0.025993449613451958,
                    -0.04975825175642967,
                    -0.05214794725179672,
                    -0.08214215189218521,
                    0.03763376548886299,
                    -0.004755348898470402,
                    0.007753489073365927,
                    0.004189260303974152,
                    0.0013642478734254837,
                    0.02508712373673916,
                    0.005637805908918381,
                    0.07730397582054138,
                    -0.09599509835243225,
                    -0.1352931261062622,
                    0.07967042922973633,
                    -0.0007403353229165077,
                    -0.07828671485185623,
                    0.004187621176242828,
                    -0.04946279525756836,
                    -0.07441186904907227,
                    -0.011094159446656704,
                    0.05056694149971008,
                    -0.032484270632267,
                    0.04669241979718208,
                    -0.09592658281326294,
                    -0.03163636848330498,
                    -0.02313109114766121,
                    0.0677797794342041,
                    -0.019437162205576897,
                    -0.02760017104446888,
                    -0.057891931384801865,
                    0.09619395434856415,
                    -0.07427828013896942,
                    -0.11412907391786575,
                    0.04512752965092659,
                    0.013440664857625961,
                    0.007961641997098923,
                    0.05883338302373886,
                    0.07820871472358704,
                    -0.030165202915668488,
                    0.06411071866750717,
                    0.02778015099465847,
                    0.08203445374965668,
                    0.07994367182254791,
                    -0.05175072327256203,
                    -0.05073938146233559,
                    0.02504757046699524,
                    0.024603772908449173,
                    -0.058850161731243134,
                    -0.12601317465305328,
                    0.0450000986456871,
                    -0.001759316772222519,
                    -0.019134201109409332,
                    0.017781047150492668,
                    -0.01738659106194973,
                    -0.03623129427433014,
                    0.04543841630220413,
                    -0.0105958953499794,
                    0.0400845929980278,
                    -0.039224423468112946,
                    0.05767130106687546,
                    0.03378675505518913,
                    0.033071499317884445,
                    -0.13542123138904572,
                    0.07167929410934448,
                    -0.12337034940719604,
                    -0.057414937764406204,
                    0.049173906445503235,
                    -0.01825357973575592,
                    -0.07542116194963455,
                    -0.01666766218841076,
                    0.010608591139316559,
                    -0.01904730126261711,
                    -0.0545918345451355,
                    -0.012678956612944603,
                    -0.08798494935035706,
                    -0.03291105106472969,
                    0.0019522812217473984,
                    -0.1214398518204689,
                    -0.011888219974935055,
                    0.0005397379864007235,
                    -0.011947603896260262,
                    -0.0459173284471035,
                    0.07362855970859528,
                    0.02849988266825676,
                    -0.0037346621975302696,
                    -0.00943327322602272,
                    -0.010991164483129978,
                    -0.01052679494023323,
                    0.0057081663981080055,
                    -0.016346685588359833,
                    0.02047796919941902,
                    0.10487711429595947,
                    0.005110747646540403,
                    0.019191745668649673,
                    0.03479500487446785,
                    0.005811193026602268,
                    0.05854093283414841,
                    -0.01745085045695305,
                    -0.021365320309996605,
                    0.12112079560756683,
                    0.08433462679386139,
                    0.0013170158490538597,
                    -0.017368514090776443,
                    0.01648431271314621,
                    -0.008371732197701931,
                    -0.09296692907810211,
                    0.0031701354309916496,
                    0.07816905528306961,
                    0.04561551287770271,
                    0.053939588367938995,
                    0.03017973154783249,
                    0.044151850044727325,
                    0.08678467571735382,
                    0.043510545045137405,
                    0.15540367364883423,
                    -0.022768717259168625,
                    -0.04699494689702988,
                    0.004147564526647329,
                    0.0438847616314888,
                    -0.07032855600118637,
                    -0.0577692873775959,
                    0.0008881259709596634,
                    -0.017749590799212456,
                    -0.05575988069176674,
                    -0.013179521076381207,
                    0.0987577885389328,
                    0.042513407766819,
                    -0.023087983950972557,
                    0.01073439884930849,
                    -0.010004108771681786,
                    0.034823112189769745,
                    -0.019911935552954674,
                    0.09759476780891418,
                    0.020156558603048325,
                    0.14604966342449188,
                    0.12175128608942032,
                    0.04753900319337845,
                    0.020777210593223572,
                    -0.03606465831398964,
                    -0.0638444796204567,
                    -0.00017319247126579285,
                    -0.027088508009910583,
                    0.11696621030569077,
                    -0.0091033224016428,
                    -0.02070288546383381,
                    0.04668521136045456,
                    -0.046839639544487,
                    0.004291302524507046,
                    0.035885125398635864,
                    -0.012900600209832191,
                    -0.06026947498321533,
                    -0.06380538642406464,
                    -0.0065703485161066055,
                    -0.054341353476047516,
                    -0.10650613158941269,
                    0.022464338690042496,
                    0.017839282751083374,
                    -0.028538525104522705,
                    -0.06589330732822418,
                    -0.035899095237255096,
                    -0.01889723911881447,
                    0.0871272161602974,
                    -0.022879892960190773,
                    0.141916424036026,
                    0.007736708037555218,
                    -0.011868108063936234,
                    0.03409513086080551,
                    -0.08610004186630249,
                    0.0346289798617363,
                    -0.08828529715538025,
                    -0.07357683777809143,
                    0.05901850014925003,
                    0.016686690971255302,
                    0.03451388329267502,
                    -0.00979591254144907,
                    -0.06460050493478775,
                    -0.020935483276844025,
                    0.06180128827691078,
                    -0.03783290088176727,
                    0.035812102258205414,
                    -0.0005705785006284714,
                    0.09925387799739838,
                    -0.011103741824626923,
                    0.04051472991704941,
                    0.051171429455280304,
                    -0.05367213115096092,
                    0.08113403618335724,
                    -0.031686775386333466,
                    0.05838533490896225,
                    -0.044600628316402435,
                    -0.035068415105342865,
                    0.0046516302973032,
                    -0.005434183403849602,
                    -0.04681142419576645,
                    -0.05834052711725235,
                    0.058041833341121674,
                    -0.04110407829284668,
                    -0.027125589549541473,
                    0.03258875757455826,
                    0.10076655447483063,
                    0.02085069939494133,
                    0.007125081494450569,
                    0.03471517935395241,
                    -0.04258909076452255,
                    -0.04426392912864685,
                    0.023078404366970062,
                    -0.09025433659553528,
                    -0.05053502321243286,
                    0.06848307698965073,
                    -0.01856343075633049,
                    -0.04164592921733856,
                    -0.025616822764277458,
                    0.0012929495424032211,
                    -0.06379841268062592,
                    -0.013068683445453644,
                    0.020271701738238335,
                    -0.04813391715288162,
                    0.006561375223100185,
                    0.12271074205636978,
                    0.0031807762570679188,
                    0.013889860361814499,
                    -0.0425405278801918,
                    -0.04587801545858383,
                    0.05184811353683472,
                    0.04953618720173836,
                    -0.10484795272350311,
                    -0.08898508548736572
                ],
                "diffText": "diff --git a/src/jpgimage.cpp b/src/jpgimage.cpp\nindex 01b22f33d..efe0050d6 100644\n--- a/src/jpgimage.cpp\n+++ b/src/jpgimage.cpp\n@@ -178,18 +178,21 @@ DataBuf Photoshop::setIptcIrb(const byte* pPsData, size_t sizePsData, const Iptc\n   // Write existing stuff after record,\n   // skip the current and all remaining IPTC blocks\n   size_t pos = sizeFront;\n-  while (0 == Photoshop::locateIptcIrb(pPsData + pos, sizePsData - pos, &record, &sizeHdr, &sizeIptc)) {\n+  long nextSizeData = Safe::add<long>(static_cast<long>(sizePsData), -static_cast<long>(pos));\n+  enforce(nextSizeData >= 0, ErrorCode::kerCorruptedMetadata);\n+  while (0 == Photoshop::locateIptcIrb(pPsData + pos, nextSizeData, &record, &sizeHdr, &sizeIptc)) {\n     const auto newPos = static_cast<size_t>(record - pPsData);\n-    // Copy data up to the IPTC IRB\n-    if (newPos > pos) {\n+    if (newPos > pos) {  // Copy data up to the IPTC IRB\n       append(psBlob, pPsData + pos, newPos - pos);\n     }\n-    // Skip the IPTC IRB\n-    pos = newPos + sizeHdr + sizeIptc + (sizeIptc & 1);\n+    pos = newPos + sizeHdr + sizeIptc + (sizeIptc & 1);  // Skip the IPTC IRB\n+    nextSizeData = Safe::add<long>(static_cast<long>(sizePsData), -static_cast<long>(pos));\n+    enforce(nextSizeData >= 0, ErrorCode::kerCorruptedMetadata);\n   }\n   if (pos < sizePsData) {\n     append(psBlob, pPsData + pos, sizePsData - pos);\n   }\n+\n   // Data is rounded to be even\n   if (!psBlob.empty())\n     rc = DataBuf(&psBlob[0], psBlob.size());"
            }
        },
        "relation2": {
            "identity": 24597,
            "start": 11835,
            "end": 11834,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 11834,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "src/jpgimage.cpp"
            }
        }
    },
    {
        "baseNode": {
            "identity": 11828,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-exiv2-45302"
            }
        },
        "relation1": {
            "identity": 24594,
            "start": 11828,
            "end": 5760,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 5760,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "exiv2"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11828,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-exiv2-45302"
            }
        },
        "relation1": {
            "identity": 24593,
            "start": 11828,
            "end": 11833,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11833,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "INFO: Running with entropic power schedule (0xFF, 100).\nINFO: Seed: 898434060\nINFO: Loaded 1 modules   (54715 inline 8-bit counters): 54715 [0xeac5d0, 0xeb9b8b), \nINFO: Loaded 1 PC tables (54715 PCs): 54715 [0xeb9b90,0xf8f740), \n/out/fuzz-read-print-write: Running 1 inputs 1 time(s) each.\nRunning: /tmp/poc\n=================================================================\n==1==ERROR: AddressSanitizer: container-overflow on address 0x63100003c88e at pc 0x0000004bf6d6 bp 0x7fff262d02e0 sp 0x7fff262cfa88\nREAD of size 4 at 0x63100003c88e thread T0\nSCARINESS: 17 (4-byte-read-container-overflow)\n    #0 0x4bf6d5 in MemcmpInterceptorCommon(void*, int (*)(void const*, void const*, unsigned long), void const*, void const*, unsigned long) /src/llvm-project/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:860:7\n    #1 0x4bfbc9 in memcmp /src/llvm-project/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:892:10\n    #2 0x5f39b9 in isIrb /src/exiv2/src/jpgimage.cpp:53:17\n    #3 0x5f39b9 in Exiv2::Photoshop::locateIrb(unsigned char const*, unsigned long, unsigned short, unsigned char const**, unsigned int*, unsigned int*) /src/exiv2/src/jpgimage.cpp:97:47\n    #4 0x5f4315 in locateIptcIrb /src/exiv2/src/jpgimage.cpp:164:16\n    #5 0x5f4315 in Exiv2::Photoshop::setIptcIrb(unsigned char const*, unsigned long, Exiv2::IptcData const&) /src/exiv2/src/jpgimage.cpp:219:21\n    #6 0x60242b in Exiv2::JpegBase::doWriteMetadata(Exiv2::BasicIo&) /src/exiv2/src/jpgimage.cpp:1074:41\n    #7 0x5ff1b8 in Exiv2::JpegBase::writeMetadata() /src/exiv2/src/jpgimage.cpp:796:9\n    #8 0x5606e0 in LLVMFuzzerTestOneInput /src/exiv2/fuzz/fuzz-read-print-write.cpp:44:12\n    #9 0x4573f2 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15\n    #10 0x4430c2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6\n    #11 0x4488fb in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9\n    #12 0x471402 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #13 0x7fb37f5a5082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)\n    #14 0x4219ed in _start (/out/fuzz-read-print-write+0x4219ed)\n\nDEDUP_TOKEN: MemcmpInterceptorCommon(void*, int (*)(void const*, void const*, unsigned long), void const*, void const*, unsigned long)--memcmp--isIrb\n0x63100003c88e is located 142 bytes inside of 65536-byte region [0x63100003c800,0x63100004c800)\nallocated by thread T0 here:\n    #0 0x55d43d in operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:95:3\n    #1 0x5cc6bb in __libcpp_operator_new<unsigned long> /usr/local/bin/../include/c++/v1/new:245:10\n    #2 0x5cc6bb in __libcpp_allocate /usr/local/bin/../include/c++/v1/new:271:10\n    #3 0x5cc6bb in allocate /usr/local/bin/../include/c++/v1/__memory/allocator.h:105:38\n    #4 0x5cc6bb in allocate /usr/local/bin/../include/c++/v1/__memory/allocator_traits.h:262:20\n    #5 0x5cc6bb in __split_buffer /usr/local/bin/../include/c++/v1/__split_buffer:306:29\n    #6 0x5cc6bb in std::__1::vector<unsigned char, std::__1::allocator<unsigned char> >::reserve(unsigned long) /usr/local/bin/../include/c++/v1/vector:1596:53\n    #7 0x5cc368 in Exiv2::append(std::__1::vector<unsigned char, std::__1::allocator<unsigned char> >&, unsigned char const*, unsigned long) /src/exiv2/src/image.cpp:928:22\n    #8 0x60071b in Exiv2::JpegBase::doWriteMetadata(Exiv2::BasicIo&) /src/exiv2/src/jpgimage.cpp:905:17\n    #9 0x5ff1b8 in Exiv2::JpegBase::writeMetadata() /src/exiv2/src/jpgimage.cpp:796:9\n    #10 0x5606e0 in LLVMFuzzerTestOneInput /src/exiv2/fuzz/fuzz-read-print-write.cpp:44:12\n    #11 0x4573f2 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15\n    #12 0x4430c2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6\n    #13 0x4488fb in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9\n    #14 0x471402 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #15 0x7fb37f5a5082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)\n\nDEDUP_TOKEN: operator new(unsigned long)--__libcpp_operator_new<unsigned long>--__libcpp_allocate\nHINT: if you don't care about these errors you may set ASAN_OPTIONS=detect_container_overflow=0.\nIf you suspect a false positive see also: https://github.com/google/sanitizers/wiki/AddressSanitizerContainerOverflow.\nSUMMARY: AddressSanitizer: container-overflow /src/llvm-project/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:860:7 in MemcmpInterceptorCommon(void*, int (*)(void const*, void const*, unsigned long), void const*, void const*, unsigned long)\nShadow bytes around the buggy address:\n  0x0c627ffff8c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c627ffff8d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c627ffff8e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c627ffff8f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c627ffff900: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=>0x0c627ffff910: 00[05]fc fc fc fc fc fc fc fc fc fc fc fc fc fc\n  0x0c627ffff920: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc\n  0x0c627ffff930: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc\n  0x0c627ffff940: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc\n  0x0c627ffff950: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc\n  0x0c627ffff960: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.03714151307940483,
                    0.04638292267918587,
                    -0.070126011967659,
                    0.01446603611111641,
                    0.006511196494102478,
                    -0.005019797943532467,
                    -0.032999586313962936,
                    0.022490939125418663,
                    0.04544473811984062,
                    -0.07023439556360245,
                    -0.01928422600030899,
                    0.000958464399445802,
                    -0.02348882518708706,
                    0.007428742945194244,
                    0.04871204495429993,
                    -0.020026199519634247,
                    0.11326871067285538,
                    0.07660174369812012,
                    0.016929857432842255,
                    0.036686863750219345,
                    -0.05312434956431389,
                    0.039939746260643005,
                    -0.03885628655552864,
                    0.0019819168373942375,
                    -0.006081482861191034,
                    -0.01713188923895359,
                    -0.08394632488489151,
                    -0.014857451431453228,
                    -0.03421461209654808,
                    -0.030485430732369423,
                    -0.11027780920267105,
                    -0.1616619974374771,
                    -0.033567529171705246,
                    0.0005148747004568577,
                    -0.04769572615623474,
                    -0.024219587445259094,
                    -0.024379586800932884,
                    -0.01328826230019331,
                    0.027057534083724022,
                    0.089495949447155,
                    -0.05053134635090828,
                    -0.07772838324308395,
                    0.003689434612169862,
                    0.017411641776561737,
                    -0.0649164691567421,
                    0.0368533581495285,
                    0.011084388010203838,
                    -0.03841455280780792,
                    0.011370587162673473,
                    0.010416962206363678,
                    -0.09786484390497208,
                    -0.01557179819792509,
                    -0.05522354319691658,
                    -0.03193899616599083,
                    -0.05693797767162323,
                    -0.03478539362549782,
                    0.020123325288295746,
                    0.06511066108942032,
                    -0.04889164865016937,
                    0.09142724424600601,
                    0.005437952931970358,
                    -0.03033146820962429,
                    0.01807720586657524,
                    -0.020079344511032104,
                    -0.02043175883591175,
                    0.0038569618482142687,
                    0.10151121765375137,
                    0.027540579438209534,
                    0.00754736689850688,
                    -0.026856495067477226,
                    0.0410919152200222,
                    0.16651637852191925,
                    -0.09743555635213852,
                    -0.12417969852685928,
                    -0.028329411521553993,
                    0.0358814112842083,
                    -0.026619382202625275,
                    0.010439667850732803,
                    -0.05248686298727989,
                    -0.11135205626487732,
                    -0.05795098841190338,
                    0.03684428706765175,
                    0.002232632366940379,
                    0.04377096891403198,
                    0.04087246209383011,
                    0.017087770625948906,
                    0.013179589062929153,
                    -0.040647994726896286,
                    0.007638769224286079,
                    0.012128855101764202,
                    0.013362561352550983,
                    -0.09120640158653259,
                    -0.02699289657175541,
                    -0.058859068900346756,
                    -0.015154552645981312,
                    0.028278760612010956,
                    0.02434057928621769,
                    -0.01202510017901659,
                    -0.04030404984951019,
                    0.0005895768408663571,
                    -0.035549186170101166,
                    -0.06783837825059891,
                    -0.027590250596404076,
                    -0.07261372357606888,
                    -0.02379358373582363,
                    -0.0002605734916869551,
                    -0.058893512934446335,
                    -0.016888780519366264,
                    -0.0024849537294358015,
                    -0.018140850588679314,
                    -0.01990201510488987,
                    -0.020870685577392578,
                    -0.012857341207563877,
                    0.061589568853378296,
                    0.050832029432058334,
                    -0.049949463456869125,
                    -0.03276063874363899,
                    -0.044822171330451965,
                    0.01984073780477047,
                    0.028682513162493706,
                    0.02816246636211872,
                    -0.009459470398724079,
                    -0.02126035839319229,
                    -0.0061464193277060986,
                    0.003234942676499486,
                    0.009780049324035645,
                    0.035603951662778854,
                    0.06449897587299347,
                    0.06180214881896973,
                    0.056795913726091385,
                    -0.008576598018407822,
                    0.03739849105477333,
                    0.04680684208869934,
                    0.009853197261691093,
                    -0.029752636328339577,
                    0.01689961738884449,
                    0.06739408522844315,
                    -0.003988325130194426,
                    0.013544443063437939,
                    -0.02864699624478817,
                    0.017919013276696205,
                    0.044597167521715164,
                    -0.05029325559735298,
                    -0.03199543431401253,
                    0.046562228351831436,
                    -0.07590099424123764,
                    0.016286537051200867,
                    0.026301652193069458,
                    -0.029569149017333984,
                    -0.010206013917922974,
                    -0.008934629149734974,
                    -0.025593822821974754,
                    -0.10331516712903976,
                    -0.045295100659132004,
                    0.03557842969894409,
                    -0.00740711810067296,
                    -0.019423024728894234,
                    0.00626983679831028,
                    -0.04301753267645836,
                    -0.012383566237986088,
                    -0.00925187673419714,
                    0.12202014774084091,
                    0.0145004503428936,
                    0.08966788649559021,
                    -0.024844812229275703,
                    0.07494794577360153,
                    -0.023050105199217796,
                    -0.0070322309620678425,
                    -0.011708072386682034,
                    -0.018739741295576096,
                    -0.026331646367907524,
                    0.017620069906115532,
                    0.015093743801116943,
                    -0.002213005907833576,
                    -0.009602785110473633,
                    0.0044428943656384945,
                    -0.005210466682910919,
                    0.04491226375102997,
                    0.03951115906238556,
                    0.03044159710407257,
                    0.04243336245417595,
                    0.05845421180129051,
                    -0.03219548240303993,
                    -0.03877591714262962,
                    0.017557451501488686,
                    0.014321241527795792,
                    -0.05917354300618172,
                    -0.015630332753062248,
                    -0.025259127840399742,
                    0.007309467066079378,
                    0.038768280297517776,
                    -0.04039033502340317,
                    0.053641434758901596,
                    -0.0016965372487902641,
                    -0.10029497742652893,
                    0.004450121894478798,
                    0.020588168874382973,
                    0.051216766238212585,
                    0.008024012669920921,
                    -0.1301461011171341,
                    -0.018749935552477837,
                    -0.005460505839437246,
                    0.09146595746278763,
                    -0.031642161309719086,
                    0.029608169570565224,
                    -0.05017637088894844,
                    0.04884004592895508,
                    -0.01603253185749054,
                    0.06439993530511856,
                    -0.05848248675465584,
                    0.012407192029058933,
                    0.02805892936885357,
                    0.09912717342376709,
                    0.0587138831615448,
                    -0.020487098023295403,
                    -0.03704157471656799,
                    0.025502687320113182,
                    -0.006586600560694933,
                    -0.08306988328695297,
                    0.0446186400949955,
                    -0.061674538999795914,
                    -0.05105893313884735,
                    -0.07874035835266113,
                    -0.05409843102097511,
                    0.06085348501801491,
                    -0.04408840462565422,
                    -0.029164491221308708,
                    0.07001972198486328,
                    0.0544462613761425,
                    0.038571666926145554,
                    -0.035763245075941086,
                    -0.003708364674821496,
                    0.0018066465854644775,
                    0.013000058941543102,
                    -0.01819799654185772,
                    0.0035025719553232193,
                    0.07582885771989822,
                    0.05315199866890907,
                    -0.01821199618279934,
                    -0.029409991577267647,
                    0.010768783278763294,
                    0.019282929599285126,
                    -0.018354617059230804,
                    -0.039214979857206345,
                    0.10542111843824387,
                    -0.09191412478685379,
                    -0.053750067949295044,
                    0.04599140211939812,
                    0.0021697371266782284,
                    0.010144426487386227,
                    -0.035275015980005264,
                    -0.0021631561685353518,
                    0.06817981600761414,
                    0.012045896612107754,
                    -0.0009486880153417587,
                    -0.023571012541651726
                ],
                "report_type": "Container-overflow READ 4",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11828,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-exiv2-45302"
            }
        },
        "relation1": {
            "identity": 24592,
            "start": 11828,
            "end": 11832,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11832,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Fix integer overflow #2179\n",
                "sha": "e715243aa51fa38a89d35ea377d267600217e192",
                "repo": "exiv2",
                "encoding": "UTF-8",
                "authored_date": 1648746779,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1649251122
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11828,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-exiv2-45302"
            }
        },
        "relation1": {
            "identity": 24586,
            "start": 11828,
            "end": 11829,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11829,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Merge pull request #2177 from neheb/1\n\nclang-tidy and manual stuff",
                "sha": "6e9eca445aa6fffa308e30fcf0168cb28c106a70",
                "repo": "exiv2",
                "encoding": "UTF-8",
                "authored_date": 1649249613,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1649249613
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]