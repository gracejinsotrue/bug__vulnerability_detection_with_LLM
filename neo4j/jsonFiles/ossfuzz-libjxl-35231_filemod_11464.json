[
    {
        "baseNode": {
            "identity": 11459,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-35231"
            }
        },
        "relation1": {
            "identity": 23789,
            "start": 11459,
            "end": 11464,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11464,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    -0.0013718114932999015,
                    -0.05793771147727966,
                    -0.15904155373573303,
                    0.07697957009077072,
                    -0.02609342895448208,
                    0.04410587251186371,
                    -0.09143638610839844,
                    0.06535353511571884,
                    0.029238702729344368,
                    -0.01603313907980919,
                    0.016626713797450066,
                    -0.03828949108719826,
                    -0.03871762380003929,
                    -0.037243328988552094,
                    0.020130585879087448,
                    -0.03407441824674606,
                    0.13180024921894073,
                    -0.06936666369438171,
                    -0.026045287027955055,
                    0.1214178204536438,
                    -0.10663117468357086,
                    0.0025721220299601555,
                    -0.07456730306148529,
                    0.019595803692936897,
                    0.04785778000950813,
                    0.09904441982507706,
                    -0.08990442007780075,
                    -0.03864980861544609,
                    -0.04002002999186516,
                    -0.037804655730724335,
                    -0.15709662437438965,
                    -0.08484092354774475,
                    0.08225949853658676,
                    0.034198399633169174,
                    -0.010214274749159813,
                    0.036806557327508926,
                    0.021466106176376343,
                    -0.05164160951972008,
                    -0.030838653445243835,
                    0.06719716638326645,
                    -0.09258639812469482,
                    -0.0581420361995697,
                    0.013670168817043304,
                    -0.026136109605431557,
                    -0.030310409143567085,
                    0.005562379956245422,
                    -0.0679013580083847,
                    -0.01723729819059372,
                    0.02043801173567772,
                    0.02158292755484581,
                    -0.037371955811977386,
                    0.007423464208841324,
                    -0.06925982236862183,
                    0.019892267882823944,
                    0.014217237941920757,
                    -0.04009100794792175,
                    -0.09427239000797272,
                    0.06237642094492912,
                    -0.1512511819601059,
                    -0.019192354753613472,
                    -0.12304054945707321,
                    -0.0992237851023674,
                    -0.020703930407762527,
                    -0.02064448967576027,
                    0.0907292515039444,
                    -0.1185021623969078,
                    0.07407324761152267,
                    -0.09417472779750824,
                    0.004530963487923145,
                    0.047946639358997345,
                    0.1443849354982376,
                    -0.009875726886093616,
                    -0.07452315092086792,
                    0.051765598356723785,
                    -0.01032435055822134,
                    -0.022490747272968292,
                    -0.03289814293384552,
                    -0.029786307364702225,
                    0.12356498837471008,
                    -0.11593050509691238,
                    -0.009173420257866383,
                    0.030722053721547127,
                    -0.039956361055374146,
                    0.05360991135239601,
                    0.08479313552379608,
                    -0.028277110308408737,
                    0.0751875787973404,
                    0.07859189808368683,
                    0.03168932721018791,
                    -0.017752239480614662,
                    0.04041791334748268,
                    -0.07149110734462738,
                    0.04056137055158615,
                    -0.03216066583991051,
                    0.03237641975283623,
                    0.004747842904180288,
                    0.02935510128736496,
                    -0.06816191971302032,
                    0.009049305692315102,
                    0.03883439674973488,
                    0.03547040373086929,
                    -0.044286444783210754,
                    -0.12571705877780914,
                    -0.05758874863386154,
                    0.020860014483332634,
                    -0.017056088894605637,
                    -0.10502926260232925,
                    0.06944527477025986,
                    0.08516108989715576,
                    -0.03426817059516907,
                    0.09452377259731293,
                    -0.019371645525097847,
                    -0.03153858333826065,
                    0.030815094709396362,
                    0.010763155296444893,
                    -0.07147403806447983,
                    -0.062162846326828,
                    -0.021171439439058304,
                    -0.021884508430957794,
                    -0.035877469927072525,
                    0.028537986800074577,
                    0.016711894422769547,
                    0.03521643206477165,
                    -0.10932759940624237,
                    -0.007762817200273275,
                    0.010173319838941097,
                    0.08617080003023148,
                    0.04761147499084473,
                    0.11838643252849579,
                    0.05320853739976883,
                    -0.06359520554542542,
                    -0.09223855286836624,
                    -0.01975233666598797,
                    -0.08167316764593124,
                    -0.029041284695267677,
                    0.07447700202465057,
                    0.08290254324674606,
                    0.02804633416235447,
                    0.1533420830965042,
                    -0.04725775867700577,
                    0.050676729530096054,
                    0.06727427989244461,
                    -0.056559041142463684,
                    0.003370950696989894,
                    -0.01817742921411991,
                    -0.001963341375812888,
                    0.08155664056539536,
                    0.02357509732246399,
                    -0.07081717997789383,
                    -0.04877479001879692,
                    0.07232049107551575,
                    -0.08191865682601929,
                    -0.05356829985976219,
                    -0.03659755364060402,
                    0.052239611744880676,
                    0.0351378358900547,
                    0.06181282177567482,
                    -0.06526998430490494,
                    -0.030412498861551285,
                    -0.1313101053237915,
                    -0.03195047378540039,
                    0.08085810393095016,
                    0.0007727206684648991,
                    0.04029451683163643,
                    -0.003953778184950352,
                    0.06630931049585342,
                    -0.062405504286289215,
                    0.06025547906756401,
                    -0.038171324878931046,
                    0.10822954028844833,
                    0.08916246891021729,
                    0.11667529493570328,
                    0.09781768172979355,
                    -0.028851358219981194,
                    -0.004718199372291565,
                    -0.013794999569654465,
                    0.0454917773604393,
                    0.007022785488516092,
                    0.05563367158174515,
                    -0.027502596378326416,
                    0.016163216903805733,
                    -0.0021786487195640802,
                    -0.07953664660453796,
                    -0.0351378470659256,
                    -0.023602724075317383,
                    0.02158951573073864,
                    0.002581061329692602,
                    0.005210741888731718,
                    -0.03462129458785057,
                    0.09912125021219254,
                    0.05038398504257202,
                    -0.04150533303618431,
                    0.03844573721289635,
                    -0.028858261182904243,
                    -0.10088302195072174,
                    0.083235003054142,
                    0.001353508559986949,
                    -0.1043875440955162,
                    0.016314780339598656,
                    -0.1057075709104538,
                    -0.05923640727996826,
                    0.020672017708420753,
                    -0.0022286097519099712,
                    0.021528976038098335,
                    -0.0034941399935632944,
                    -0.00405800249427557,
                    0.053408946841955185,
                    -0.1585550159215927,
                    0.019856657832860947,
                    0.03174997493624687,
                    0.0062188999727368355,
                    -0.04176246002316475,
                    0.12773121893405914,
                    0.046902846544981,
                    0.04188928008079529,
                    -0.07645998150110245,
                    0.027332207188010216,
                    0.009527298621833324,
                    -0.12584316730499268,
                    0.06598646938800812,
                    -0.04405422508716583,
                    -0.0003697528736665845,
                    -0.0514974482357502,
                    0.10397832095623016,
                    0.026906413957476616,
                    -0.08775002509355545,
                    0.00030647747917100787,
                    -0.012789806351065636,
                    0.12768641114234924,
                    0.018779218196868896,
                    -0.03229688107967377,
                    0.07940113544464111,
                    0.02799566090106964,
                    -0.03351651877164841,
                    0.10401284694671631,
                    -0.09244894236326218,
                    0.08894429355859756,
                    0.013402520678937435,
                    -0.0570865273475647,
                    -0.003273095702752471,
                    0.062706358730793,
                    0.033372629433870316,
                    -0.0319209024310112,
                    -0.019097693264484406,
                    0.026311762630939484,
                    -0.006970327813178301,
                    -0.014369536191225052,
                    -0.014539940282702446,
                    -0.07113330066204071,
                    0.03107650764286518,
                    0.06633760780096054,
                    0.06403335183858871,
                    0.1083349734544754,
                    0.043815694749355316,
                    0.015321046113967896,
                    -0.013146869838237762
                ],
                "diffText": "diff --git a/lib/jxl/dec_modular.cc b/lib/jxl/dec_modular.cc\nindex a7c76867..f44f5d07 100644\n--- a/lib/jxl/dec_modular.cc\n+++ b/lib/jxl/dec_modular.cc\n@@ -449,7 +449,9 @@ Status ModularFrameDecoder::FinalizeDecoding(PassesDecoderState* dec_state,\n     const bool fp = metadata->m.bit_depth.floating_point_sample;\n \n     for (; c < 3; c++) {\n-      float factor = 1.f / ((1u << full_image.bitdepth) - 1);\n+      float factor = full_image.bitdepth < 32\n+                         ? 1.f / ((1u << full_image.bitdepth) - 1)\n+                         : 0;\n       int c_in = c;\n       if (frame_header.color_transform == ColorTransform::kXYB) {\n         factor = dec_state->shared->matrices.DCQuants()[c];"
            }
        },
        "relation2": {
            "identity": 23789,
            "start": 11464,
            "end": 11459,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 11459,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-35231"
            }
        }
    },
    {
        "baseNode": {
            "identity": 11459,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-35231"
            }
        },
        "relation1": {
            "identity": 23789,
            "start": 11459,
            "end": 11464,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11464,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    -0.0013718114932999015,
                    -0.05793771147727966,
                    -0.15904155373573303,
                    0.07697957009077072,
                    -0.02609342895448208,
                    0.04410587251186371,
                    -0.09143638610839844,
                    0.06535353511571884,
                    0.029238702729344368,
                    -0.01603313907980919,
                    0.016626713797450066,
                    -0.03828949108719826,
                    -0.03871762380003929,
                    -0.037243328988552094,
                    0.020130585879087448,
                    -0.03407441824674606,
                    0.13180024921894073,
                    -0.06936666369438171,
                    -0.026045287027955055,
                    0.1214178204536438,
                    -0.10663117468357086,
                    0.0025721220299601555,
                    -0.07456730306148529,
                    0.019595803692936897,
                    0.04785778000950813,
                    0.09904441982507706,
                    -0.08990442007780075,
                    -0.03864980861544609,
                    -0.04002002999186516,
                    -0.037804655730724335,
                    -0.15709662437438965,
                    -0.08484092354774475,
                    0.08225949853658676,
                    0.034198399633169174,
                    -0.010214274749159813,
                    0.036806557327508926,
                    0.021466106176376343,
                    -0.05164160951972008,
                    -0.030838653445243835,
                    0.06719716638326645,
                    -0.09258639812469482,
                    -0.0581420361995697,
                    0.013670168817043304,
                    -0.026136109605431557,
                    -0.030310409143567085,
                    0.005562379956245422,
                    -0.0679013580083847,
                    -0.01723729819059372,
                    0.02043801173567772,
                    0.02158292755484581,
                    -0.037371955811977386,
                    0.007423464208841324,
                    -0.06925982236862183,
                    0.019892267882823944,
                    0.014217237941920757,
                    -0.04009100794792175,
                    -0.09427239000797272,
                    0.06237642094492912,
                    -0.1512511819601059,
                    -0.019192354753613472,
                    -0.12304054945707321,
                    -0.0992237851023674,
                    -0.020703930407762527,
                    -0.02064448967576027,
                    0.0907292515039444,
                    -0.1185021623969078,
                    0.07407324761152267,
                    -0.09417472779750824,
                    0.004530963487923145,
                    0.047946639358997345,
                    0.1443849354982376,
                    -0.009875726886093616,
                    -0.07452315092086792,
                    0.051765598356723785,
                    -0.01032435055822134,
                    -0.022490747272968292,
                    -0.03289814293384552,
                    -0.029786307364702225,
                    0.12356498837471008,
                    -0.11593050509691238,
                    -0.009173420257866383,
                    0.030722053721547127,
                    -0.039956361055374146,
                    0.05360991135239601,
                    0.08479313552379608,
                    -0.028277110308408737,
                    0.0751875787973404,
                    0.07859189808368683,
                    0.03168932721018791,
                    -0.017752239480614662,
                    0.04041791334748268,
                    -0.07149110734462738,
                    0.04056137055158615,
                    -0.03216066583991051,
                    0.03237641975283623,
                    0.004747842904180288,
                    0.02935510128736496,
                    -0.06816191971302032,
                    0.009049305692315102,
                    0.03883439674973488,
                    0.03547040373086929,
                    -0.044286444783210754,
                    -0.12571705877780914,
                    -0.05758874863386154,
                    0.020860014483332634,
                    -0.017056088894605637,
                    -0.10502926260232925,
                    0.06944527477025986,
                    0.08516108989715576,
                    -0.03426817059516907,
                    0.09452377259731293,
                    -0.019371645525097847,
                    -0.03153858333826065,
                    0.030815094709396362,
                    0.010763155296444893,
                    -0.07147403806447983,
                    -0.062162846326828,
                    -0.021171439439058304,
                    -0.021884508430957794,
                    -0.035877469927072525,
                    0.028537986800074577,
                    0.016711894422769547,
                    0.03521643206477165,
                    -0.10932759940624237,
                    -0.007762817200273275,
                    0.010173319838941097,
                    0.08617080003023148,
                    0.04761147499084473,
                    0.11838643252849579,
                    0.05320853739976883,
                    -0.06359520554542542,
                    -0.09223855286836624,
                    -0.01975233666598797,
                    -0.08167316764593124,
                    -0.029041284695267677,
                    0.07447700202465057,
                    0.08290254324674606,
                    0.02804633416235447,
                    0.1533420830965042,
                    -0.04725775867700577,
                    0.050676729530096054,
                    0.06727427989244461,
                    -0.056559041142463684,
                    0.003370950696989894,
                    -0.01817742921411991,
                    -0.001963341375812888,
                    0.08155664056539536,
                    0.02357509732246399,
                    -0.07081717997789383,
                    -0.04877479001879692,
                    0.07232049107551575,
                    -0.08191865682601929,
                    -0.05356829985976219,
                    -0.03659755364060402,
                    0.052239611744880676,
                    0.0351378358900547,
                    0.06181282177567482,
                    -0.06526998430490494,
                    -0.030412498861551285,
                    -0.1313101053237915,
                    -0.03195047378540039,
                    0.08085810393095016,
                    0.0007727206684648991,
                    0.04029451683163643,
                    -0.003953778184950352,
                    0.06630931049585342,
                    -0.062405504286289215,
                    0.06025547906756401,
                    -0.038171324878931046,
                    0.10822954028844833,
                    0.08916246891021729,
                    0.11667529493570328,
                    0.09781768172979355,
                    -0.028851358219981194,
                    -0.004718199372291565,
                    -0.013794999569654465,
                    0.0454917773604393,
                    0.007022785488516092,
                    0.05563367158174515,
                    -0.027502596378326416,
                    0.016163216903805733,
                    -0.0021786487195640802,
                    -0.07953664660453796,
                    -0.0351378470659256,
                    -0.023602724075317383,
                    0.02158951573073864,
                    0.002581061329692602,
                    0.005210741888731718,
                    -0.03462129458785057,
                    0.09912125021219254,
                    0.05038398504257202,
                    -0.04150533303618431,
                    0.03844573721289635,
                    -0.028858261182904243,
                    -0.10088302195072174,
                    0.083235003054142,
                    0.001353508559986949,
                    -0.1043875440955162,
                    0.016314780339598656,
                    -0.1057075709104538,
                    -0.05923640727996826,
                    0.020672017708420753,
                    -0.0022286097519099712,
                    0.021528976038098335,
                    -0.0034941399935632944,
                    -0.00405800249427557,
                    0.053408946841955185,
                    -0.1585550159215927,
                    0.019856657832860947,
                    0.03174997493624687,
                    0.0062188999727368355,
                    -0.04176246002316475,
                    0.12773121893405914,
                    0.046902846544981,
                    0.04188928008079529,
                    -0.07645998150110245,
                    0.027332207188010216,
                    0.009527298621833324,
                    -0.12584316730499268,
                    0.06598646938800812,
                    -0.04405422508716583,
                    -0.0003697528736665845,
                    -0.0514974482357502,
                    0.10397832095623016,
                    0.026906413957476616,
                    -0.08775002509355545,
                    0.00030647747917100787,
                    -0.012789806351065636,
                    0.12768641114234924,
                    0.018779218196868896,
                    -0.03229688107967377,
                    0.07940113544464111,
                    0.02799566090106964,
                    -0.03351651877164841,
                    0.10401284694671631,
                    -0.09244894236326218,
                    0.08894429355859756,
                    0.013402520678937435,
                    -0.0570865273475647,
                    -0.003273095702752471,
                    0.062706358730793,
                    0.033372629433870316,
                    -0.0319209024310112,
                    -0.019097693264484406,
                    0.026311762630939484,
                    -0.006970327813178301,
                    -0.014369536191225052,
                    -0.014539940282702446,
                    -0.07113330066204071,
                    0.03107650764286518,
                    0.06633760780096054,
                    0.06403335183858871,
                    0.1083349734544754,
                    0.043815694749355316,
                    0.015321046113967896,
                    -0.013146869838237762
                ],
                "diffText": "diff --git a/lib/jxl/dec_modular.cc b/lib/jxl/dec_modular.cc\nindex a7c76867..f44f5d07 100644\n--- a/lib/jxl/dec_modular.cc\n+++ b/lib/jxl/dec_modular.cc\n@@ -449,7 +449,9 @@ Status ModularFrameDecoder::FinalizeDecoding(PassesDecoderState* dec_state,\n     const bool fp = metadata->m.bit_depth.floating_point_sample;\n \n     for (; c < 3; c++) {\n-      float factor = 1.f / ((1u << full_image.bitdepth) - 1);\n+      float factor = full_image.bitdepth < 32\n+                         ? 1.f / ((1u << full_image.bitdepth) - 1)\n+                         : 0;\n       int c_in = c;\n       if (frame_header.color_transform == ColorTransform::kXYB) {\n         factor = dec_state->shared->matrices.DCQuants()[c];"
            }
        },
        "relation2": {
            "identity": 23788,
            "start": 11464,
            "end": 1923,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 1923,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "lib/jxl/dec_modular.cc"
            }
        }
    },
    {
        "baseNode": {
            "identity": 11459,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-35231"
            }
        },
        "relation1": {
            "identity": 23786,
            "start": 11459,
            "end": 1007,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 1007,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "libjxl"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11459,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-35231"
            }
        },
        "relation1": {
            "identity": 23785,
            "start": 11459,
            "end": 11463,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11463,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "msan",
                "report_content": "INFO: Running with entropic power schedule (0xFF, 100).\nINFO: Seed: 67766073\nINFO: Loaded 1 modules   (30537 inline 8-bit counters): 30537 [0x561120564a78, 0x56112056c1c1), \nINFO: Loaded 1 PC tables (30537 PCs): 30537 [0x56112056c1c8,0x5611205e3658), \n/out/djxl_fuzzer: Running 1 inputs 1 time(s) each.\nRunning: /tmp/poc\n==1==WARNING: MemorySanitizer: use-of-uninitialized-value\n    #0 0x56111fc985aa in NearestInt<4> /src/libjxl/third_party/highway/hwy/ops/x86_128-inl.h:3075:47\n    #1 0x56111fc985aa in jxl::N_AVX2::FloatToRGBA8(jxl::Image3<float> const&, jxl::Rect const&, bool, jxl::Plane<float> const*, jxl::Rect const&, jxl::Rect const&, unsigned char*, unsigned long) /src/libjxl/lib/jxl/dec_reconstruct.cc:275:39\n    #2 0x56111fcbd86f in jxl::FinalizeImageRect(jxl::Image3<float>*, jxl::Rect const&, std::__1::vector<std::__1::pair<jxl::Plane<float>*, jxl::Rect>, std::__1::allocator<std::__1::pair<jxl::Plane<float>*, jxl::Rect> > > const&, jxl::PassesDecoderState*, unsigned long, jxl::ImageBundle*, jxl::Rect const&) /src/libjxl/lib/jxl/dec_reconstruct.cc:1034:9\n    #3 0x56111fcd0075 in operator() /src/libjxl/lib/jxl/dec_reconstruct.cc:1157:12\n    #4 0x56111fcd0075 in jxl::ThreadPool::RunCallState<jxl::FinalizeFrameDecoding(jxl::ImageBundle*, jxl::PassesDecoderState*, jxl::ThreadPool*, bool, bool)::$_9, jxl::FinalizeFrameDecoding(jxl::ImageBundle*, jxl::PassesDecoderState*, jxl::ThreadPool*, bool, bool)::$_10>::CallDataFunc(void*, unsigned int, unsigned long) /src/libjxl/lib/jxl/base/data_parallel.h:88:14\n    #5 0x561120063113 in RunRange /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:137:7\n    #6 0x561120063113 in jpegxl::ThreadParallelRunner::ThreadFunc(jpegxl::ThreadParallelRunner*, int) /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:167:9\n    #7 0x561120065dda in __invoke<void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int> /usr/local/bin/../include/c++/v1/type_traits:3679:1\n    #8 0x561120065dda in __thread_execute<std::unique_ptr<std::__thread_struct>, void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int, 2, 3> /usr/local/bin/../include/c++/v1/thread:280:5\n    #9 0x561120065dda in void* std::__1::__thread_proxy<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(jpegxl::ThreadParallelRunner*, int), jpegxl::ThreadParallelRunner*, unsigned int> >(void*) /usr/local/bin/../include/c++/v1/thread:291:5\n    #10 0x7f72d7b846b9 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76b9)\n    #11 0x7f72d729851c in clone (/lib/x86_64-linux-gnu/libc.so.6+0x10751c)\n\nDEDUP_TOKEN: NearestInt<4>--jxl::N_AVX2::FloatToRGBA8(jxl::Image3<float> const&, jxl::Rect const&, bool, jxl::Plane<float> const*, jxl::Rect const&, jxl::Rect const&, unsigned char*, unsigned long)--jxl::FinalizeImageRect(jxl::Image3<float>*, jxl::Rect const&, std::__1::vector<std::__1::pair<jxl::Plane<float>*, jxl::Rect>, std::__1::allocator<std::__1::pair<jxl::Plane<float>*, jxl::Rect> > > const&, jxl::PassesDecoderState*, unsigned long, jxl::ImageBundle*, jxl::Rect const&)\n  Uninitialized value was stored to memory at\n    #0 0x56111fc92611 in Store /src/libjxl/third_party/highway/hwy/ops/x86_256-inl.h:1393:3\n    #1 0x56111fc92611 in jxl::N_AVX2::UndoXYBInPlace(jxl::Image3<float>*, jxl::Rect const&, jxl::OutputEncodingInfo const&) /src/libjxl/lib/jxl/dec_reconstruct.cc:83:9\n    #2 0x56111fcbbdcc in jxl::FinalizeImageRect(jxl::Image3<float>*, jxl::Rect const&, std::__1::vector<std::__1::pair<jxl::Plane<float>*, jxl::Rect>, std::__1::allocator<std::__1::pair<jxl::Plane<float>*, jxl::Rect> > > const&, jxl::PassesDecoderState*, unsigned long, jxl::ImageBundle*, jxl::Rect const&) /src/libjxl/lib/jxl/dec_reconstruct.cc:1020:11\n    #3 0x56111fcd0075 in operator() /src/libjxl/lib/jxl/dec_reconstruct.cc:1157:12\n    #4 0x56111fcd0075 in jxl::ThreadPool::RunCallState<jxl::FinalizeFrameDecoding(jxl::ImageBundle*, jxl::PassesDecoderState*, jxl::ThreadPool*, bool, bool)::$_9, jxl::FinalizeFrameDecoding(jxl::ImageBundle*, jxl::PassesDecoderState*, jxl::ThreadPool*, bool, bool)::$_10>::CallDataFunc(void*, unsigned int, unsigned long) /src/libjxl/lib/jxl/base/data_parallel.h:88:14\n    #5 0x561120063113 in RunRange /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:137:7\n    #6 0x561120063113 in jpegxl::ThreadParallelRunner::ThreadFunc(jpegxl::ThreadParallelRunner*, int) /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:167:9\n    #7 0x561120065dda in __invoke<void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int> /usr/local/bin/../include/c++/v1/type_traits:3679:1\n    #8 0x561120065dda in __thread_execute<std::unique_ptr<std::__thread_struct>, void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int, 2, 3> /usr/local/bin/../include/c++/v1/thread:280:5\n    #9 0x561120065dda in void* std::__1::__thread_proxy<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(jpegxl::ThreadParallelRunner*, int), jpegxl::ThreadParallelRunner*, unsigned int> >(void*) /usr/local/bin/../include/c++/v1/thread:291:5\n    #10 0x7f72d7b846b9 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76b9)\n\nDEDUP_TOKEN: Store--jxl::N_AVX2::UndoXYBInPlace(jxl::Image3<float>*, jxl::Rect const&, jxl::OutputEncodingInfo const&)--jxl::FinalizeImageRect(jxl::Image3<float>*, jxl::Rect const&, std::__1::vector<std::__1::pair<jxl::Plane<float>*, jxl::Rect>, std::__1::allocator<std::__1::pair<jxl::Plane<float>*, jxl::Rect> > > const&, jxl::PassesDecoderState*, unsigned long, jxl::ImageBundle*, jxl::Rect const&)\n  Uninitialized value was created by a heap allocation\n    #0 0x56111f7adbbd in malloc /src/llvm-project/compiler-rt/lib/msan/msan_interceptors.cpp:901:3\n    #1 0x56111fa03376 in jxl::CacheAligned::Allocate(unsigned long, unsigned long) /src/libjxl/lib/jxl/base/cache_aligned.cc:85:21\n    #2 0x56111f893061 in Allocate /src/libjxl/lib/jxl/base/cache_aligned.h:43:12\n    #3 0x56111f893061 in AllocateArray /src/libjxl/lib/jxl/base/cache_aligned.h:61:29\n    #4 0x56111f893061 in jxl::PlaneBase::PlaneBase(unsigned long, unsigned long, unsigned long) /src/libjxl/lib/jxl/image.cc:92:14\n    #5 0x56111fac3660 in Plane /src/libjxl/lib/jxl/image.h:147:9\n    #6 0x56111fac3660 in Image3 /src/libjxl/lib/jxl/image.h:324:39\n    #7 0x56111fac3660 in construct<jxl::Image3<float>, unsigned long, unsigned long> /usr/local/bin/../include/c++/v1/memory:886:28\n    #8 0x56111fac3660 in construct<jxl::Image3<float>, unsigned long, unsigned long, void> /usr/local/bin/../include/c++/v1/__memory/allocator_traits.h:288:13\n    #9 0x56111fac3660 in void std::__1::vector<jxl::Image3<float>, std::__1::allocator<jxl::Image3<float> > >::__emplace_back_slow_path<unsigned long, unsigned long>(unsigned long&&, unsigned long&&) /usr/local/bin/../include/c++/v1/vector:1667:5\n    #10 0x56111fabd236 in emplace_back<unsigned long, unsigned long> /usr/local/bin/../include/c++/v1/vector:1687:9\n    #11 0x56111fabd236 in jxl::PassesDecoderState::EnsureStorage(unsigned long) /src/libjxl/lib/jxl/dec_cache.h:192:18\n    #12 0x56111fccd7e5 in operator() /src/libjxl/lib/jxl/dec_reconstruct.cc:1101:18\n    #13 0x56111fccd7e5 in jxl::ThreadPool::RunCallState<jxl::FinalizeFrameDecoding(jxl::ImageBundle*, jxl::PassesDecoderState*, jxl::ThreadPool*, bool, bool)::$_9, jxl::FinalizeFrameDecoding(jxl::ImageBundle*, jxl::PassesDecoderState*, jxl::ThreadPool*, bool, bool)::$_10>::CallInitFunc(void*, unsigned long) /src/libjxl/lib/jxl/base/data_parallel.h:80:14\n    #14 0x561120061c8f in jpegxl::ThreadParallelRunner::Runner(void*, void*, int (*)(void*, unsigned long), void (*)(void*, unsigned int, unsigned long), unsigned int, unsigned int) /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:64:13\n    #15 0x56111fcc50ca in Run<(lambda at /src/libjxl/lib/jxl/dec_reconstruct.cc:1100:35), (lambda at /src/libjxl/lib/jxl/dec_reconstruct.cc:1120:31)> /src/libjxl/lib/jxl/base/data_parallel.h:51:12\n    #16 0x56111fcc50ca in RunOnPool<(lambda at /src/libjxl/lib/jxl/dec_reconstruct.cc:1100:35), (lambda at /src/libjxl/lib/jxl/dec_reconstruct.cc:1120:31)> /src/libjxl/lib/jxl/base/data_parallel.h:122:17\n    #17 0x56111fcc50ca in jxl::FinalizeFrameDecoding(jxl::ImageBundle*, jxl::PassesDecoderState*, jxl::ThreadPool*, bool, bool) /src/libjxl/lib/jxl/dec_reconstruct.cc:1164:5\n    #18 0x56111faac808 in jxl::FrameDecoder::Flush() /src/libjxl/lib/jxl/dec_frame.cc:822:3\n    #19 0x56111fa9b220 in jxl::FrameDecoder::FinalizeFrame() /src/libjxl/lib/jxl/dec_frame.cc:854:3\n    #20 0x56111f820d98 in jxl::(anonymous namespace)::JxlDecoderProcessInternal(JxlDecoderStruct*, unsigned char const*, unsigned long) /src/libjxl/lib/jxl/decode.cc:1119:28\n    #21 0x56111f817382 in JxlDecoderProcessInput /src/libjxl/lib/jxl/decode.cc:1518:14\n    #22 0x56111f8015df in DecodeJpegXl /src/libjxl/tools/djxl_fuzzer.cc:163:31\n    #23 0x56111f8015df in TestOneInput /src/libjxl/tools/djxl_fuzzer.cc:472:3\n    #24 0x56111f8015df in LLVMFuzzerTestOneInput /src/libjxl/tools/djxl_fuzzer.cc:482:10\n    #25 0x56111f732473 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15\n    #26 0x56111f71d912 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6\n    #27 0x56111f7235be in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9\n    #28 0x56111f74d232 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #29 0x7f72d71b183f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n\nDEDUP_TOKEN: malloc--jxl::CacheAligned::Allocate(unsigned long, unsigned long)--Allocate\nSUMMARY: MemorySanitizer: use-of-uninitialized-value /src/libjxl/third_party/highway/hwy/ops/x86_128-inl.h:3075:47 in NearestInt<4>\nUnique heap origins: 1338\nStack depot allocated bytes: 196560\nUnique origin histories: 98\nHistory depot allocated bytes: 2352\nExiting\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.04779514670372009,
                    0.031530216336250305,
                    -0.05548854172229767,
                    -0.005992247257381678,
                    -0.05730879306793213,
                    0.04662168398499489,
                    -0.03716382756829262,
                    0.02462763525545597,
                    0.021826239302754402,
                    -0.0356711708009243,
                    0.002275044796988368,
                    0.018595950677990913,
                    -0.07181445509195328,
                    0.011089340783655643,
                    0.04088945686817169,
                    -0.014908275566995144,
                    0.1292790323495865,
                    0.016592880710959435,
                    -0.009258157573640347,
                    0.048751771450042725,
                    -0.049276646226644516,
                    -0.0074592940509319305,
                    -0.020503899082541466,
                    0.011027821339666843,
                    0.005257151555269957,
                    -0.008688115514814854,
                    -0.07270429283380508,
                    -0.01917371153831482,
                    0.009941124357283115,
                    -0.01288639660924673,
                    -0.12552817165851593,
                    -0.1257886439561844,
                    0.030863679945468903,
                    -0.0002420109958620742,
                    -0.010061732493340969,
                    0.02205183170735836,
                    0.013339708559215069,
                    -0.01577683351933956,
                    0.02707728184759617,
                    0.03009314090013504,
                    -0.06383915990591049,
                    -0.06591378897428513,
                    0.02764970250427723,
                    0.009581664577126503,
                    -0.07189151644706726,
                    0.016100427135825157,
                    -0.023117994889616966,
                    -0.05417095124721527,
                    0.05271775647997856,
                    -0.004514652770012617,
                    -0.09780458360910416,
                    0.002217894187197089,
                    -0.030206428840756416,
                    -0.007452949415892363,
                    -0.005603787023574114,
                    -0.015564101748168468,
                    -0.02901539020240307,
                    0.056356221437454224,
                    -0.09028030186891556,
                    0.044580262154340744,
                    0.03917165473103523,
                    -0.06795183569192886,
                    0.024362483993172646,
                    -0.05893741920590401,
                    -0.0020343188662081957,
                    -0.007248159497976303,
                    0.08292463421821594,
                    -0.032112956047058105,
                    0.040729355067014694,
                    -0.01848483458161354,
                    0.02472377009689808,
                    0.09609460085630417,
                    -0.06981687247753143,
                    -0.07922456413507462,
                    -0.012209906242787838,
                    -0.013790830969810486,
                    -0.021598374471068382,
                    0.01815570332109928,
                    -0.030123641714453697,
                    -0.06739232689142227,
                    0.010571207851171494,
                    0.034360576421022415,
                    0.008707365952432156,
                    -0.0034388492349535227,
                    0.04815419390797615,
                    0.014025609008967876,
                    -0.009489941410720348,
                    -0.05501989647746086,
                    0.01170187909156084,
                    -0.06989459693431854,
                    0.004615467507392168,
                    -0.05598824843764305,
                    -0.008736818097531796,
                    -0.017447568476200104,
                    0.00037651570164598525,
                    -0.004729218780994415,
                    0.004820995032787323,
                    -0.04327267035841942,
                    -0.015222861431539059,
                    -0.004027627408504486,
                    -0.04548022150993347,
                    -0.019204281270503998,
                    -0.06588909775018692,
                    -0.022156119346618652,
                    0.027328750118613243,
                    -0.009567317552864552,
                    -0.058911699801683426,
                    -0.004243266303092241,
                    0.01784534752368927,
                    -0.01934904046356678,
                    0.008611157536506653,
                    0.009501292370259762,
                    0.004831945523619652,
                    0.011943909339606762,
                    -0.01408124715089798,
                    -0.046356428414583206,
                    -0.02587994933128357,
                    -0.04481606185436249,
                    -0.03886973112821579,
                    -0.022380316630005836,
                    0.02984633482992649,
                    -0.01843390427529812,
                    -0.0043683648109436035,
                    0.014270945452153683,
                    -0.010835334658622742,
                    -0.024167804047465324,
                    0.05481598898768425,
                    0.006610044743865728,
                    0.09690054506063461,
                    0.0713777169585228,
                    -0.02454899251461029,
                    0.035163622349500656,
                    -0.023081166669726372,
                    -0.046943843364715576,
                    0.0008127347682602704,
                    0.013773199170827866,
                    0.08011668175458908,
                    -0.020324746146798134,
                    0.04217374324798584,
                    -0.024835526943206787,
                    0.03218802064657211,
                    0.03759783133864403,
                    -0.020270250737667084,
                    0.03197423368692398,
                    -0.003220540238544345,
                    -0.03768746182322502,
                    0.030929887667298317,
                    0.04097880423069,
                    -0.02880103886127472,
                    -0.06329966336488724,
                    0.010542542673647404,
                    -0.04540761932730675,
                    -0.06870778650045395,
                    -0.025804052129387856,
                    0.05461033061146736,
                    0.011314828880131245,
                    -0.0055426196195185184,
                    -0.025085166096687317,
                    -0.03974517434835434,
                    -0.0542096346616745,
                    0.0005381512455642223,
                    0.05494312569499016,
                    -0.04810645058751106,
                    0.11497805267572403,
                    -0.02488783933222294,
                    0.08860377222299576,
                    -0.060802359133958817,
                    0.07461061328649521,
                    0.011415336281061172,
                    0.04883238673210144,
                    -0.05521788075566292,
                    0.03292356804013252,
                    -0.010945436544716358,
                    0.02265704981982708,
                    -0.004562348127365112,
                    -0.03638958930969238,
                    0.010969751514494419,
                    0.043242666870355606,
                    0.010444839484989643,
                    -0.0067140404134988785,
                    -0.010585598647594452,
                    0.05852387845516205,
                    -0.08406887203454971,
                    -0.05410795286297798,
                    0.0033425958827137947,
                    0.0406760536134243,
                    -0.055184874683618546,
                    -0.010193622671067715,
                    -0.031544435769319534,
                    0.06575096398591995,
                    0.025577181950211525,
                    -0.013544999994337559,
                    0.04074932262301445,
                    -0.017871925607323647,
                    -0.13947005569934845,
                    0.017279617488384247,
                    -0.014975971542298794,
                    -0.061410024762153625,
                    0.003540563164278865,
                    -0.0701567754149437,
                    -0.04286833107471466,
                    -0.06653625518083572,
                    0.07359319925308228,
                    0.025095602497458458,
                    -0.055926427245140076,
                    -0.06336722522974014,
                    0.05220287665724754,
                    -0.07007183134555817,
                    0.025012992322444916,
                    -0.02225046418607235,
                    -0.004078499972820282,
                    0.04145413264632225,
                    0.10036738961935043,
                    0.06443540006875992,
                    -0.018155992031097412,
                    -0.05498287081718445,
                    0.011278954334557056,
                    -0.02965185046195984,
                    -0.06620606780052185,
                    0.029209157451987267,
                    -0.04293406382203102,
                    -0.03878219053149223,
                    -0.04075177386403084,
                    -0.016357192769646645,
                    0.06205878034234047,
                    -0.039317887276411057,
                    0.0018045163014903665,
                    0.07800733298063278,
                    0.08953971415758133,
                    0.020824013277888298,
                    -0.08636707067489624,
                    0.04224032163619995,
                    0.0037337960675358772,
                    0.0008268368546850979,
                    0.05012205243110657,
                    -0.026379255577921867,
                    0.07361114025115967,
                    0.08249332010746002,
                    -0.03218437358736992,
                    -0.0360482856631279,
                    0.04092026129364967,
                    -0.011798419058322906,
                    -0.06264033913612366,
                    0.0019515473395586014,
                    0.03647909685969353,
                    -0.07498044520616531,
                    -0.0450301468372345,
                    0.04861767590045929,
                    -0.06481536477804184,
                    0.02556447684764862,
                    -0.013796888291835785,
                    -0.006012065801769495,
                    0.11536693572998047,
                    0.03063838742673397,
                    0.036098361015319824,
                    -0.007546367589384317
                ],
                "report_type": "Use-of-uninitialized-value",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11459,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-35231"
            }
        },
        "relation1": {
            "identity": 23784,
            "start": 11459,
            "end": 11462,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11462,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "avoid << 32 also in decoder\n",
                "sha": "552a7cae109df2b264ede8e1f85ec66505175cc8",
                "repo": "libjxl",
                "encoding": "UTF-8",
                "authored_date": 1623502728,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1623652864
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11459,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-35231"
            }
        },
        "relation1": {
            "identity": 23779,
            "start": 11459,
            "end": 11460,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11460,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Avoid extra computation for empty histograms in clustering.\n\nSome speedup, especially for small images with faster_decoding=4.\n\n16.63 MP/s -> 17.01 MP/s\n",
                "sha": "9a3fbdd4040d4ad05efa9c8640bcb36e5f22a5e4",
                "repo": "libjxl",
                "encoding": "UTF-8",
                "authored_date": 1622914292,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1623444828
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]