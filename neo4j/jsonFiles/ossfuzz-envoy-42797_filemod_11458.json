[
    {
        "baseNode": {
            "identity": 11449,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-envoy-42797"
            }
        },
        "relation1": {
            "identity": 23774,
            "start": 11449,
            "end": 11458,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11458,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.000808149401564151,
                    -0.10304652154445648,
                    -0.08096253126859665,
                    0.05646790191531181,
                    0.00901865866035223,
                    -0.05720134079456329,
                    0.04509611055254936,
                    0.028528133407235146,
                    -0.016736174002289772,
                    -0.036660559475421906,
                    0.0801195353269577,
                    -0.03839913383126259,
                    0.028847450390458107,
                    -0.04410333186388016,
                    0.0007990082958713174,
                    -0.01874145120382309,
                    0.13773836195468903,
                    -0.1469649374485016,
                    -0.024100586771965027,
                    0.08460428565740585,
                    -0.038152776658535004,
                    0.034064024686813354,
                    -0.15912581980228424,
                    -0.03323320671916008,
                    0.010051386430859566,
                    0.029649805277585983,
                    0.019198350608348846,
                    0.04223737120628357,
                    -0.09197919070720673,
                    -0.10939230769872665,
                    -0.013432024978101254,
                    -0.03073120303452015,
                    0.06350386887788773,
                    0.009798984974622726,
                    -0.05998257175087929,
                    -0.032724738121032715,
                    0.049048930406570435,
                    -0.05455425754189491,
                    -0.025912264361977577,
                    0.041341930627822876,
                    -0.008166489191353321,
                    0.018089869990944862,
                    0.03970074653625488,
                    0.04815448820590973,
                    0.020260009914636612,
                    -0.0028949992265552282,
                    -0.0188433974981308,
                    0.01698083057999611,
                    -0.024412572383880615,
                    0.03333788365125656,
                    0.03900037705898285,
                    0.08568649739027023,
                    -0.04630061611533165,
                    -0.08149853348731995,
                    0.03782208636403084,
                    -0.006188104394823313,
                    -0.047622159123420715,
                    -0.00847839005291462,
                    -0.07321450859308243,
                    0.08535203337669373,
                    -0.08426254242658615,
                    -0.11229895800352097,
                    0.04666498303413391,
                    -0.04624868556857109,
                    0.013451417908072472,
                    0.0011694219429045916,
                    0.0250258669257164,
                    -0.00821188185364008,
                    -0.018099617213010788,
                    -0.014394557103514671,
                    0.09365867078304291,
                    0.07584825158119202,
                    -0.09304217249155045,
                    -0.01078609749674797,
                    -0.03258591890335083,
                    -0.017967069521546364,
                    -0.021649889647960663,
                    -0.16368509829044342,
                    -0.05131852999329567,
                    -0.022569259628653526,
                    0.02058679796755314,
                    6.981512706261128e-05,
                    0.05854872986674309,
                    0.021656842902302742,
                    -0.007869314402341843,
                    0.0876505896449089,
                    0.08080221712589264,
                    0.07216262072324753,
                    0.1787865161895752,
                    -0.05485936254262924,
                    0.02391284704208374,
                    -0.08545500040054321,
                    0.10782153159379959,
                    -0.06312863528728485,
                    -0.026235485449433327,
                    0.038903143256902695,
                    0.047362737357616425,
                    0.0495450459420681,
                    -0.07163149118423462,
                    -0.04234526678919792,
                    0.05362769588828087,
                    -0.005048240534961224,
                    -0.02805914171040058,
                    -0.046103376895189285,
                    -0.06134385988116264,
                    0.00376860611140728,
                    -0.06484436243772507,
                    0.01788347400724888,
                    -0.011958158574998379,
                    -0.08483897894620895,
                    0.0022407639771699905,
                    0.043611686676740646,
                    -0.05795210227370262,
                    0.20069299638271332,
                    0.06428387016057968,
                    0.03198394179344177,
                    -0.10580769181251526,
                    0.012422648258507252,
                    -0.07170838862657547,
                    0.13124045729637146,
                    0.13738666474819183,
                    -0.03808864951133728,
                    0.05380632355809212,
                    -0.02112763375043869,
                    -0.07087557762861252,
                    0.0020323949865996838,
                    -0.048637863248586655,
                    0.042204082012176514,
                    0.09108363091945648,
                    0.02431423030793667,
                    -0.01145083736628294,
                    0.01685277931392193,
                    0.09727979451417923,
                    -0.03909512236714363,
                    0.012398343533277512,
                    0.016756050288677216,
                    0.08964119851589203,
                    -0.01811850257217884,
                    0.0882173478603363,
                    0.014965358190238476,
                    0.053683824837207794,
                    0.08436455577611923,
                    0.05965208634734154,
                    0.05919558182358742,
                    -0.07271505892276764,
                    -0.01244486402720213,
                    0.14443343877792358,
                    -0.07446305453777313,
                    -0.07959508150815964,
                    -0.06259258836507797,
                    0.03264615312218666,
                    -0.04583748057484627,
                    -0.14864684641361237,
                    0.013239553198218346,
                    -0.08197377622127533,
                    -0.05180257186293602,
                    -0.00038476238842122257,
                    -0.045696184039115906,
                    -0.03897743672132492,
                    -0.08629700541496277,
                    0.01712740957736969,
                    0.15578192472457886,
                    0.00603548064827919,
                    0.005365624092519283,
                    -0.04921954125165939,
                    0.10953837633132935,
                    0.034621402621269226,
                    0.03346138447523117,
                    -0.0799003392457962,
                    0.031472597271203995,
                    -0.020617011934518814,
                    -0.011332542635500431,
                    -0.09070766717195511,
                    -0.06405968219041824,
                    -0.00790109857916832,
                    -0.03348447009921074,
                    0.04229797422885895,
                    -0.003997533582150936,
                    0.026919202879071236,
                    0.008695229887962341,
                    0.16256476938724518,
                    0.004316445905715227,
                    -0.014295211061835289,
                    -0.08533702045679092,
                    0.0391228087246418,
                    0.03593675047159195,
                    0.059288084506988525,
                    -0.02327573485672474,
                    -0.070793017745018,
                    -0.06387803703546524,
                    0.005826948210597038,
                    -0.023743562400341034,
                    -0.042771387845277786,
                    -0.009834671393036842,
                    -0.0403231680393219,
                    0.0021708249114453793,
                    0.03581707924604416,
                    0.10210403054952621,
                    -0.02350480854511261,
                    -0.06612542271614075,
                    -0.011399324983358383,
                    0.013625873252749443,
                    0.0671575590968132,
                    -0.003914519678801298,
                    -0.005785559304058552,
                    -0.04572807624936104,
                    0.05446008965373039,
                    -0.013561693020164967,
                    0.014888489618897438,
                    -0.01379363052546978,
                    0.06371738016605377,
                    0.017130734398961067,
                    0.040937263518571854,
                    0.08993259817361832,
                    0.03743747994303703,
                    -0.08504422754049301,
                    0.029146535322070122,
                    0.08007369190454483,
                    0.06837501376867294,
                    0.0009518564911559224,
                    -0.038793109357357025,
                    -0.039423082023859024,
                    -0.057879336178302765,
                    -0.06875519454479218,
                    0.08177130669355392,
                    -0.04912196099758148,
                    -0.03324172645807266,
                    -0.03045559860765934,
                    0.006898557301610708,
                    -0.02055005542933941,
                    0.068382628262043,
                    -0.010054454207420349,
                    -0.0478021502494812,
                    -0.0711025521159172,
                    0.0003974135033786297,
                    -0.17908932268619537,
                    -0.028380397707223892,
                    0.037735532969236374,
                    -0.06823437660932541,
                    -0.004819164518266916,
                    0.09201900660991669,
                    0.043927647173404694,
                    -0.11423438787460327,
                    0.036272913217544556,
                    0.08452599495649338,
                    -0.1077919453382492,
                    0.021540069952607155,
                    0.1019405648112297,
                    -0.08142052590847015,
                    -0.04538758099079132,
                    -0.032373350113630295,
                    -0.004650554154068232,
                    0.12084804475307465,
                    0.03079046495258808,
                    0.06673470884561539,
                    0.06515134125947952
                ],
                "diffText": "diff --git a/source/extensions/filters/network/mongo_proxy/bson_impl.cc b/source/extensions/filters/network/mongo_proxy/bson_impl.cc\nindex bcf47011b2..8ea6cf0283 100644\n--- a/source/extensions/filters/network/mongo_proxy/bson_impl.cc\n+++ b/source/extensions/filters/network/mongo_proxy/bson_impl.cc\n@@ -98,7 +98,10 @@ std::string BufferHelper::removeString(Buffer::Instance& data) {\n   }\n \n   char* start = reinterpret_cast<char*>(data.linearize(length));\n-  std::string ret(start);\n+  // The BSON spec encodes both strings and C style strings with an additional\n+  // null byte, however strings may contain embedded null bytes, therefore the\n+  // constructor needs to be given the length of the string explicitly.\n+  std::string ret(start, length > 0 ? length - 1 : 0);\n   data.drain(length);\n   return ret;\n }\n"
            }
        },
        "relation2": {
            "identity": 23774,
            "start": 11458,
            "end": 11449,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 11449,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-envoy-42797"
            }
        }
    },
    {
        "baseNode": {
            "identity": 11449,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-envoy-42797"
            }
        },
        "relation1": {
            "identity": 23774,
            "start": 11449,
            "end": 11458,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11458,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.000808149401564151,
                    -0.10304652154445648,
                    -0.08096253126859665,
                    0.05646790191531181,
                    0.00901865866035223,
                    -0.05720134079456329,
                    0.04509611055254936,
                    0.028528133407235146,
                    -0.016736174002289772,
                    -0.036660559475421906,
                    0.0801195353269577,
                    -0.03839913383126259,
                    0.028847450390458107,
                    -0.04410333186388016,
                    0.0007990082958713174,
                    -0.01874145120382309,
                    0.13773836195468903,
                    -0.1469649374485016,
                    -0.024100586771965027,
                    0.08460428565740585,
                    -0.038152776658535004,
                    0.034064024686813354,
                    -0.15912581980228424,
                    -0.03323320671916008,
                    0.010051386430859566,
                    0.029649805277585983,
                    0.019198350608348846,
                    0.04223737120628357,
                    -0.09197919070720673,
                    -0.10939230769872665,
                    -0.013432024978101254,
                    -0.03073120303452015,
                    0.06350386887788773,
                    0.009798984974622726,
                    -0.05998257175087929,
                    -0.032724738121032715,
                    0.049048930406570435,
                    -0.05455425754189491,
                    -0.025912264361977577,
                    0.041341930627822876,
                    -0.008166489191353321,
                    0.018089869990944862,
                    0.03970074653625488,
                    0.04815448820590973,
                    0.020260009914636612,
                    -0.0028949992265552282,
                    -0.0188433974981308,
                    0.01698083057999611,
                    -0.024412572383880615,
                    0.03333788365125656,
                    0.03900037705898285,
                    0.08568649739027023,
                    -0.04630061611533165,
                    -0.08149853348731995,
                    0.03782208636403084,
                    -0.006188104394823313,
                    -0.047622159123420715,
                    -0.00847839005291462,
                    -0.07321450859308243,
                    0.08535203337669373,
                    -0.08426254242658615,
                    -0.11229895800352097,
                    0.04666498303413391,
                    -0.04624868556857109,
                    0.013451417908072472,
                    0.0011694219429045916,
                    0.0250258669257164,
                    -0.00821188185364008,
                    -0.018099617213010788,
                    -0.014394557103514671,
                    0.09365867078304291,
                    0.07584825158119202,
                    -0.09304217249155045,
                    -0.01078609749674797,
                    -0.03258591890335083,
                    -0.017967069521546364,
                    -0.021649889647960663,
                    -0.16368509829044342,
                    -0.05131852999329567,
                    -0.022569259628653526,
                    0.02058679796755314,
                    6.981512706261128e-05,
                    0.05854872986674309,
                    0.021656842902302742,
                    -0.007869314402341843,
                    0.0876505896449089,
                    0.08080221712589264,
                    0.07216262072324753,
                    0.1787865161895752,
                    -0.05485936254262924,
                    0.02391284704208374,
                    -0.08545500040054321,
                    0.10782153159379959,
                    -0.06312863528728485,
                    -0.026235485449433327,
                    0.038903143256902695,
                    0.047362737357616425,
                    0.0495450459420681,
                    -0.07163149118423462,
                    -0.04234526678919792,
                    0.05362769588828087,
                    -0.005048240534961224,
                    -0.02805914171040058,
                    -0.046103376895189285,
                    -0.06134385988116264,
                    0.00376860611140728,
                    -0.06484436243772507,
                    0.01788347400724888,
                    -0.011958158574998379,
                    -0.08483897894620895,
                    0.0022407639771699905,
                    0.043611686676740646,
                    -0.05795210227370262,
                    0.20069299638271332,
                    0.06428387016057968,
                    0.03198394179344177,
                    -0.10580769181251526,
                    0.012422648258507252,
                    -0.07170838862657547,
                    0.13124045729637146,
                    0.13738666474819183,
                    -0.03808864951133728,
                    0.05380632355809212,
                    -0.02112763375043869,
                    -0.07087557762861252,
                    0.0020323949865996838,
                    -0.048637863248586655,
                    0.042204082012176514,
                    0.09108363091945648,
                    0.02431423030793667,
                    -0.01145083736628294,
                    0.01685277931392193,
                    0.09727979451417923,
                    -0.03909512236714363,
                    0.012398343533277512,
                    0.016756050288677216,
                    0.08964119851589203,
                    -0.01811850257217884,
                    0.0882173478603363,
                    0.014965358190238476,
                    0.053683824837207794,
                    0.08436455577611923,
                    0.05965208634734154,
                    0.05919558182358742,
                    -0.07271505892276764,
                    -0.01244486402720213,
                    0.14443343877792358,
                    -0.07446305453777313,
                    -0.07959508150815964,
                    -0.06259258836507797,
                    0.03264615312218666,
                    -0.04583748057484627,
                    -0.14864684641361237,
                    0.013239553198218346,
                    -0.08197377622127533,
                    -0.05180257186293602,
                    -0.00038476238842122257,
                    -0.045696184039115906,
                    -0.03897743672132492,
                    -0.08629700541496277,
                    0.01712740957736969,
                    0.15578192472457886,
                    0.00603548064827919,
                    0.005365624092519283,
                    -0.04921954125165939,
                    0.10953837633132935,
                    0.034621402621269226,
                    0.03346138447523117,
                    -0.0799003392457962,
                    0.031472597271203995,
                    -0.020617011934518814,
                    -0.011332542635500431,
                    -0.09070766717195511,
                    -0.06405968219041824,
                    -0.00790109857916832,
                    -0.03348447009921074,
                    0.04229797422885895,
                    -0.003997533582150936,
                    0.026919202879071236,
                    0.008695229887962341,
                    0.16256476938724518,
                    0.004316445905715227,
                    -0.014295211061835289,
                    -0.08533702045679092,
                    0.0391228087246418,
                    0.03593675047159195,
                    0.059288084506988525,
                    -0.02327573485672474,
                    -0.070793017745018,
                    -0.06387803703546524,
                    0.005826948210597038,
                    -0.023743562400341034,
                    -0.042771387845277786,
                    -0.009834671393036842,
                    -0.0403231680393219,
                    0.0021708249114453793,
                    0.03581707924604416,
                    0.10210403054952621,
                    -0.02350480854511261,
                    -0.06612542271614075,
                    -0.011399324983358383,
                    0.013625873252749443,
                    0.0671575590968132,
                    -0.003914519678801298,
                    -0.005785559304058552,
                    -0.04572807624936104,
                    0.05446008965373039,
                    -0.013561693020164967,
                    0.014888489618897438,
                    -0.01379363052546978,
                    0.06371738016605377,
                    0.017130734398961067,
                    0.040937263518571854,
                    0.08993259817361832,
                    0.03743747994303703,
                    -0.08504422754049301,
                    0.029146535322070122,
                    0.08007369190454483,
                    0.06837501376867294,
                    0.0009518564911559224,
                    -0.038793109357357025,
                    -0.039423082023859024,
                    -0.057879336178302765,
                    -0.06875519454479218,
                    0.08177130669355392,
                    -0.04912196099758148,
                    -0.03324172645807266,
                    -0.03045559860765934,
                    0.006898557301610708,
                    -0.02055005542933941,
                    0.068382628262043,
                    -0.010054454207420349,
                    -0.0478021502494812,
                    -0.0711025521159172,
                    0.0003974135033786297,
                    -0.17908932268619537,
                    -0.028380397707223892,
                    0.037735532969236374,
                    -0.06823437660932541,
                    -0.004819164518266916,
                    0.09201900660991669,
                    0.043927647173404694,
                    -0.11423438787460327,
                    0.036272913217544556,
                    0.08452599495649338,
                    -0.1077919453382492,
                    0.021540069952607155,
                    0.1019405648112297,
                    -0.08142052590847015,
                    -0.04538758099079132,
                    -0.032373350113630295,
                    -0.004650554154068232,
                    0.12084804475307465,
                    0.03079046495258808,
                    0.06673470884561539,
                    0.06515134125947952
                ],
                "diffText": "diff --git a/source/extensions/filters/network/mongo_proxy/bson_impl.cc b/source/extensions/filters/network/mongo_proxy/bson_impl.cc\nindex bcf47011b2..8ea6cf0283 100644\n--- a/source/extensions/filters/network/mongo_proxy/bson_impl.cc\n+++ b/source/extensions/filters/network/mongo_proxy/bson_impl.cc\n@@ -98,7 +98,10 @@ std::string BufferHelper::removeString(Buffer::Instance& data) {\n   }\n \n   char* start = reinterpret_cast<char*>(data.linearize(length));\n-  std::string ret(start);\n+  // The BSON spec encodes both strings and C style strings with an additional\n+  // null byte, however strings may contain embedded null bytes, therefore the\n+  // constructor needs to be given the length of the string explicitly.\n+  std::string ret(start, length > 0 ? length - 1 : 0);\n   data.drain(length);\n   return ret;\n }\n"
            }
        },
        "relation2": {
            "identity": 23773,
            "start": 11458,
            "end": 11457,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 11457,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "source/extensions/filters/network/mongo_proxy/bson_impl.cc"
            }
        }
    },
    {
        "baseNode": {
            "identity": 11449,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-envoy-42797"
            }
        },
        "relation1": {
            "identity": 23770,
            "start": 11449,
            "end": 1037,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 1037,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "envoy"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11449,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-envoy-42797"
            }
        },
        "relation1": {
            "identity": 23769,
            "start": 11449,
            "end": 11456,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11456,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "Accepting input from '/tmp/poc'\nUsage for fuzzing: honggfuzz -P [flags] -- /out/network_writefilter_fuzz_test\nTestRandomGenerator running with seed -1805904456\nTestRandomGenerator running with seed -1805904456\n=================================================================\n==1==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x621000196100 at pc 0x0000011e90e6 bp 0x7ffc30645270 sp 0x7ffc30644a30\nREAD of size 4034 at 0x621000196100 thread T0\nSCARINESS: 26 (multi-byte-read-heap-buffer-overflow)\n    #0 0x11e90e5 in strlen /src/llvm-project/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:389:5\n    #1 0x34dee4c in length /usr/local/bin/../include/c++/v1/__string:344:53\n    #2 0x34dee4c in basic_string<std::nullptr_t> /usr/local/bin/../include/c++/v1/string:828:19\n    #3 0x34dee4c in Envoy::Extensions::NetworkFilters::MongoProxy::Bson::BufferHelper::removeString(Envoy::Buffer::Instance&) /proc/self/cwd/source/extensions/filters/network/mongo_proxy/bson_impl.cc:101:15\n    #4 0x34e88ef in Envoy::Extensions::NetworkFilters::MongoProxy::Bson::DocumentImpl::fromBuffer(Envoy::Buffer::Instance&) /proc/self/cwd/source/extensions/filters/network/mongo_proxy/bson_impl.cc:406:27\n    #5 0x34b9836 in Envoy::Extensions::NetworkFilters::MongoProxy::Bson::DocumentImpl::create(Envoy::Buffer::Instance&) /proc/self/cwd/./source/extensions/filters/network/mongo_proxy/bson_impl.h:187:14\n    #6 0x34bd9d9 in Envoy::Extensions::NetworkFilters::MongoProxy::QueryMessageImpl::fromBuffer(unsigned int, Envoy::Buffer::Instance&) /proc/self/cwd/source/extensions/filters/network/mongo_proxy/codec_impl.cc:144:12\n    #7 0x34cdaac in Envoy::Extensions::NetworkFilters::MongoProxy::DecoderImpl::decode(Envoy::Buffer::Instance&) /proc/self/cwd/source/extensions/filters/network/mongo_proxy/codec_impl.cc:377:14\n    #8 0x34d0314 in Envoy::Extensions::NetworkFilters::MongoProxy::DecoderImpl::onData(Envoy::Buffer::Instance&) /proc/self/cwd/source/extensions/filters/network/mongo_proxy/codec_impl.cc:428:31\n    #9 0x34ad945 in Envoy::Extensions::NetworkFilters::MongoProxy::ProxyFilter::doDecode(Envoy::Buffer::Instance&) /proc/self/cwd/source/extensions/filters/network/mongo_proxy/proxy.cc:339:15\n    #10 0x34aea58 in Envoy::Extensions::NetworkFilters::MongoProxy::ProxyFilter::onWrite(Envoy::Buffer::Instance&, bool) /proc/self/cwd/source/extensions/filters/network/mongo_proxy/proxy.cc:386:3\n    #11 0x12d1d2a in Envoy::Extensions::NetworkFilters::UberWriteFilterFuzzer::fuzz(envoy::config::listener::v3::Filter const&, google::protobuf::RepeatedPtrField<test::extensions::filters::network::WriteAction> const&) /proc/self/cwd/test/extensions/filters/network/common/fuzz/uber_writefilter.cc:99:22\n    #12 0x128be2d in TestOneProtoInput /proc/self/cwd/test/extensions/filters/network/common/fuzz/network_writefilter_fuzz_test.cc:49:12\n    #13 0x128be2d in LLVMFuzzerTestOneInput /proc/self/cwd/test/extensions/filters/network/common/fuzz/network_writefilter_fuzz_test.cc:13:1\n    #14 0x47728bb in main (/out/network_writefilter_fuzz_test+0x47728bb)\n    #15 0x7fe85c9ef082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)\n    #16 0x11d3ead in _start (/out/network_writefilter_fuzz_test+0x11d3ead)\n\nDEDUP_TOKEN: strlen--length--basic_string<std::nullptr_t>\n0x621000196100 is located 0 bytes to the right of 4096-byte region [0x621000195100,0x621000196100)\nallocated by thread T0 here:\n    #0 0x125479d in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:129:3\n    #1 0x47ee954 in operator new(unsigned long) (/out/network_writefilter_fuzz_test+0x47ee954)\n    #2 0x3fa950f in Envoy::Buffer::Slice::Slice(unsigned long, std::__1::shared_ptr<Envoy::Buffer::BufferMemoryAccount>, absl::optional<Envoy::Buffer::Slice::FreeListReference>) /proc/self/cwd/./source/common/buffer/buffer_impl.h:64:54\n    #3 0x3fa8ecb in Envoy::Buffer::OwnedImpl::addImpl(void const*, unsigned long) /proc/self/cwd/source/common/buffer/buffer_impl.cc:29:28\n    #4 0x3fabf6c in Envoy::Buffer::OwnedImpl::add(void const*, unsigned long) /proc/self/cwd/source/common/buffer/buffer_impl.cc:51:56\n    #5 0x3facea7 in Envoy::Buffer::OwnedImpl::add(Envoy::Buffer::Instance const&) /proc/self/cwd/source/common/buffer/buffer_impl.cc:63:5\n    #6 0x34aea4d in Envoy::Extensions::NetworkFilters::MongoProxy::ProxyFilter::onWrite(Envoy::Buffer::Instance&, bool) /proc/self/cwd/source/extensions/filters/network/mongo_proxy/proxy.cc:385:17\n    #7 0x12d1d2a in Envoy::Extensions::NetworkFilters::UberWriteFilterFuzzer::fuzz(envoy::config::listener::v3::Filter const&, google::protobuf::RepeatedPtrField<test::extensions::filters::network::WriteAction> const&) /proc/self/cwd/test/extensions/filters/network/common/fuzz/uber_writefilter.cc:99:22\n    #8 0x128be2d in TestOneProtoInput /proc/self/cwd/test/extensions/filters/network/common/fuzz/network_writefilter_fuzz_test.cc:49:12\n    #9 0x128be2d in LLVMFuzzerTestOneInput /proc/self/cwd/test/extensions/filters/network/common/fuzz/network_writefilter_fuzz_test.cc:13:1\n    #10 0x47728bb in main (/out/network_writefilter_fuzz_test+0x47728bb)\n\nDEDUP_TOKEN: malloc--operator new(unsigned long)--Envoy::Buffer::Slice::Slice(unsigned long, std::__1::shared_ptr<Envoy::Buffer::BufferMemoryAccount>, absl::optional<Envoy::Buffer::Slice::FreeListReference>)\nSUMMARY: AddressSanitizer: heap-buffer-overflow /src/llvm-project/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:389:5 in strlen\nShadow bytes around the buggy address:\n  0x0c428002abd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c428002abe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c428002abf0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c428002ac00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c428002ac10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=>0x0c428002ac20:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c428002ac30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c428002ac40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c428002ac50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c428002ac60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c428002ac70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.05230841413140297,
                    0.023198358714580536,
                    -0.055371999740600586,
                    0.023593535646796227,
                    -0.011541039682924747,
                    -0.023229068145155907,
                    -0.004140170756727457,
                    -0.013878871686756611,
                    0.07505659013986588,
                    -0.02217043936252594,
                    -0.012598734349012375,
                    -0.02560785599052906,
                    0.012759027071297169,
                    0.028818391263484955,
                    0.023707576096057892,
                    0.004133128095418215,
                    0.04383133351802826,
                    0.011662662960588932,
                    0.019898081198334694,
                    0.0630694180727005,
                    -0.053544532507658005,
                    0.03289395198225975,
                    -0.07389873266220093,
                    -0.012234586291015148,
                    -0.06080147624015808,
                    0.05709284171462059,
                    -0.09565340727567673,
                    0.012165278196334839,
                    -0.02837555669248104,
                    -0.05198270455002785,
                    -0.08648094534873962,
                    -0.11398861557245255,
                    -0.06914866715669632,
                    -0.040389589965343475,
                    -0.015765585005283356,
                    -0.03339511901140213,
                    0.0029996794182807207,
                    -0.011888002045452595,
                    0.02474379539489746,
                    0.09753753989934921,
                    -0.04036437347531319,
                    -0.007481394801288843,
                    0.007791902869939804,
                    0.0257136020809412,
                    -0.08825261145830154,
                    0.047584373503923416,
                    0.0016629965975880623,
                    -0.056175947189331055,
                    0.004089489113539457,
                    -0.009836954064667225,
                    -0.08110497146844864,
                    0.02409845031797886,
                    -0.052681565284729004,
                    -0.05813920497894287,
                    -0.048446815460920334,
                    -0.05576116964221001,
                    0.05914241075515747,
                    0.035809338092803955,
                    -0.0512845553457737,
                    0.08586174994707108,
                    0.05204767361283302,
                    -0.025173388421535492,
                    0.011086836457252502,
                    -0.018495073541998863,
                    -0.028976261615753174,
                    0.04277937114238739,
                    0.05440865457057953,
                    0.04261012002825737,
                    -0.022580191493034363,
                    0.005186992231756449,
                    0.038686927407979965,
                    0.1240495815873146,
                    -0.07292312383651733,
                    -0.14009158313274384,
                    -0.027390355244278908,
                    0.03868779167532921,
                    -0.06543757021427155,
                    -0.043362807482481,
                    -0.0439809150993824,
                    -0.06667467206716537,
                    -0.029296336695551872,
                    0.0024837844539433718,
                    0.02370547503232956,
                    0.051942769438028336,
                    -0.011325731873512268,
                    0.04070623964071274,
                    0.021675949916243553,
                    -0.051621872931718826,
                    0.02511759288609028,
                    0.014022131450474262,
                    0.07882729917764664,
                    -0.08734974265098572,
                    -0.001703685731627047,
                    -0.0007437821477651596,
                    0.0005796247278340161,
                    0.040124617516994476,
                    0.00011914937203982845,
                    -0.03703422471880913,
                    -0.04725852236151695,
                    0.03228164091706276,
                    -0.02222364954650402,
                    -0.026011718437075615,
                    0.003742462955415249,
                    -0.026390716433525085,
                    -0.026081716641783714,
                    0.025047248229384422,
                    -0.024679502472281456,
                    -0.03879702091217041,
                    0.001652578474022448,
                    -0.022799117490649223,
                    -0.005561792757362127,
                    -0.04464265704154968,
                    -0.04665546491742134,
                    0.056339070200920105,
                    0.07993166893720627,
                    0.009907040745019913,
                    -0.05184343457221985,
                    0.01768103800714016,
                    -0.024082599207758904,
                    0.08157345652580261,
                    0.09563463926315308,
                    -0.045475367456674576,
                    -0.016919992864131927,
                    -0.04268680885434151,
                    -0.028454655781388283,
                    -0.03514661267399788,
                    0.02923651970922947,
                    -0.011552028357982635,
                    0.02722986973822117,
                    0.06808073073625565,
                    -0.03403743356466293,
                    0.017310475930571556,
                    0.06018300727009773,
                    -0.004139516036957502,
                    -0.05094548687338829,
                    0.017839163541793823,
                    0.05705171823501587,
                    -0.024340534582734108,
                    0.05186242237687111,
                    -0.049324993044137955,
                    0.04849599301815033,
                    0.021684324368834496,
                    0.0009969047969207168,
                    -0.00994607899338007,
                    0.024322323501110077,
                    -0.049235645681619644,
                    0.02937276102602482,
                    -0.0025280441623181105,
                    -0.01795380748808384,
                    0.03836050257086754,
                    -0.0125281335785985,
                    -0.03101065196096897,
                    -0.06815765053033829,
                    -0.00519246980547905,
                    -0.015093408524990082,
                    -0.024721933528780937,
                    -0.013586116023361683,
                    -0.007470855955034494,
                    -0.03684740513563156,
                    0.03612879663705826,
                    0.0018694065511226654,
                    0.1328262835741043,
                    -0.02315642684698105,
                    0.13859663903713226,
                    -0.04588402435183525,
                    0.09744676202535629,
                    -0.019585436210036278,
                    0.04096383973956108,
                    0.015874726697802544,
                    -0.0020813122391700745,
                    -0.061672281473875046,
                    -0.05618967115879059,
                    -0.037258487194776535,
                    -0.006938705686479807,
                    -0.029980942606925964,
                    0.01821862906217575,
                    -0.012235541827976704,
                    0.04261977598071098,
                    0.08299817889928818,
                    0.0032430526334792376,
                    0.04973302781581879,
                    0.07658246904611588,
                    -0.057823557406663895,
                    -0.010392875410616398,
                    0.011379051022231579,
                    -0.01266599353402853,
                    -0.1092865839600563,
                    -0.07562857866287231,
                    0.008279100060462952,
                    0.013512133620679379,
                    -0.007433396298438311,
                    -0.0264881681650877,
                    0.009882527403533459,
                    0.0004210546612739563,
                    -0.08612778782844543,
                    -0.043919216841459274,
                    0.014357601292431355,
                    0.07434970885515213,
                    0.024757640436291695,
                    -0.10427110642194748,
                    -0.03252958506345749,
                    -0.01259098295122385,
                    0.07546710222959518,
                    -0.02407226897776127,
                    0.015960590913891792,
                    -0.06566891819238663,
                    0.10886579006910324,
                    -0.003401482477784157,
                    0.07537588477134705,
                    0.012665894813835621,
                    0.017031267285346985,
                    -0.019361158832907677,
                    0.1140015497803688,
                    0.013547562062740326,
                    0.010431874543428421,
                    -0.08802464604377747,
                    0.05748463794589043,
                    -0.023602193221449852,
                    -0.023548921570181847,
                    0.03735704720020294,
                    -0.01733158342540264,
                    0.03368167579174042,
                    -0.06083150580525398,
                    -0.043075382709503174,
                    0.03407709673047066,
                    -0.03363460302352905,
                    -0.01257235836237669,
                    0.06832456588745117,
                    0.038751255720853806,
                    0.010104809887707233,
                    -0.03467746451497078,
                    -0.029528813436627388,
                    -0.011879980564117432,
                    0.02640998363494873,
                    -0.038424696773290634,
                    -0.0109321353957057,
                    0.06521209329366684,
                    0.017944898456335068,
                    -0.052010875195264816,
                    -0.0468001551926136,
                    0.025261277332901955,
                    0.02519829012453556,
                    -0.048417285084724426,
                    -0.0071383570320904255,
                    0.08325109630823135,
                    -0.05848762020468712,
                    -0.0443568117916584,
                    0.05846942588686943,
                    -0.004397301934659481,
                    0.01977466605603695,
                    -0.06473084539175034,
                    -0.03510231152176857,
                    0.10308128595352173,
                    0.006793266627937555,
                    0.08864450454711914,
                    -0.007914640940725803
                ],
                "report_type": "Heap-buffer-overflow READ {*}",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11449,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-envoy-42797"
            }
        },
        "relation1": {
            "identity": 23768,
            "start": 11449,
            "end": 11454,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11454,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "mongo proxy bson: fix OOB read in removeString (#24730)\n\nSigned-off-by: Robert Femmer <robert.femmer@x41-dsec.de>",
                "sha": "812c6a02e850f220668184cfd5eefce896ee69fa",
                "repo": "envoy",
                "encoding": "UTF-8",
                "authored_date": 1673467350,
                "committer_tz_offset": 25200,
                "author_tz_offset": -3600,
                "committed_date": 1673467350
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 11449,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-envoy-42797"
            }
        },
        "relation1": {
            "identity": 23763,
            "start": 11449,
            "end": 11450,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 11450,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "ci: increase flaky test's timeout value (#24885)\n\nCommit Message: Test seems to be occasionally failing due to a timeout issue. Increasing the timeout to 10s which is the value used by the corresponding Android test. https://github.com/envoyproxy/envoy/actions/runs/3895393172/jobs/6650658874\r\nAdditional Description:\r\nRisk Level: Low\r\nTesting:\r\nDocs Changes:\r\nRelease Notes:\r\nPlatform Specific Features:\r\n[Optional Runtime guard:]\r\n[Optional Fixes #Issue]\r\n[Optional Fixes commit #PR or SHA]\r\n[Optional Deprecated:]\r\n[Optional [API Considerations](https://github.com/envoyproxy/envoy/blob/main/api/review_checklist.md):]\r\n",
                "sha": "91f2170907b81841001e822fb63d07020d4ca124",
                "repo": "envoy",
                "encoding": "UTF-8",
                "authored_date": 1673463743,
                "committer_tz_offset": 0,
                "author_tz_offset": 18000,
                "committed_date": 1673463743
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]