[
    {
        "baseNode": {
            "identity": 1008,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36485"
            }
        },
        "relation1": {
            "identity": 1748,
            "start": 1008,
            "end": 1018,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 1018,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.04304296523332596,
                    -0.06382125616073608,
                    -0.07523791491985321,
                    0.1099025160074234,
                    -0.012928369455039501,
                    0.03995692357420921,
                    -0.09995661675930023,
                    0.021496612578630447,
                    0.0540076345205307,
                    -0.019718149676918983,
                    -0.002464126795530319,
                    -0.005988101940602064,
                    -0.06451265513896942,
                    -0.06289224326610565,
                    -0.02248244918882847,
                    -0.09082663804292679,
                    -0.04203595593571663,
                    0.0177979227155447,
                    -0.017391951754689217,
                    0.0011010579764842987,
                    -0.08158835023641586,
                    0.04319433867931366,
                    -0.05279887467622757,
                    0.08380448818206787,
                    0.04411305859684944,
                    -0.026790708303451538,
                    -0.02185327559709549,
                    -0.03350546956062317,
                    0.048730142414569855,
                    0.007156583946198225,
                    -0.09428919851779938,
                    -0.07897841930389404,
                    0.03972578048706055,
                    -0.014165599830448627,
                    -0.050353050231933594,
                    0.018676718696951866,
                    0.0532730296254158,
                    -0.010664942674338818,
                    0.0644061341881752,
                    0.07756593078374863,
                    -0.07346777617931366,
                    -0.04906525835394859,
                    -0.023331910371780396,
                    0.08638203889131546,
                    -0.15863189101219177,
                    -0.024201758205890656,
                    0.040911540389060974,
                    -0.07572305202484131,
                    0.015977846458554268,
                    0.04739348962903023,
                    -0.1374014914035797,
                    0.01974252425134182,
                    -0.10613931715488434,
                    0.001660869107581675,
                    -0.022071175277233124,
                    -0.012848352082073689,
                    -0.028157884255051613,
                    -0.005860868841409683,
                    -0.0987079069018364,
                    -0.01853286661207676,
                    0.026126598939299583,
                    -0.006647549103945494,
                    0.0007142219692468643,
                    -0.12657783925533295,
                    0.04165620729327202,
                    -0.03209507837891579,
                    0.08988840132951736,
                    -0.05235453322529793,
                    0.09163238853216171,
                    -0.054580748081207275,
                    0.048716265708208084,
                    -0.028191743418574333,
                    -0.0678064376115799,
                    0.07322371751070023,
                    -0.006168612278997898,
                    0.037946898490190506,
                    -0.049160901457071304,
                    0.009156635962426662,
                    -0.007215571124106646,
                    -0.11970097571611404,
                    0.01122116856276989,
                    0.03727139160037041,
                    -0.09551738947629929,
                    0.018162796273827553,
                    0.0028905970975756645,
                    -0.008974205702543259,
                    0.060064464807510376,
                    0.0001991464087041095,
                    0.1254204511642456,
                    -0.05336303636431694,
                    0.03392553701996803,
                    -0.04553844407200813,
                    0.015543893910944462,
                    0.0908588320016861,
                    -0.04345626384019852,
                    0.019223764538764954,
                    -0.02347664348781109,
                    -0.02453710325062275,
                    -0.04319136217236519,
                    -0.058202892541885376,
                    -0.035968244075775146,
                    -0.03610828146338463,
                    -0.1403299868106842,
                    -0.0563320517539978,
                    0.004877427592873573,
                    -0.0825318768620491,
                    -0.05817440152168274,
                    0.02958488278090954,
                    0.04444585740566254,
                    -0.03873857855796814,
                    0.01132875680923462,
                    0.0437844879925251,
                    0.026312513276934624,
                    0.02730701118707657,
                    0.034878868609666824,
                    -0.06835956871509552,
                    -0.07448425143957138,
                    0.0840645506978035,
                    0.0389179103076458,
                    -0.037576328963041306,
                    0.13997480273246765,
                    0.0597052238881588,
                    -0.0835295245051384,
                    -0.1452828049659729,
                    -0.12417752295732498,
                    -0.09329245984554291,
                    -0.03361942991614342,
                    0.11483579874038696,
                    0.03627057746052742,
                    0.1383291631937027,
                    -0.1295691728591919,
                    0.007967885583639145,
                    0.0073944455944001675,
                    -0.03706793859601021,
                    0.09755603224039078,
                    -0.019467392936348915,
                    0.043065086007118225,
                    -0.009855791926383972,
                    0.12271851301193237,
                    -0.015609164722263813,
                    -0.04386712983250618,
                    0.09789594262838364,
                    0.1298585683107376,
                    0.009220873937010765,
                    0.07541503012180328,
                    -0.05302134528756142,
                    0.07552657276391983,
                    -0.014556603506207466,
                    -0.07402626425027847,
                    -0.059763699769973755,
                    -0.04349641129374504,
                    -0.007624584250152111,
                    -0.12790748476982117,
                    -0.043925754725933075,
                    -0.006410904694348574,
                    0.06437060236930847,
                    -0.03706347942352295,
                    0.02698570489883423,
                    -0.0023756525479257107,
                    -0.013189250603318214,
                    -0.03919966518878937,
                    0.026254937052726746,
                    0.10335886478424072,
                    0.1187601163983345,
                    0.117554672062397,
                    0.13304051756858826,
                    0.042619332671165466,
                    0.03425634652376175,
                    -0.07178883254528046,
                    0.0335308238863945,
                    0.024986641481518745,
                    0.0725799947977066,
                    -0.015173927880823612,
                    -0.0353921614587307,
                    0.049020759761333466,
                    -0.0673958957195282,
                    0.0720270574092865,
                    -0.0019913255237042904,
                    -0.07696200162172318,
                    -0.10911472886800766,
                    0.015751270577311516,
                    0.03853893652558327,
                    -0.02797159180045128,
                    -0.02123032882809639,
                    0.06387721747159958,
                    -0.05206551402807236,
                    -0.0018573884153738618,
                    -0.0969439446926117,
                    -0.08540802448987961,
                    0.026297342032194138,
                    0.03594735637307167,
                    -0.03902442753314972,
                    0.010749748907983303,
                    -0.04234280437231064,
                    -0.04495326057076454,
                    -0.01837490126490593,
                    -0.044471994042396545,
                    -0.012425214052200317,
                    0.010402271524071693,
                    -0.07204767316579819,
                    -0.00804322399199009,
                    -0.04499328136444092,
                    0.01850808598101139,
                    0.1307314932346344,
                    0.05391255393624306,
                    0.016279973089694977,
                    0.06492055952548981,
                    -0.11365760862827301,
                    0.046037349849939346,
                    0.04581204429268837,
                    0.08682319521903992,
                    -0.04276483878493309,
                    0.18631614744663239,
                    0.12254860252141953,
                    -0.0029794564470648766,
                    -0.10126543045043945,
                    -0.021586010232567787,
                    0.08319122344255447,
                    0.09074514359235764,
                    0.06776280701160431,
                    0.019390245899558067,
                    -0.035063330084085464,
                    0.036116454750299454,
                    -0.01978744938969612,
                    -0.010668533854186535,
                    -0.02661740779876709,
                    0.033008873462677,
                    -0.005652976222336292,
                    0.02151559852063656,
                    -0.00800919160246849,
                    -0.06511112302541733,
                    -0.006439353339374065,
                    -0.04068230837583542,
                    -0.006481110118329525,
                    0.0843462124466896,
                    -0.032219432294368744,
                    0.09321247041225433,
                    0.041559625416994095,
                    -0.054738108068704605,
                    -0.08055558800697327,
                    0.0003456666017882526,
                    0.005974762141704559,
                    -0.02437048777937889,
                    -0.030025336891412735,
                    0.10170258581638336,
                    0.007462686859071255,
                    -0.07633805274963379,
                    0.030919646844267845,
                    -0.09031344205141068,
                    0.052137505263090134,
                    0.010544427670538425,
                    0.05896627902984619,
                    0.0261639766395092,
                    0.05888856574892998,
                    -0.02392842434346676,
                    -0.07688536494970322
                ],
                "diffText": "diff --git a/lib/jxl/modular/transform/squeeze.cc b/lib/jxl/modular/transform/squeeze.cc\nindex fd8867b7..947bcda7 100644\n--- a/lib/jxl/modular/transform/squeeze.cc\n+++ b/lib/jxl/modular/transform/squeeze.cc\n@@ -295,6 +295,12 @@ Status InvSqueeze(Image &input, std::vector<SqueezeParams> parameters,\n     } else {\n       offset = input.channel.size() + beginc - endc - 1;\n     }\n+    if (beginc < input.nb_meta_channels) {\n+      // This is checked in MetaSqueeze.\n+      JXL_ASSERT(input.nb_meta_channels > parameters[i].num_c);\n+      input.nb_meta_channels -= parameters[i].num_c;\n+    }\n+\n     for (uint32_t c = beginc; c <= endc; c++) {\n       uint32_t rc = offset + c - beginc;\n       if ((input.channel[c].w < input.channel[rc].w) ||"
            }
        },
        "relation2": {
            "identity": 1748,
            "start": 1018,
            "end": 1008,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 1008,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36485"
            }
        }
    },
    {
        "baseNode": {
            "identity": 1008,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36485"
            }
        },
        "relation1": {
            "identity": 1748,
            "start": 1008,
            "end": 1018,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 1018,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.04304296523332596,
                    -0.06382125616073608,
                    -0.07523791491985321,
                    0.1099025160074234,
                    -0.012928369455039501,
                    0.03995692357420921,
                    -0.09995661675930023,
                    0.021496612578630447,
                    0.0540076345205307,
                    -0.019718149676918983,
                    -0.002464126795530319,
                    -0.005988101940602064,
                    -0.06451265513896942,
                    -0.06289224326610565,
                    -0.02248244918882847,
                    -0.09082663804292679,
                    -0.04203595593571663,
                    0.0177979227155447,
                    -0.017391951754689217,
                    0.0011010579764842987,
                    -0.08158835023641586,
                    0.04319433867931366,
                    -0.05279887467622757,
                    0.08380448818206787,
                    0.04411305859684944,
                    -0.026790708303451538,
                    -0.02185327559709549,
                    -0.03350546956062317,
                    0.048730142414569855,
                    0.007156583946198225,
                    -0.09428919851779938,
                    -0.07897841930389404,
                    0.03972578048706055,
                    -0.014165599830448627,
                    -0.050353050231933594,
                    0.018676718696951866,
                    0.0532730296254158,
                    -0.010664942674338818,
                    0.0644061341881752,
                    0.07756593078374863,
                    -0.07346777617931366,
                    -0.04906525835394859,
                    -0.023331910371780396,
                    0.08638203889131546,
                    -0.15863189101219177,
                    -0.024201758205890656,
                    0.040911540389060974,
                    -0.07572305202484131,
                    0.015977846458554268,
                    0.04739348962903023,
                    -0.1374014914035797,
                    0.01974252425134182,
                    -0.10613931715488434,
                    0.001660869107581675,
                    -0.022071175277233124,
                    -0.012848352082073689,
                    -0.028157884255051613,
                    -0.005860868841409683,
                    -0.0987079069018364,
                    -0.01853286661207676,
                    0.026126598939299583,
                    -0.006647549103945494,
                    0.0007142219692468643,
                    -0.12657783925533295,
                    0.04165620729327202,
                    -0.03209507837891579,
                    0.08988840132951736,
                    -0.05235453322529793,
                    0.09163238853216171,
                    -0.054580748081207275,
                    0.048716265708208084,
                    -0.028191743418574333,
                    -0.0678064376115799,
                    0.07322371751070023,
                    -0.006168612278997898,
                    0.037946898490190506,
                    -0.049160901457071304,
                    0.009156635962426662,
                    -0.007215571124106646,
                    -0.11970097571611404,
                    0.01122116856276989,
                    0.03727139160037041,
                    -0.09551738947629929,
                    0.018162796273827553,
                    0.0028905970975756645,
                    -0.008974205702543259,
                    0.060064464807510376,
                    0.0001991464087041095,
                    0.1254204511642456,
                    -0.05336303636431694,
                    0.03392553701996803,
                    -0.04553844407200813,
                    0.015543893910944462,
                    0.0908588320016861,
                    -0.04345626384019852,
                    0.019223764538764954,
                    -0.02347664348781109,
                    -0.02453710325062275,
                    -0.04319136217236519,
                    -0.058202892541885376,
                    -0.035968244075775146,
                    -0.03610828146338463,
                    -0.1403299868106842,
                    -0.0563320517539978,
                    0.004877427592873573,
                    -0.0825318768620491,
                    -0.05817440152168274,
                    0.02958488278090954,
                    0.04444585740566254,
                    -0.03873857855796814,
                    0.01132875680923462,
                    0.0437844879925251,
                    0.026312513276934624,
                    0.02730701118707657,
                    0.034878868609666824,
                    -0.06835956871509552,
                    -0.07448425143957138,
                    0.0840645506978035,
                    0.0389179103076458,
                    -0.037576328963041306,
                    0.13997480273246765,
                    0.0597052238881588,
                    -0.0835295245051384,
                    -0.1452828049659729,
                    -0.12417752295732498,
                    -0.09329245984554291,
                    -0.03361942991614342,
                    0.11483579874038696,
                    0.03627057746052742,
                    0.1383291631937027,
                    -0.1295691728591919,
                    0.007967885583639145,
                    0.0073944455944001675,
                    -0.03706793859601021,
                    0.09755603224039078,
                    -0.019467392936348915,
                    0.043065086007118225,
                    -0.009855791926383972,
                    0.12271851301193237,
                    -0.015609164722263813,
                    -0.04386712983250618,
                    0.09789594262838364,
                    0.1298585683107376,
                    0.009220873937010765,
                    0.07541503012180328,
                    -0.05302134528756142,
                    0.07552657276391983,
                    -0.014556603506207466,
                    -0.07402626425027847,
                    -0.059763699769973755,
                    -0.04349641129374504,
                    -0.007624584250152111,
                    -0.12790748476982117,
                    -0.043925754725933075,
                    -0.006410904694348574,
                    0.06437060236930847,
                    -0.03706347942352295,
                    0.02698570489883423,
                    -0.0023756525479257107,
                    -0.013189250603318214,
                    -0.03919966518878937,
                    0.026254937052726746,
                    0.10335886478424072,
                    0.1187601163983345,
                    0.117554672062397,
                    0.13304051756858826,
                    0.042619332671165466,
                    0.03425634652376175,
                    -0.07178883254528046,
                    0.0335308238863945,
                    0.024986641481518745,
                    0.0725799947977066,
                    -0.015173927880823612,
                    -0.0353921614587307,
                    0.049020759761333466,
                    -0.0673958957195282,
                    0.0720270574092865,
                    -0.0019913255237042904,
                    -0.07696200162172318,
                    -0.10911472886800766,
                    0.015751270577311516,
                    0.03853893652558327,
                    -0.02797159180045128,
                    -0.02123032882809639,
                    0.06387721747159958,
                    -0.05206551402807236,
                    -0.0018573884153738618,
                    -0.0969439446926117,
                    -0.08540802448987961,
                    0.026297342032194138,
                    0.03594735637307167,
                    -0.03902442753314972,
                    0.010749748907983303,
                    -0.04234280437231064,
                    -0.04495326057076454,
                    -0.01837490126490593,
                    -0.044471994042396545,
                    -0.012425214052200317,
                    0.010402271524071693,
                    -0.07204767316579819,
                    -0.00804322399199009,
                    -0.04499328136444092,
                    0.01850808598101139,
                    0.1307314932346344,
                    0.05391255393624306,
                    0.016279973089694977,
                    0.06492055952548981,
                    -0.11365760862827301,
                    0.046037349849939346,
                    0.04581204429268837,
                    0.08682319521903992,
                    -0.04276483878493309,
                    0.18631614744663239,
                    0.12254860252141953,
                    -0.0029794564470648766,
                    -0.10126543045043945,
                    -0.021586010232567787,
                    0.08319122344255447,
                    0.09074514359235764,
                    0.06776280701160431,
                    0.019390245899558067,
                    -0.035063330084085464,
                    0.036116454750299454,
                    -0.01978744938969612,
                    -0.010668533854186535,
                    -0.02661740779876709,
                    0.033008873462677,
                    -0.005652976222336292,
                    0.02151559852063656,
                    -0.00800919160246849,
                    -0.06511112302541733,
                    -0.006439353339374065,
                    -0.04068230837583542,
                    -0.006481110118329525,
                    0.0843462124466896,
                    -0.032219432294368744,
                    0.09321247041225433,
                    0.041559625416994095,
                    -0.054738108068704605,
                    -0.08055558800697327,
                    0.0003456666017882526,
                    0.005974762141704559,
                    -0.02437048777937889,
                    -0.030025336891412735,
                    0.10170258581638336,
                    0.007462686859071255,
                    -0.07633805274963379,
                    0.030919646844267845,
                    -0.09031344205141068,
                    0.052137505263090134,
                    0.010544427670538425,
                    0.05896627902984619,
                    0.0261639766395092,
                    0.05888856574892998,
                    -0.02392842434346676,
                    -0.07688536494970322
                ],
                "diffText": "diff --git a/lib/jxl/modular/transform/squeeze.cc b/lib/jxl/modular/transform/squeeze.cc\nindex fd8867b7..947bcda7 100644\n--- a/lib/jxl/modular/transform/squeeze.cc\n+++ b/lib/jxl/modular/transform/squeeze.cc\n@@ -295,6 +295,12 @@ Status InvSqueeze(Image &input, std::vector<SqueezeParams> parameters,\n     } else {\n       offset = input.channel.size() + beginc - endc - 1;\n     }\n+    if (beginc < input.nb_meta_channels) {\n+      // This is checked in MetaSqueeze.\n+      JXL_ASSERT(input.nb_meta_channels > parameters[i].num_c);\n+      input.nb_meta_channels -= parameters[i].num_c;\n+    }\n+\n     for (uint32_t c = beginc; c <= endc; c++) {\n       uint32_t rc = offset + c - beginc;\n       if ((input.channel[c].w < input.channel[rc].w) ||"
            }
        },
        "relation2": {
            "identity": 1747,
            "start": 1018,
            "end": 1017,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 1017,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "lib/jxl/modular/transform/squeeze.cc"
            }
        }
    },
    {
        "baseNode": {
            "identity": 1008,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36485"
            }
        },
        "relation1": {
            "identity": 1744,
            "start": 1008,
            "end": 1007,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 1007,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "libjxl"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 1008,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36485"
            }
        },
        "relation1": {
            "identity": 1743,
            "start": 1008,
            "end": 1016,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 1016,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "INFO: Running with entropic power schedule (0xFF, 100).\nINFO: Seed: 1681935266\nINFO: Loaded 1 modules   (32380 inline 8-bit counters): 32380 [0x556baee7bd88, 0x556baee83c04), \nINFO: Loaded 1 PC tables (32380 PCs): 32380 [0x556baee83c08,0x556baef023c8), \n/out/djxl_fuzzer: Running 1 inputs 1 time(s) each.\nRunning: /tmp/poc\n=================================================================\n==1==ERROR: AddressSanitizer: container-overflow on address 0x618000000740 at pc 0x556bae7fef0d bp 0x7fff24ef6350 sp 0x7fff24ef6348\nREAD of size 8 at 0x618000000740 thread T0\nSCARINESS: 23 (8-byte-read-container-overflow)\n    #0 0x556bae7fef0c in jxl::InvSqueeze(jxl::Image&, std::__1::vector<jxl::SqueezeParams, std::__1::allocator<jxl::SqueezeParams> >, jxl::ThreadPool*) /src/libjxl/lib/jxl/modular/transform/squeeze.cc:300:51\n    #1 0x556bae54bd9e in jxl::Transform::Inverse(jxl::Image&, jxl::weighted::Header const&, jxl::ThreadPool*) /src/libjxl/lib/jxl/modular/transform/transform.cc:30:14\n    #2 0x556bae5463f6 in jxl::Image::undo_transforms(jxl::weighted::Header const&, int, jxl::ThreadPool*) /src/libjxl/lib/jxl/modular/modular_image.cc:20:23\n    #3 0x556bae71ee75 in jxl::ModularFrameDecoder::FinalizeDecoding(jxl::PassesDecoderState*, jxl::ThreadPool*, jxl::ImageBundle*) /src/libjxl/lib/jxl/dec_modular.cc:591:6\n    #4 0x556bae5da2a5 in jxl::FrameDecoder::Flush() /src/libjxl/lib/jxl/dec_frame.cc:814:3\n    #5 0x556bae5cebb8 in jxl::FrameDecoder::FinalizeFrame() /src/libjxl/lib/jxl/dec_frame.cc:912:3\n    #6 0x556bae5c83a8 in jxl::DecodeFrame(jxl::DecompressParams const&, jxl::PassesDecoderState*, jxl::ThreadPool*, jxl::BitReader*, jxl::ImageBundle*, jxl::CodecMetadata const&, jxl::SizeConstraints const*, bool) /src/libjxl/lib/jxl/dec_frame.cc:230:3\n    #7 0x556bae476c9a in jxl::(anonymous namespace)::JxlDecoderProcessInternal(JxlDecoderStruct*, unsigned char const*, unsigned long) /src/libjxl/lib/jxl/decode.cc:1088:12\n    #8 0x556bae46ce54 in JxlDecoderProcessInput /src/libjxl/lib/jxl/decode.cc:1756:14\n    #9 0x556bae45b44e in DecodeJpegXl /src/libjxl/tools/djxl_fuzzer.cc:168:31\n    #10 0x556bae45b44e in TestOneInput /src/libjxl/tools/djxl_fuzzer.cc:497:3\n    #11 0x556bae45b44e in LLVMFuzzerTestOneInput /src/libjxl/tools/djxl_fuzzer.cc:507:10\n    #12 0x556bae35d1b3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15\n    #13 0x556bae3488f2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6\n    #14 0x556bae34e5ce in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9\n    #15 0x556bae3780b2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #16 0x7f637905a83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n    #17 0x556bae323998 in _start (/out/djxl_fuzzer+0x123998)\n\nDEDUP_TOKEN: jxl::InvSqueeze(jxl::Image&, std::__1::vector<jxl::SqueezeParams, std::__1::allocator<jxl::SqueezeParams> >, jxl::ThreadPool*)--jxl::Transform::Inverse(jxl::Image&, jxl::weighted::Header const&, jxl::ThreadPool*)--jxl::Image::undo_transforms(jxl::weighted::Header const&, int, jxl::ThreadPool*)\n0x618000000740 is located 704 bytes inside of 896-byte region [0x618000000480,0x618000000800)\nallocated by thread T0 here:\n    #0 0x556bae45752d in operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:99:3\n    #1 0x556bae54f23e in __libcpp_operator_new<unsigned long> /usr/local/bin/../include/c++/v1/new:235:10\n    #2 0x556bae54f23e in __libcpp_allocate /usr/local/bin/../include/c++/v1/new:261:10\n    #3 0x556bae54f23e in allocate /usr/local/bin/../include/c++/v1/memory:840:38\n    #4 0x556bae54f23e in allocate /usr/local/bin/../include/c++/v1/__memory/allocator_traits.h:260:20\n    #5 0x556bae54f23e in __split_buffer /usr/local/bin/../include/c++/v1/__split_buffer:314:29\n    #6 0x556bae54f23e in std::__1::vector<jxl::Channel, std::__1::allocator<jxl::Channel> >::insert(std::__1::__wrap_iter<jxl::Channel const*>, jxl::Channel&&) /usr/local/bin/../include/c++/v1/vector:1827:53\n    #7 0x556bae7fe535 in jxl::MetaSqueeze(jxl::Image&, std::__1::vector<jxl::SqueezeParams, std::__1::allocator<jxl::SqueezeParams> >*) /src/libjxl/lib/jxl/modular/transform/squeeze.cc:272:21\n    #8 0x556bae54e0fb in jxl::Transform::MetaApply(jxl::Image&) /src/libjxl/lib/jxl/modular/transform/transform.cc:64:14\n    #9 0x556bae53975b in jxl::ModularDecode(jxl::BitReader*, jxl::Image&, jxl::GroupHeader&, unsigned long, jxl::ModularOptions*, std::__1::vector<jxl::PropertyDecisionNode, std::__1::allocator<jxl::PropertyDecisionNode> > const*, jxl::ANSCode const*, std::__1::vector<unsigned char, std::__1::allocator<unsigned char> > const*, bool) /src/libjxl/lib/jxl/modular/encoding/encoding.cc:394:5\n    #10 0x556bae53b246 in jxl::ModularGenericDecompress(jxl::BitReader*, jxl::Image&, jxl::GroupHeader*, unsigned long, jxl::ModularOptions*, int, std::__1::vector<jxl::PropertyDecisionNode, std::__1::allocator<jxl::PropertyDecisionNode> > const*, jxl::ANSCode const*, std::__1::vector<unsigned char, std::__1::allocator<unsigned char> > const*, bool) /src/libjxl/lib/jxl/modular/encoding/encoding.cc:505:21\n    #11 0x556bae71276a in jxl::ModularFrameDecoder::DecodeGlobalInfo(jxl::BitReader*, jxl::FrameHeader const&, bool) /src/libjxl/lib/jxl/dec_modular.cc:209:23\n    #12 0x556bae5d1ba6 in jxl::FrameDecoder::ProcessDCGlobal(jxl::BitReader*) /src/libjxl/lib/jxl/dec_frame.cc:374:46\n    #13 0x556bae5cc6c1 in jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*) /src/libjxl/lib/jxl/dec_frame.cc:656:31\n    #14 0x556bae5c7d42 in jxl::DecodeFrame(jxl::DecompressParams const&, jxl::PassesDecoderState*, jxl::ThreadPool*, jxl::BitReader*, jxl::ImageBundle*, jxl::CodecMetadata const&, jxl::SizeConstraints const*, bool) /src/libjxl/lib/jxl/dec_frame.cc:208:5\n    #15 0x556bae476c9a in jxl::(anonymous namespace)::JxlDecoderProcessInternal(JxlDecoderStruct*, unsigned char const*, unsigned long) /src/libjxl/lib/jxl/decode.cc:1088:12\n    #16 0x556bae46ce54 in JxlDecoderProcessInput /src/libjxl/lib/jxl/decode.cc:1756:14\n    #17 0x556bae45b44e in DecodeJpegXl /src/libjxl/tools/djxl_fuzzer.cc:168:31\n    #18 0x556bae45b44e in TestOneInput /src/libjxl/tools/djxl_fuzzer.cc:497:3\n    #19 0x556bae45b44e in LLVMFuzzerTestOneInput /src/libjxl/tools/djxl_fuzzer.cc:507:10\n    #20 0x556bae35d1b3 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:599:15\n    #21 0x556bae3488f2 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:323:6\n    #22 0x556bae34e5ce in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:856:9\n    #23 0x556bae3780b2 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #24 0x7f637905a83f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n\nDEDUP_TOKEN: operator new(unsigned long)--__libcpp_operator_new<unsigned long>--__libcpp_allocate\nHINT: if you don't care about these errors you may set ASAN_OPTIONS=detect_container_overflow=0.\nIf you suspect a false positive see also: https://github.com/google/sanitizers/wiki/AddressSanitizerContainerOverflow.\nSUMMARY: AddressSanitizer: container-overflow /src/libjxl/lib/jxl/modular/transform/squeeze.cc:300:51 in jxl::InvSqueeze(jxl::Image&, std::__1::vector<jxl::SqueezeParams, std::__1::allocator<jxl::SqueezeParams> >, jxl::ThreadPool*)\nShadow bytes around the buggy address:\n  0x0c307fff8090: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c307fff80a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c307fff80b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c307fff80c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c307fff80d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=>0x0c307fff80e0: 00 00 00 00 fc fc fc fc[fc]fc fc fc fc fc fc fc\n  0x0c307fff80f0: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc\n  0x0c307fff8100: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c307fff8110: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c307fff8120: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c307fff8130: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n  Shadow gap:              cc\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.03477010130882263,
                    0.009277714416384697,
                    -0.05623698607087135,
                    0.00592445582151413,
                    -0.06704149395227432,
                    0.03841990604996681,
                    -0.054154958575963974,
                    -0.0017032999312505126,
                    0.06140001490712166,
                    0.010739677585661411,
                    0.020502010360360146,
                    0.02539086528122425,
                    -0.06626994907855988,
                    0.01052521076053381,
                    0.00944159459322691,
                    -0.0048817843198776245,
                    0.11784672737121582,
                    0.022412918508052826,
                    0.0060264007188379765,
                    0.033374521881341934,
                    -0.001698515028692782,
                    0.014311711303889751,
                    -0.022463710978627205,
                    0.024914436042308807,
                    0.006561953574419022,
                    0.010825947858393192,
                    -0.03773841634392738,
                    -0.03807136416435242,
                    0.005046268459409475,
                    -0.005692075472325087,
                    -0.11426439136266708,
                    -0.11680569499731064,
                    0.010999065823853016,
                    -0.009558252990245819,
                    -0.04144639894366264,
                    0.018311994150280952,
                    0.0032128505408763885,
                    0.006030121352523565,
                    0.0333644263446331,
                    0.05819302797317505,
                    -0.04395307973027229,
                    -0.06389420479536057,
                    0.00726286182180047,
                    0.02755017764866352,
                    -0.07335835695266724,
                    0.03472740948200226,
                    -0.0009356513619422913,
                    -0.07799692451953888,
                    0.032954271882772446,
                    -0.006815224885940552,
                    -0.07317168265581131,
                    0.04702073335647583,
                    0.012765612453222275,
                    -0.05107341334223747,
                    -0.01484887395054102,
                    -0.012382164597511292,
                    0.018193146213889122,
                    0.0030131451785564423,
                    -0.11489960551261902,
                    0.0756111815571785,
                    0.037846919149160385,
                    -0.061042267829179764,
                    0.01708202250301838,
                    -0.03971882537007332,
                    -0.032600779086351395,
                    0.003399985609576106,
                    0.08047187328338623,
                    0.005115830805152655,
                    0.06316784769296646,
                    -0.03517952561378479,
                    0.034672144800424576,
                    0.09626943618059158,
                    -0.05389060452580452,
                    -0.0808967798948288,
                    0.006352911237627268,
                    0.017034005373716354,
                    -0.021347766742110252,
                    0.00943135004490614,
                    -0.0010520083596929908,
                    -0.0483212023973465,
                    -0.004804366733878851,
                    0.007899331860244274,
                    0.011887256056070328,
                    0.002247757976874709,
                    0.0040667797438800335,
                    0.03698767349123955,
                    -0.0004671687784139067,
                    -0.019216055050492287,
                    0.02936857007443905,
                    -0.06184278801083565,
                    0.029231399297714233,
                    -0.05267634987831116,
                    0.021274521946907043,
                    0.0021078279241919518,
                    -0.03140072152018547,
                    0.0032473800238221884,
                    -0.03365921601653099,
                    -0.04756152629852295,
                    -0.007518807891756296,
                    -0.03390190750360489,
                    -0.03385022282600403,
                    -0.021091358736157417,
                    -0.06966603547334671,
                    0.0027008389588445425,
                    0.008006877265870571,
                    -0.006542989984154701,
                    -0.0744827538728714,
                    -0.020521866157650948,
                    0.04442115128040314,
                    -0.015606217086315155,
                    0.026152754202485085,
                    -0.03518461063504219,
                    0.007136973086744547,
                    0.057577986270189285,
                    0.008190021850168705,
                    -0.04848005995154381,
                    -0.0769767239689827,
                    -0.020757067948579788,
                    -0.011254037730395794,
                    -0.007840090431272984,
                    0.0839095413684845,
                    -0.0046960399486124516,
                    -0.04414557293057442,
                    -0.027658745646476746,
                    0.002033073455095291,
                    -0.0226272139698267,
                    0.06685663759708405,
                    0.031437069177627563,
                    0.057697415351867676,
                    0.06463412195444107,
                    -0.01781773939728737,
                    0.04801904782652855,
                    0.010941260494291782,
                    -0.0317014716565609,
                    -0.004435883369296789,
                    0.023264462128281593,
                    0.067182756960392,
                    -0.04075333848595619,
                    0.018173538148403168,
                    -0.01217232272028923,
                    0.03573682904243469,
                    0.05138179659843445,
                    -0.02714448608458042,
                    0.03667554631829262,
                    -0.002624611370265484,
                    -0.03039095364511013,
                    0.038923680782318115,
                    0.04858184978365898,
                    -0.03933770954608917,
                    -0.04818704351782799,
                    -0.012878074310719967,
                    -0.06162329390645027,
                    -0.025917408987879753,
                    -0.04180225729942322,
                    0.053242553025484085,
                    0.013725628145039082,
                    -0.033938199281692505,
                    -0.03284069523215294,
                    -0.006186691578477621,
                    0.0034981463104486465,
                    0.011478445492684841,
                    0.09780391305685043,
                    0.007594685535877943,
                    0.15570814907550812,
                    0.010610745288431644,
                    0.12708398699760437,
                    -0.0540597103536129,
                    0.03764290735125542,
                    0.0025111727882176638,
                    0.05882144346833229,
                    -0.05500023439526558,
                    0.015826044604182243,
                    0.01739632897078991,
                    -0.0038418315816670656,
                    -0.031507402658462524,
                    -0.015119981952011585,
                    -0.016135798767209053,
                    0.035968270152807236,
                    0.027814505621790886,
                    -0.005642063915729523,
                    0.007718829903751612,
                    0.09657171368598938,
                    -0.04536786675453186,
                    -0.018035011366009712,
                    -0.010847315192222595,
                    0.011069457046687603,
                    -0.062142375856637955,
                    -0.032546620815992355,
                    -0.04291602596640587,
                    0.009167787618935108,
                    0.038733113557100296,
                    -0.02419256418943405,
                    0.060637619346380234,
                    -0.002411952940747142,
                    -0.12237671762704849,
                    -0.013033933937549591,
                    -0.0059670452028512955,
                    -0.023444605991244316,
                    0.02742813527584076,
                    -0.07968024164438248,
                    -0.019917309284210205,
                    -0.04394930228590965,
                    0.016349077224731445,
                    0.04057912155985832,
                    -0.013260439969599247,
                    -0.057420458644628525,
                    0.06524277478456497,
                    -0.047869086265563965,
                    0.03773780167102814,
                    -0.013398581184446812,
                    -0.0015330550959333777,
                    -0.0003010366635862738,
                    0.11700519919395447,
                    0.056509096175432205,
                    -0.017243968322873116,
                    -0.06913121789693832,
                    0.03599575534462929,
                    -0.02786300890147686,
                    -0.03754732757806778,
                    0.05609902739524841,
                    -0.021843135356903076,
                    -0.05394972488284111,
                    -0.04917914792895317,
                    -0.016881300136446953,
                    0.06533418595790863,
                    -0.03217906877398491,
                    -0.0013978841016069055,
                    0.04276999831199646,
                    0.09526598453521729,
                    0.034505296498537064,
                    -0.05194263532757759,
                    0.03283900395035744,
                    -0.0004786966892424971,
                    0.04257337376475334,
                    0.04137348011136055,
                    -0.0078023928217589855,
                    0.048536378890275955,
                    0.04457380250096321,
                    -0.05843207240104675,
                    -0.06290271133184433,
                    0.04139874503016472,
                    0.01868213713169098,
                    -0.043589960783720016,
                    -0.0124576510861516,
                    0.0466683954000473,
                    -0.07749508321285248,
                    -0.07182324677705765,
                    0.07496755570173264,
                    -0.05284261703491211,
                    0.030825002118945122,
                    -0.059017475694417953,
                    -0.02621593326330185,
                    0.08097842335700989,
                    0.02861296385526657,
                    0.0342007540166378,
                    0.010149572975933552
                ],
                "report_type": "Container-overflow READ 8",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 1008,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36485"
            }
        },
        "relation1": {
            "identity": 1742,
            "start": 1008,
            "end": 1014,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 1014,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Fuzz: Update the nb_meta_channels in squeeze when applying. (#370)\n\nMetaSqueeze() started updating the nb_meta_channels value in #331, but\r\nwe also need to update the value back when applying the transform. This\r\nwas leading to the transforms getting out of sync with when\r\nmeta-applying versus inverse applying them later.",
                "sha": "f134b5a31da90e743af41fb6cc227af06b91bcc2",
                "repo": "libjxl",
                "encoding": "UTF-8",
                "authored_date": 1627403257,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1627403257
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 1008,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-36485"
            }
        },
        "relation1": {
            "identity": 1737,
            "start": 1008,
            "end": 1009,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 1009,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Fix benchmark_xl with grayscale images\n",
                "sha": "f49870935c95ac20de5f6ec939e5e4080cc189c8",
                "repo": "libjxl",
                "encoding": "UTF-8",
                "authored_date": 1627395149,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1627396280
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]