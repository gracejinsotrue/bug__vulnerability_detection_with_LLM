[
    {
        "baseNode": {
            "identity": 4069,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-41235"
            }
        },
        "relation1": {
            "identity": 7859,
            "start": 4069,
            "end": 4077,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 4077,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.03260389342904091,
                    -0.06214965507388115,
                    -0.17471107840538025,
                    0.06331096589565277,
                    -0.04187653586268425,
                    -0.019148174673318863,
                    0.0029100480023771524,
                    0.060037799179553986,
                    0.050371844321489334,
                    -0.031022479757666588,
                    0.04425569623708725,
                    -0.020433366298675537,
                    0.019391980022192,
                    -0.013189713470637798,
                    0.009743045084178448,
                    -0.05273282900452614,
                    0.11929720640182495,
                    -0.0415155403316021,
                    0.03604534640908241,
                    0.1606767475605011,
                    -0.11111679673194885,
                    0.12483211606740952,
                    -0.06523235142230988,
                    0.050322990864515305,
                    0.01109327096492052,
                    0.03558105230331421,
                    -0.032743170857429504,
                    -0.028688374906778336,
                    -0.06397361308336258,
                    -0.060456160455942154,
                    -0.10305014252662659,
                    -0.12189437448978424,
                    0.058773286640644073,
                    0.043245829641819,
                    -0.058220718055963516,
                    0.015789467841386795,
                    -0.07202879339456558,
                    -0.09803401678800583,
                    -0.01587763987481594,
                    0.03477960452437401,
                    -0.05335412174463272,
                    -0.07644159346818924,
                    -0.01749504916369915,
                    -0.04801969602704048,
                    -0.009823644533753395,
                    -0.020665189251303673,
                    -0.052898142486810684,
                    -0.051214732229709625,
                    0.014827417209744453,
                    0.017930591478943825,
                    -0.085476353764534,
                    0.040442947298288345,
                    -0.08126068860292435,
                    0.06597629189491272,
                    -0.013916851952672005,
                    -0.018327319994568825,
                    0.022836077958345413,
                    0.04630390182137489,
                    -0.04566287249326706,
                    0.06213093549013138,
                    -0.06015867367386818,
                    -0.13820944726467133,
                    -0.04370023310184479,
                    0.045477017760276794,
                    -0.03465680778026581,
                    -0.035035520792007446,
                    0.003108102595433593,
                    -0.09138399362564087,
                    0.011256508529186249,
                    -0.011809594929218292,
                    0.08211589604616165,
                    0.02746274694800377,
                    -0.11299480497837067,
                    -0.020451417192816734,
                    -0.038916222751140594,
                    -0.07450778037309647,
                    -0.10794328898191452,
                    -0.11739339679479599,
                    0.044918160885572433,
                    -0.12931452691555023,
                    0.03761683404445648,
                    0.0808163583278656,
                    0.006952363066375256,
                    0.08128625154495239,
                    0.09203819930553436,
                    -0.0986042246222496,
                    0.09061150252819061,
                    0.017781319096684456,
                    -0.003455457976087928,
                    0.0035047882702201605,
                    0.008423659019172192,
                    -0.007590355817228556,
                    0.08336635679006577,
                    -0.11154980212450027,
                    0.01754871755838394,
                    0.03632047027349472,
                    0.05488758906722069,
                    -0.06176302954554558,
                    0.01004722062498331,
                    -0.013307542540133,
                    0.06449375301599503,
                    -0.03336768597364426,
                    -0.08228234201669693,
                    -0.011951334774494171,
                    -0.09087736904621124,
                    -0.04506152495741844,
                    -0.08594430983066559,
                    0.13491448760032654,
                    0.09486506134271622,
                    0.00913572683930397,
                    0.020886244252324104,
                    -0.0017027034191414714,
                    0.0036081436555832624,
                    0.0807580053806305,
                    0.02265426516532898,
                    -0.08802232146263123,
                    -0.048885244876146317,
                    0.02214319445192814,
                    0.02559463120996952,
                    0.06880643963813782,
                    0.06960273534059525,
                    0.00958517286926508,
                    0.009629747830331326,
                    -0.11961217224597931,
                    -0.013495891354978085,
                    -0.0858389213681221,
                    0.04430226981639862,
                    0.09770165383815765,
                    0.07925502955913544,
                    -0.021387945860624313,
                    -0.02597886510193348,
                    -0.008931275457143784,
                    0.01698247343301773,
                    -0.060695089399814606,
                    -0.02764422819018364,
                    0.0634038895368576,
                    0.11253920942544937,
                    0.07843952625989914,
                    0.13870027661323547,
                    -0.0022155013866722584,
                    -0.03247406333684921,
                    0.0039269872941076756,
                    -0.04874096065759659,
                    0.000577687518671155,
                    -0.000863918976392597,
                    -0.04347551241517067,
                    0.1716640740633011,
                    0.04970017075538635,
                    -0.06822078675031662,
                    0.016170531511306763,
                    -0.030181031674146652,
                    -0.060258880257606506,
                    -0.06291153281927109,
                    0.03370849788188934,
                    0.01645520329475403,
                    -0.002270713448524475,
                    0.04867665842175484,
                    -0.04557511955499649,
                    -0.003381844609975815,
                    -0.07027386873960495,
                    0.06656782329082489,
                    0.07965695112943649,
                    0.049093183130025864,
                    0.08877041190862656,
                    0.021222207695245743,
                    0.05007024109363556,
                    -0.07215935736894608,
                    0.10474981367588043,
                    0.10277571529150009,
                    0.06993016600608826,
                    0.012485823594033718,
                    0.05372614786028862,
                    0.054218847304582596,
                    0.017182113602757454,
                    0.07684142887592316,
                    -0.04066654294729233,
                    -0.015260043554008007,
                    0.032747603952884674,
                    0.0770779624581337,
                    -0.010601980611681938,
                    0.0559387169778347,
                    -0.004542337730526924,
                    -0.10455095022916794,
                    -0.06788120418787003,
                    0.001062293304130435,
                    -0.004540644120424986,
                    0.016402531415224075,
                    -0.01535813882946968,
                    -0.03440089151263237,
                    0.05824809893965721,
                    -0.012324905954301357,
                    -0.037802912294864655,
                    0.07253795117139816,
                    -0.03745225816965103,
                    -0.09919493645429611,
                    0.025411641225218773,
                    0.08255418390035629,
                    -0.08054384589195251,
                    0.06597662717103958,
                    -0.08536376059055328,
                    -0.12285803258419037,
                    0.004737835377454758,
                    -0.047374144196510315,
                    0.022819869220256805,
                    0.0005412382306531072,
                    -0.07020021975040436,
                    0.10131753236055374,
                    -0.054050713777542114,
                    0.05524926260113716,
                    0.019498780369758606,
                    -0.07734270393848419,
                    -0.03804586082696915,
                    0.11226589232683182,
                    0.03749886900186539,
                    0.06521221995353699,
                    -0.00865575484931469,
                    -0.01751738414168358,
                    0.0903620570898056,
                    -0.058688823133707047,
                    0.03574283793568611,
                    -0.05438145250082016,
                    -0.03650416433811188,
                    -0.06833729147911072,
                    0.09775654226541519,
                    0.04286067932844162,
                    -0.020277434960007668,
                    -0.012721476145088673,
                    0.06619647145271301,
                    -0.008834285661578178,
                    0.07755172252655029,
                    -0.0718078762292862,
                    0.03125486150383949,
                    0.04017772898077965,
                    -0.06260667741298676,
                    0.11543135344982147,
                    0.024615762755274773,
                    0.04654837027192116,
                    -0.017353970557451248,
                    -0.009143710136413574,
                    -0.12224490195512772,
                    0.09289870411157608,
                    -0.03650888428092003,
                    -0.0710732489824295,
                    -0.00029201412689872086,
                    0.03825920820236206,
                    -0.06627168506383896,
                    -0.020492495968937874,
                    0.032627325505018234,
                    -0.09426123648881912,
                    -0.09198635071516037,
                    0.017812686040997505,
                    -0.07884597033262253,
                    0.025396138429641724,
                    0.012086503207683563,
                    0.027900904417037964,
                    0.0045050666667521
                ],
                "diffText": "diff --git a/lib/jxl/dec_ans.h b/lib/jxl/dec_ans.h\nindex 8919e32a..b5de8c12 100644\n--- a/lib/jxl/dec_ans.h\n+++ b/lib/jxl/dec_ans.h\n@@ -235,7 +235,11 @@ class ANSSymbolReader {\n     return ReadSymbolWithoutRefill(histo_idx, br);\n   }\n \n-  bool CheckANSFinalState() { return state_ == (ANS_SIGNATURE << 16u); }\n+#ifdef FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION\n+  bool CheckANSFinalState() const { return true; }\n+#else\n+  bool CheckANSFinalState() const { return state_ == (ANS_SIGNATURE << 16u); }\n+#endif\n \n   template <typename BitReader>\n   static JXL_INLINE uint32_t ReadHybridUintConfig("
            }
        },
        "relation2": {
            "identity": 7859,
            "start": 4077,
            "end": 4069,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 4069,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-41235"
            }
        }
    },
    {
        "baseNode": {
            "identity": 4069,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-41235"
            }
        },
        "relation1": {
            "identity": 7859,
            "start": 4069,
            "end": 4077,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 4077,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.03260389342904091,
                    -0.06214965507388115,
                    -0.17471107840538025,
                    0.06331096589565277,
                    -0.04187653586268425,
                    -0.019148174673318863,
                    0.0029100480023771524,
                    0.060037799179553986,
                    0.050371844321489334,
                    -0.031022479757666588,
                    0.04425569623708725,
                    -0.020433366298675537,
                    0.019391980022192,
                    -0.013189713470637798,
                    0.009743045084178448,
                    -0.05273282900452614,
                    0.11929720640182495,
                    -0.0415155403316021,
                    0.03604534640908241,
                    0.1606767475605011,
                    -0.11111679673194885,
                    0.12483211606740952,
                    -0.06523235142230988,
                    0.050322990864515305,
                    0.01109327096492052,
                    0.03558105230331421,
                    -0.032743170857429504,
                    -0.028688374906778336,
                    -0.06397361308336258,
                    -0.060456160455942154,
                    -0.10305014252662659,
                    -0.12189437448978424,
                    0.058773286640644073,
                    0.043245829641819,
                    -0.058220718055963516,
                    0.015789467841386795,
                    -0.07202879339456558,
                    -0.09803401678800583,
                    -0.01587763987481594,
                    0.03477960452437401,
                    -0.05335412174463272,
                    -0.07644159346818924,
                    -0.01749504916369915,
                    -0.04801969602704048,
                    -0.009823644533753395,
                    -0.020665189251303673,
                    -0.052898142486810684,
                    -0.051214732229709625,
                    0.014827417209744453,
                    0.017930591478943825,
                    -0.085476353764534,
                    0.040442947298288345,
                    -0.08126068860292435,
                    0.06597629189491272,
                    -0.013916851952672005,
                    -0.018327319994568825,
                    0.022836077958345413,
                    0.04630390182137489,
                    -0.04566287249326706,
                    0.06213093549013138,
                    -0.06015867367386818,
                    -0.13820944726467133,
                    -0.04370023310184479,
                    0.045477017760276794,
                    -0.03465680778026581,
                    -0.035035520792007446,
                    0.003108102595433593,
                    -0.09138399362564087,
                    0.011256508529186249,
                    -0.011809594929218292,
                    0.08211589604616165,
                    0.02746274694800377,
                    -0.11299480497837067,
                    -0.020451417192816734,
                    -0.038916222751140594,
                    -0.07450778037309647,
                    -0.10794328898191452,
                    -0.11739339679479599,
                    0.044918160885572433,
                    -0.12931452691555023,
                    0.03761683404445648,
                    0.0808163583278656,
                    0.006952363066375256,
                    0.08128625154495239,
                    0.09203819930553436,
                    -0.0986042246222496,
                    0.09061150252819061,
                    0.017781319096684456,
                    -0.003455457976087928,
                    0.0035047882702201605,
                    0.008423659019172192,
                    -0.007590355817228556,
                    0.08336635679006577,
                    -0.11154980212450027,
                    0.01754871755838394,
                    0.03632047027349472,
                    0.05488758906722069,
                    -0.06176302954554558,
                    0.01004722062498331,
                    -0.013307542540133,
                    0.06449375301599503,
                    -0.03336768597364426,
                    -0.08228234201669693,
                    -0.011951334774494171,
                    -0.09087736904621124,
                    -0.04506152495741844,
                    -0.08594430983066559,
                    0.13491448760032654,
                    0.09486506134271622,
                    0.00913572683930397,
                    0.020886244252324104,
                    -0.0017027034191414714,
                    0.0036081436555832624,
                    0.0807580053806305,
                    0.02265426516532898,
                    -0.08802232146263123,
                    -0.048885244876146317,
                    0.02214319445192814,
                    0.02559463120996952,
                    0.06880643963813782,
                    0.06960273534059525,
                    0.00958517286926508,
                    0.009629747830331326,
                    -0.11961217224597931,
                    -0.013495891354978085,
                    -0.0858389213681221,
                    0.04430226981639862,
                    0.09770165383815765,
                    0.07925502955913544,
                    -0.021387945860624313,
                    -0.02597886510193348,
                    -0.008931275457143784,
                    0.01698247343301773,
                    -0.060695089399814606,
                    -0.02764422819018364,
                    0.0634038895368576,
                    0.11253920942544937,
                    0.07843952625989914,
                    0.13870027661323547,
                    -0.0022155013866722584,
                    -0.03247406333684921,
                    0.0039269872941076756,
                    -0.04874096065759659,
                    0.000577687518671155,
                    -0.000863918976392597,
                    -0.04347551241517067,
                    0.1716640740633011,
                    0.04970017075538635,
                    -0.06822078675031662,
                    0.016170531511306763,
                    -0.030181031674146652,
                    -0.060258880257606506,
                    -0.06291153281927109,
                    0.03370849788188934,
                    0.01645520329475403,
                    -0.002270713448524475,
                    0.04867665842175484,
                    -0.04557511955499649,
                    -0.003381844609975815,
                    -0.07027386873960495,
                    0.06656782329082489,
                    0.07965695112943649,
                    0.049093183130025864,
                    0.08877041190862656,
                    0.021222207695245743,
                    0.05007024109363556,
                    -0.07215935736894608,
                    0.10474981367588043,
                    0.10277571529150009,
                    0.06993016600608826,
                    0.012485823594033718,
                    0.05372614786028862,
                    0.054218847304582596,
                    0.017182113602757454,
                    0.07684142887592316,
                    -0.04066654294729233,
                    -0.015260043554008007,
                    0.032747603952884674,
                    0.0770779624581337,
                    -0.010601980611681938,
                    0.0559387169778347,
                    -0.004542337730526924,
                    -0.10455095022916794,
                    -0.06788120418787003,
                    0.001062293304130435,
                    -0.004540644120424986,
                    0.016402531415224075,
                    -0.01535813882946968,
                    -0.03440089151263237,
                    0.05824809893965721,
                    -0.012324905954301357,
                    -0.037802912294864655,
                    0.07253795117139816,
                    -0.03745225816965103,
                    -0.09919493645429611,
                    0.025411641225218773,
                    0.08255418390035629,
                    -0.08054384589195251,
                    0.06597662717103958,
                    -0.08536376059055328,
                    -0.12285803258419037,
                    0.004737835377454758,
                    -0.047374144196510315,
                    0.022819869220256805,
                    0.0005412382306531072,
                    -0.07020021975040436,
                    0.10131753236055374,
                    -0.054050713777542114,
                    0.05524926260113716,
                    0.019498780369758606,
                    -0.07734270393848419,
                    -0.03804586082696915,
                    0.11226589232683182,
                    0.03749886900186539,
                    0.06521221995353699,
                    -0.00865575484931469,
                    -0.01751738414168358,
                    0.0903620570898056,
                    -0.058688823133707047,
                    0.03574283793568611,
                    -0.05438145250082016,
                    -0.03650416433811188,
                    -0.06833729147911072,
                    0.09775654226541519,
                    0.04286067932844162,
                    -0.020277434960007668,
                    -0.012721476145088673,
                    0.06619647145271301,
                    -0.008834285661578178,
                    0.07755172252655029,
                    -0.0718078762292862,
                    0.03125486150383949,
                    0.04017772898077965,
                    -0.06260667741298676,
                    0.11543135344982147,
                    0.024615762755274773,
                    0.04654837027192116,
                    -0.017353970557451248,
                    -0.009143710136413574,
                    -0.12224490195512772,
                    0.09289870411157608,
                    -0.03650888428092003,
                    -0.0710732489824295,
                    -0.00029201412689872086,
                    0.03825920820236206,
                    -0.06627168506383896,
                    -0.020492495968937874,
                    0.032627325505018234,
                    -0.09426123648881912,
                    -0.09198635071516037,
                    0.017812686040997505,
                    -0.07884597033262253,
                    0.025396138429641724,
                    0.012086503207683563,
                    0.027900904417037964,
                    0.0045050666667521
                ],
                "diffText": "diff --git a/lib/jxl/dec_ans.h b/lib/jxl/dec_ans.h\nindex 8919e32a..b5de8c12 100644\n--- a/lib/jxl/dec_ans.h\n+++ b/lib/jxl/dec_ans.h\n@@ -235,7 +235,11 @@ class ANSSymbolReader {\n     return ReadSymbolWithoutRefill(histo_idx, br);\n   }\n \n-  bool CheckANSFinalState() { return state_ == (ANS_SIGNATURE << 16u); }\n+#ifdef FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION\n+  bool CheckANSFinalState() const { return true; }\n+#else\n+  bool CheckANSFinalState() const { return state_ == (ANS_SIGNATURE << 16u); }\n+#endif\n \n   template <typename BitReader>\n   static JXL_INLINE uint32_t ReadHybridUintConfig("
            }
        },
        "relation2": {
            "identity": 7858,
            "start": 4077,
            "end": 4076,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 4076,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "lib/jxl/dec_ans.h"
            }
        }
    },
    {
        "baseNode": {
            "identity": 4069,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-41235"
            }
        },
        "relation1": {
            "identity": 7855,
            "start": 4069,
            "end": 1007,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 1007,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "libjxl"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 4069,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-41235"
            }
        },
        "relation1": {
            "identity": 7854,
            "start": 4069,
            "end": 4075,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 4075,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "INFO: Running with entropic power schedule (0xFF, 100).\nINFO: Seed: 3036744170\nINFO: Loaded 1 modules   (32223 inline 8-bit counters): 32223 [0x5625bb5723b8, 0x5625bb57a197), \nINFO: Loaded 1 PC tables (32223 PCs): 32223 [0x5625bb57a198,0x5625bb5f7f88), \n/out/djxl_fuzzer: Running 1 inputs 1 time(s) each.\nRunning: /tmp/poc\n=================================================================\n==1==ERROR: AddressSanitizer: container-overflow on address 0x61100000ffb0 at pc 0x5625bb056c68 bp 0x7ff34b480800 sp 0x7ff34b4807f8\nREAD of size 4 at 0x61100000ffb0 thread T3\nSCARINESS: 17 (4-byte-read-container-overflow)\n    #0 0x5625bb056c67 in xsize /src/libjxl/lib/jxl/image.h:65:44\n    #1 0x5625bb056c67 in IsInside<jxl::Plane<int> > /src/libjxl/lib/jxl/image.h:285:35\n    #2 0x5625bb056c67 in void jxl::CopyImageTo<int>(jxl::Rect const&, jxl::Plane<int> const&, jxl::Rect const&, jxl::Plane<int>*) /src/libjxl/lib/jxl/image_ops.h:49:3\n    #3 0x5625bb0520de in jxl::ModularFrameDecoder::DecodeGroup(jxl::Rect const&, jxl::BitReader*, int, int, jxl::ModularStreamId const&, bool, jxl::PassesDecoderState*, jxl::ImageBundle*, bool) /src/libjxl/lib/jxl/dec_modular.cc:334:5\n    #4 0x5625baf148d9 in jxl::FrameDecoder::ProcessACGroup(unsigned long, jxl::BitReader* restrict*, unsigned long, unsigned long, bool, bool) /src/libjxl/lib/jxl/dec_frame.cc:638:7\n    #5 0x5625baf23e84 in operator() /src/libjxl/lib/jxl/dec_frame.cc:790:16\n    #6 0x5625baf23e84 in jxl::ThreadPool::RunCallState<jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*)::$_1, jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*)::$_2>::CallDataFunc(void*, unsigned int, unsigned long) /src/libjxl/lib/jxl/base/data_parallel.h:88:14\n    #7 0x5625bb41d954 in RunRange /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:139:7\n    #8 0x5625bb41d954 in jpegxl::ThreadParallelRunner::ThreadFunc(jpegxl::ThreadParallelRunner*, int) /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:169:9\n    #9 0x5625bb41fb93 in __invoke<void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int> /usr/local/bin/../include/c++/v1/type_traits:3662:23\n    #10 0x5625bb41fb93 in __thread_execute<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int, 2UL, 3UL> /usr/local/bin/../include/c++/v1/thread:280:5\n    #11 0x5625bb41fb93 in void* std::__1::__thread_proxy<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(jpegxl::ThreadParallelRunner*, int), jpegxl::ThreadParallelRunner*, unsigned int> >(void*) /usr/local/bin/../include/c++/v1/thread:291:5\n    #12 0x7ff34ee96608 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x8608)\n    #13 0x7ff34ed90352 in __clone (/lib/x86_64-linux-gnu/libc.so.6+0x11f352)\n\nDEDUP_TOKEN: xsize--IsInside<jxl::Plane<int> >--void jxl::CopyImageTo<int>(jxl::Rect const&, jxl::Plane<int> const&, jxl::Rect const&, jxl::Plane<int>*)\n0x61100000ffb0 is located 112 bytes inside of 224-byte region [0x61100000ff40,0x611000010020)\nallocated by thread T3 here:\n    #0 0x5625bada6c8d in operator new(unsigned long) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:95:3\n    #1 0x5625bae9bff5 in __libcpp_operator_new<unsigned long> /usr/local/bin/../include/c++/v1/new:245:10\n    #2 0x5625bae9bff5 in __libcpp_allocate /usr/local/bin/../include/c++/v1/new:271:10\n    #3 0x5625bae9bff5 in allocate /usr/local/bin/../include/c++/v1/__memory/allocator.h:105:38\n    #4 0x5625bae9bff5 in allocate /usr/local/bin/../include/c++/v1/__memory/allocator_traits.h:262:20\n    #5 0x5625bae9bff5 in __split_buffer /usr/local/bin/../include/c++/v1/__split_buffer:306:29\n    #6 0x5625bae9bff5 in void std::__1::vector<jxl::Channel, std::__1::allocator<jxl::Channel> >::__emplace_back_slow_path<jxl::Channel>(jxl::Channel&&) /usr/local/bin/../include/c++/v1/vector:1674:49\n    #7 0x5625bb051316 in emplace_back<jxl::Channel> /usr/local/bin/../include/c++/v1/vector:1696:9\n    #8 0x5625bb051316 in jxl::ModularFrameDecoder::DecodeGroup(jxl::Rect const&, jxl::BitReader*, int, int, jxl::ModularStreamId const&, bool, jxl::PassesDecoderState*, jxl::ImageBundle*, bool) /src/libjxl/lib/jxl/dec_modular.cc:298:18\n    #9 0x5625baf148d9 in jxl::FrameDecoder::ProcessACGroup(unsigned long, jxl::BitReader* restrict*, unsigned long, unsigned long, bool, bool) /src/libjxl/lib/jxl/dec_frame.cc:638:7\n    #10 0x5625baf23e84 in operator() /src/libjxl/lib/jxl/dec_frame.cc:790:16\n    #11 0x5625baf23e84 in jxl::ThreadPool::RunCallState<jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*)::$_1, jxl::FrameDecoder::ProcessSections(jxl::FrameDecoder::SectionInfo const*, unsigned long, jxl::FrameDecoder::SectionStatus*)::$_2>::CallDataFunc(void*, unsigned int, unsigned long) /src/libjxl/lib/jxl/base/data_parallel.h:88:14\n    #12 0x5625bb41d954 in RunRange /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:139:7\n    #13 0x5625bb41d954 in jpegxl::ThreadParallelRunner::ThreadFunc(jpegxl::ThreadParallelRunner*, int) /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:169:9\n    #14 0x5625bb41fb93 in __invoke<void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int> /usr/local/bin/../include/c++/v1/type_traits:3662:23\n    #15 0x5625bb41fb93 in __thread_execute<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int, 2UL, 3UL> /usr/local/bin/../include/c++/v1/thread:280:5\n    #16 0x5625bb41fb93 in void* std::__1::__thread_proxy<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void (*)(jpegxl::ThreadParallelRunner*, int), jpegxl::ThreadParallelRunner*, unsigned int> >(void*) /usr/local/bin/../include/c++/v1/thread:291:5\n    #17 0x7ff34ee96608 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x8608)\n\nDEDUP_TOKEN: operator new(unsigned long)--__libcpp_operator_new<unsigned long>--__libcpp_allocate\nThread T3 created by T0 here:\n    #0 0x5625bad596ec in pthread_create /src/llvm-project/compiler-rt/lib/asan/asan_interceptors.cpp:207:3\n    #1 0x5625bb41e08d in __libcpp_thread_create /usr/local/bin/../include/c++/v1/__threading_support:514:10\n    #2 0x5625bb41e08d in thread<void (&)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &, void> /usr/local/bin/../include/c++/v1/thread:307:16\n    #3 0x5625bb41e08d in construct<std::__1::thread, void (&)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &> /usr/local/bin/../include/c++/v1/__memory/allocator.h:151:28\n    #4 0x5625bb41e08d in construct<std::__1::thread, void (&)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &, void> /usr/local/bin/../include/c++/v1/__memory/allocator_traits.h:290:13\n    #5 0x5625bb41e08d in __construct_one_at_end<void (&)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &> /usr/local/bin/../include/c++/v1/vector:933:5\n    #6 0x5625bb41e08d in emplace_back<void (&)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &> /usr/local/bin/../include/c++/v1/vector:1693:9\n    #7 0x5625bb41e08d in jpegxl::ThreadParallelRunner::ThreadParallelRunner(int) /src/libjxl/lib/threads/thread_parallel_runner_internal.cc:196:14\n    #8 0x5625bb41c7a8 in JxlThreadParallelRunnerCreate /src/libjxl/lib/threads/thread_parallel_runner.cc:81:19\n    #9 0x5625bada9b8d in JxlThreadParallelRunnerMake /src/libjxl/lib/include/jxl/thread_parallel_runner_cxx.h:59:7\n    #10 0x5625bada9b8d in DecodeJpegXl /src/libjxl/tools/djxl_fuzzer.cc:79:17\n    #11 0x5625bada9b8d in TestOneInput /src/libjxl/tools/djxl_fuzzer.cc:536:3\n    #12 0x5625bada9b8d in LLVMFuzzerTestOneInput /src/libjxl/tools/djxl_fuzzer.cc:546:10\n    #13 0x5625baca0e23 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) cxa_noexception.cpp\n    #14 0x5625bac8c732 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6\n    #15 0x5625bac921fa in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) cxa_noexception.cpp\n    #16 0x5625bacbb122 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #17 0x7ff34ec95082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)\n\nDEDUP_TOKEN: pthread_create--__libcpp_thread_create--thread<void (&)(jpegxl::ThreadParallelRunner *, int), jpegxl::ThreadParallelRunner *, unsigned int &, void>\nHINT: if you don't care about these errors you may set ASAN_OPTIONS=detect_container_overflow=0.\nIf you suspect a false positive see also: https://github.com/google/sanitizers/wiki/AddressSanitizerContainerOverflow.\nSUMMARY: AddressSanitizer: container-overflow /src/libjxl/lib/jxl/image.h:65:44 in xsize\nShadow bytes around the buggy address:\n  0x0c227fff9fa0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c227fff9fb0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c227fff9fc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c227fff9fd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c227fff9fe0: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00\n=>0x0c227fff9ff0: 00 00 00 00 00 00[fc]fc fc fc fc fc fc fc fc fc\n  0x0c227fffa000: fc fc fc fc fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c227fffa010: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\n  0x0c227fffa020: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\n  0x0c227fffa030: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd\n  0x0c227fffa040: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.009415701031684875,
                    0.05148840323090553,
                    -0.05868987739086151,
                    0.0043480610474944115,
                    -0.06079362332820892,
                    0.015717875212430954,
                    -0.06551813334226608,
                    0.03766700625419617,
                    0.03266235813498497,
                    0.0076334974728524685,
                    0.012677573598921299,
                    0.030602989718317986,
                    -0.03848600760102272,
                    -0.008417036384344101,
                    0.005238610785454512,
                    -0.013159443624317646,
                    0.15762735903263092,
                    0.007187012117356062,
                    0.010689791291952133,
                    0.04976045712828636,
                    -0.03282634913921356,
                    0.00785884354263544,
                    -0.0271928533911705,
                    0.016017504036426544,
                    0.02494892291724682,
                    -0.0046612867154181,
                    -0.06883320212364197,
                    -0.031645528972148895,
                    -0.0038096755743026733,
                    -0.009827123954892159,
                    -0.09404918551445007,
                    -0.14148131012916565,
                    0.010417510755360126,
                    0.023071086034178734,
                    -0.027552148327231407,
                    0.007167554926127195,
                    -0.007012310903519392,
                    -0.0014475919306278229,
                    0.014678738079965115,
                    0.06453796476125717,
                    -0.05159813165664673,
                    -0.041463371366262436,
                    0.0018680216744542122,
                    -0.02653898485004902,
                    -0.03128301724791527,
                    0.027905521914362907,
                    0.0023789387196302414,
                    -0.06781391054391861,
                    -0.004928193520754576,
                    -0.034253764897584915,
                    -0.047825321555137634,
                    0.013608626089990139,
                    0.0006251938175410032,
                    -0.03410455957055092,
                    0.008628319017589092,
                    -0.02013826183974743,
                    0.0010200167307630181,
                    0.048145174980163574,
                    -0.09756174683570862,
                    0.07411330193281174,
                    0.0003409117052797228,
                    -0.048190921545028687,
                    -0.01586541347205639,
                    -0.03406700864434242,
                    0.0024105359334498644,
                    0.0025609794538468122,
                    0.07661980390548706,
                    -0.000725631311070174,
                    0.03198014572262764,
                    -0.0772450640797615,
                    0.02797175943851471,
                    0.10436355322599411,
                    -0.054677482694387436,
                    -0.09320804476737976,
                    0.006066398229449987,
                    -0.010766521096229553,
                    0.0024329815059900284,
                    -0.01549801230430603,
                    0.013810902833938599,
                    -0.09221116453409195,
                    -0.01114316750317812,
                    0.014353570528328419,
                    0.010577385313808918,
                    0.030604930594563484,
                    0.02639363892376423,
                    0.008436240255832672,
                    -0.01763818971812725,
                    -0.00956714153289795,
                    0.014292408712208271,
                    -0.04567970708012581,
                    0.013766045682132244,
                    -0.02950526773929596,
                    0.015493425540626049,
                    0.013242639601230621,
                    -0.0468723326921463,
                    0.0020767010282725096,
                    0.00726797990500927,
                    -0.038995299488306046,
                    -0.002222460927441716,
                    -0.0344824455678463,
                    0.01162900123745203,
                    -0.025111794471740723,
                    -0.0854749009013176,
                    -0.037322256714105606,
                    -0.010893221013247967,
                    -0.006493261083960533,
                    -0.07878107577562332,
                    -0.0035021791700273752,
                    0.024220669642090797,
                    -0.00596204400062561,
                    0.014789196662604809,
                    -0.01835293136537075,
                    -7.112696766853333e-05,
                    0.03415204957127571,
                    -0.007404521107673645,
                    -0.028579557314515114,
                    -0.0701938346028328,
                    -0.044691625982522964,
                    -0.033616021275520325,
                    -0.03025589883327484,
                    0.059384364634752274,
                    -0.02441670559346676,
                    0.004106432199478149,
                    -0.027133291587233543,
                    0.010474651120603085,
                    -0.009309040382504463,
                    0.059630826115608215,
                    0.01722731627523899,
                    0.06025205925107002,
                    0.06770730763673782,
                    -0.016583262011408806,
                    0.03305675461888313,
                    -0.008503044955432415,
                    -0.03921641781926155,
                    -0.007437823805958033,
                    -0.008767413906753063,
                    0.06772385537624359,
                    -0.027241716161370277,
                    0.03122941218316555,
                    -0.007913333363831043,
                    0.016387419775128365,
                    0.03140391409397125,
                    -0.04165562987327576,
                    0.021478360518813133,
                    -0.012480084784328938,
                    -0.017967885360121727,
                    0.06803995370864868,
                    0.056885916739702225,
                    -0.039420317858457565,
                    -0.04222678020596504,
                    0.0035194524098187685,
                    -0.059894759207963943,
                    -0.041715893894433975,
                    -0.02480272948741913,
                    0.03419017046689987,
                    -0.004069264978170395,
                    -0.012513034045696259,
                    -0.041143998503685,
                    -0.037788357585668564,
                    -0.06749292463064194,
                    0.01715119741857052,
                    0.10939618945121765,
                    -0.0019247295567765832,
                    0.12209529429674149,
                    -0.04732591286301613,
                    0.1283702701330185,
                    -0.06556571274995804,
                    0.03624824807047844,
                    0.00035197785473428667,
                    0.061230480670928955,
                    -0.04278045892715454,
                    0.021058639511466026,
                    0.026973024010658264,
                    -0.02059011347591877,
                    -0.02494213916361332,
                    -0.008565287105739117,
                    -0.0027961870655417442,
                    0.04886522889137268,
                    0.05321187898516655,
                    0.029013218358159065,
                    0.041046880185604095,
                    0.057772547006607056,
                    -0.03653442859649658,
                    -0.046299248933792114,
                    -0.009024078957736492,
                    0.04108741506934166,
                    -0.04110581800341606,
                    0.0012945955386385322,
                    -0.03897244110703468,
                    0.018434623256325722,
                    0.02055838331580162,
                    -0.040247391909360886,
                    0.06260418891906738,
                    -0.016045110300183296,
                    -0.11645707488059998,
                    0.01789044216275215,
                    -0.000897381454706192,
                    -0.030322760343551636,
                    0.02193300984799862,
                    -0.06999332457780838,
                    -0.022838449105620384,
                    -0.048450227826833725,
                    0.028773322701454163,
                    0.019677549600601196,
                    -0.03324519470334053,
                    -0.045894116163253784,
                    0.04262332245707512,
                    -0.039660170674324036,
                    0.05492909625172615,
                    -0.024000829085707664,
                    -0.017504636198282242,
                    0.010330324992537498,
                    0.1101989671587944,
                    0.053070973604917526,
                    -0.007352669257670641,
                    -0.03171215206384659,
                    0.06296873837709427,
                    0.001426409580744803,
                    -0.0762244388461113,
                    0.045082420110702515,
                    -0.06651359051465988,
                    -0.0987461730837822,
                    -0.0581301786005497,
                    -0.007710522506386042,
                    0.06346867978572845,
                    -0.03902360796928406,
                    0.00982519332319498,
                    0.029774220660328865,
                    0.1450021117925644,
                    0.06531057506799698,
                    -0.057541683316230774,
                    0.06355536729097366,
                    -0.008858961053192616,
                    0.008041594177484512,
                    0.035300325602293015,
                    -0.04970715567469597,
                    0.06265348941087723,
                    0.056031133979558945,
                    -0.03443127125501633,
                    -0.03552742302417755,
                    0.06318655610084534,
                    0.001686330884695053,
                    -0.04444798827171326,
                    -0.0093386210501194,
                    0.05351812019944191,
                    -0.08006937801837921,
                    -0.06033729389309883,
                    0.07790911942720413,
                    -0.040165673941373825,
                    0.0066581834107637405,
                    -0.032364748418331146,
                    0.023789547383785248,
                    0.0968903973698616,
                    0.02394905686378479,
                    0.011781435459852219,
                    0.004984588827937841
                ],
                "report_type": "Container-overflow READ 4",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 4069,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-41235"
            }
        },
        "relation1": {
            "identity": 7853,
            "start": 4069,
            "end": 4073,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 4073,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Use FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION to disable ANS checksums.\n\nNote that this does not enable the flag yet.\n",
                "sha": "4d7b55ab7b05b95c4fbc15e1465a09f6dc0805cb",
                "repo": "libjxl",
                "encoding": "UTF-8",
                "authored_date": 1638225581,
                "committer_tz_offset": -3600,
                "author_tz_offset": -3600,
                "committed_date": 1638229263
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 4069,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libjxl-41235"
            }
        },
        "relation1": {
            "identity": 7848,
            "start": 4069,
            "end": 4070,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 4070,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "Add find module for brotli (#898)\n\nThe module looks for brotli using pkg-config if available otherwise it will look for the library in the CMAKE_PREFIX_PATH. If found a target is created that mirrors the in source build of the library.\r\n\r\nThe brotli headers do not have versioning so a minimum version is not requested.",
                "sha": "d15b3481457bf16ceffa9391f924de4b4258a92b",
                "repo": "libjxl",
                "encoding": "UTF-8",
                "authored_date": 1638213648,
                "committer_tz_offset": 0,
                "author_tz_offset": 21600,
                "committed_date": 1638213648
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]