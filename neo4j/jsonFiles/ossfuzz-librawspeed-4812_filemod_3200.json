[
    {
        "baseNode": {
            "identity": 3194,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-4812"
            }
        },
        "relation1": {
            "identity": 6053,
            "start": 3194,
            "end": 3200,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 3200,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    -0.016749899834394455,
                    -0.08789563179016113,
                    -0.22583815455436707,
                    0.046342939138412476,
                    0.03158247843384743,
                    0.037365224212408066,
                    -0.03701180964708328,
                    0.057904426008462906,
                    0.03159800171852112,
                    -0.014421888627111912,
                    0.068024642765522,
                    0.02324715442955494,
                    -0.03012671507894993,
                    -0.0005617564311251044,
                    0.09456196427345276,
                    -0.05639670789241791,
                    0.1336098164319992,
                    -0.028289329260587692,
                    0.01700218766927719,
                    0.0755939707159996,
                    -0.033386919647455215,
                    -0.03238314762711525,
                    0.0279211588203907,
                    0.00950887706130743,
                    0.05283452942967415,
                    0.06922493875026703,
                    -0.08531446754932404,
                    -0.03539516404271126,
                    -0.042450398206710815,
                    -0.11293885856866837,
                    -0.08691088855266571,
                    -0.125614196062088,
                    0.07056652754545212,
                    0.018859971314668655,
                    0.05156143754720688,
                    -0.016289370134472847,
                    -0.07464118301868439,
                    -0.05015196651220322,
                    0.018175864592194557,
                    0.03382887318730354,
                    0.02607252635061741,
                    -0.018124718219041824,
                    0.03287394717335701,
                    -0.004597379360347986,
                    -0.01803405210375786,
                    0.057532183825969696,
                    -0.030466653406620026,
                    -0.08262339234352112,
                    0.07364613562822342,
                    0.03132683411240578,
                    -0.02347850799560547,
                    0.02692817524075508,
                    -0.10800103843212128,
                    -0.06483586877584457,
                    -0.06062278151512146,
                    -0.06788094341754913,
                    -0.051368750631809235,
                    0.029832229018211365,
                    -0.17187674343585968,
                    0.09123630076646805,
                    -0.0382104329764843,
                    -0.10775511711835861,
                    0.03670632094144821,
                    0.018473247066140175,
                    0.02604723535478115,
                    -0.02330969274044037,
                    0.09836427122354507,
                    -0.002664373954758048,
                    0.037976015359163284,
                    0.03406142070889473,
                    0.004597695078700781,
                    0.11191147565841675,
                    -0.06590267270803452,
                    0.05889689549803734,
                    -0.0713241770863533,
                    -0.002105397405102849,
                    -0.03669004514813423,
                    -0.021251294761896133,
                    0.0867355614900589,
                    -0.07798904180526733,
                    -0.06255883723497391,
                    0.047851305454969406,
                    -0.02879795804619789,
                    -0.003833937458693981,
                    0.12569616734981537,
                    -0.05993744730949402,
                    0.08743201941251755,
                    0.025260282680392265,
                    0.02035634219646454,
                    -0.05548636242747307,
                    0.004398577846586704,
                    -0.04698888584971428,
                    0.12176834046840668,
                    -0.07517125457525253,
                    -0.05953484773635864,
                    0.007283987011760473,
                    0.03312373161315918,
                    -0.01361383218318224,
                    0.03858700394630432,
                    -0.01728173904120922,
                    -0.026215266436338425,
                    -0.08042842149734497,
                    -0.07476911693811417,
                    0.01217699982225895,
                    -0.03969407454133034,
                    0.003481923835352063,
                    -0.10016000270843506,
                    0.07830286026000977,
                    0.04290056601166725,
                    -0.07091980427503586,
                    0.07260274887084961,
                    0.033596768975257874,
                    -0.04092870280146599,
                    0.13588207960128784,
                    0.06236450746655464,
                    -0.050793346017599106,
                    -0.13462135195732117,
                    0.04640001058578491,
                    0.0072690867818892,
                    0.07741300016641617,
                    0.042970024049282074,
                    0.09126384556293488,
                    3.925967030227184e-05,
                    -0.10469401627779007,
                    -0.0476132370531559,
                    -0.03962099179625511,
                    0.0006291883182711899,
                    0.07736215740442276,
                    0.11368772387504578,
                    0.06104453653097153,
                    -0.0704285129904747,
                    0.01584763266146183,
                    0.03400298207998276,
                    -0.05442725494503975,
                    0.043868083506822586,
                    0.11752787232398987,
                    0.09172572940587997,
                    0.007025172468274832,
                    0.11447189748287201,
                    0.0341678112745285,
                    0.08566934615373611,
                    0.08766280859708786,
                    0.00297048082575202,
                    0.032805975526571274,
                    -0.06252466142177582,
                    -0.0612766295671463,
                    0.055877041071653366,
                    0.07497692108154297,
                    -0.008452056907117367,
                    -0.0822041779756546,
                    0.08028184622526169,
                    -0.05975061655044556,
                    -0.08273012191057205,
                    -0.09469345211982727,
                    0.020982321351766586,
                    0.020534543320536613,
                    0.010890796780586243,
                    -0.0390804298222065,
                    -0.06307730078697205,
                    -0.08161567896604538,
                    -0.06523185968399048,
                    0.10835078358650208,
                    0.02927246317267418,
                    0.054230738431215286,
                    -0.011811328120529652,
                    0.03988495469093323,
                    0.06031937152147293,
                    -0.018384644761681557,
                    0.030497735366225243,
                    0.053518425673246384,
                    0.003355722874403,
                    0.04121780022978783,
                    0.013612296432256699,
                    -0.13506722450256348,
                    0.04354671761393547,
                    -0.02111993357539177,
                    -0.03331105411052704,
                    0.006307374686002731,
                    -0.0313616581261158,
                    -0.04978519678115845,
                    -0.00698695657774806,
                    -0.01979043520987034,
                    -0.05763141065835953,
                    -0.03602958098053932,
                    -0.0287697222083807,
                    0.04686059430241585,
                    -0.0027628776151686907,
                    0.059527527540922165,
                    0.0036954793613404036,
                    0.04975852742791176,
                    0.07590222358703613,
                    -0.02762710675597191,
                    0.0023362264037132263,
                    -0.03366104140877724,
                    -0.04665552079677582,
                    0.03063693642616272,
                    0.05561036616563797,
                    -0.04548078030347824,
                    0.02654547058045864,
                    -0.10762795805931091,
                    -0.063266322016716,
                    -0.05116746574640274,
                    0.06892148405313492,
                    0.03719443082809448,
                    0.028802182525396347,
                    -0.07700430601835251,
                    0.03571319952607155,
                    -0.07721646875143051,
                    0.09729493409395218,
                    0.040840525180101395,
                    -0.03146567940711975,
                    0.02649785578250885,
                    0.08769117295742035,
                    0.01337456051260233,
                    -0.0003417587431613356,
                    -0.08544546365737915,
                    0.003974423743784428,
                    0.023353248834609985,
                    -0.03400513529777527,
                    0.018563678488135338,
                    -0.038338519632816315,
                    -0.022010967135429382,
                    0.08249899744987488,
                    -0.019841386005282402,
                    0.07296246290206909,
                    -0.07403229176998138,
                    0.01882418990135193,
                    0.046581070870161057,
                    0.09232629835605621,
                    0.06332020461559296,
                    -0.07882516831159592,
                    0.06858900189399719,
                    -0.05287346616387367,
                    -0.031038198620080948,
                    0.05932826176285744,
                    0.0013894379371777177,
                    0.0628456100821495,
                    0.007407651282846928,
                    -0.049123410135507584,
                    -0.0673990473151207,
                    0.07533849030733109,
                    0.03993896022439003,
                    -0.06692724674940109,
                    0.06728586554527283,
                    0.1450677067041397,
                    -0.12627574801445007,
                    -0.07706507295370102,
                    0.06832664459943771,
                    -0.11790486425161362,
                    0.05392228811979294,
                    0.02648111991584301,
                    0.06098188832402229,
                    0.050042569637298584,
                    0.09457197040319443,
                    0.03583398088812828,
                    -0.03518223017454147
                ],
                "diffText": "diff --git a/src/librawspeed/decompressors/FujiDecompressor.cpp b/src/librawspeed/decompressors/FujiDecompressor.cpp\nindex ba21635d..013dc2a0 100644\n--- a/src/librawspeed/decompressors/FujiDecompressor.cpp\n+++ b/src/librawspeed/decompressors/FujiDecompressor.cpp\n@@ -37,6 +37,10 @@ namespace rawspeed {\n \n FujiDecompressor::FujiDecompressor(const RawImage& img, ByteStream input_)\n     : AbstractParallelizedDecompressor(img), input(std::move(input_)) {\n+  if (mRaw->getCpp() != 1 || mRaw->getDataType() != TYPE_USHORT16 ||\n+      mRaw->getBpp() != 2)\n+    ThrowRDE(\"Unexpected component count / data type\");\n+\n   input.setByteOrder(Endianness::big);\n \n   header = FujiHeader(&input);"
            }
        },
        "relation2": {
            "identity": 6053,
            "start": 3200,
            "end": 3194,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 3194,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-4812"
            }
        }
    },
    {
        "baseNode": {
            "identity": 3194,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-4812"
            }
        },
        "relation1": {
            "identity": 6053,
            "start": 3194,
            "end": 3200,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 3200,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    -0.016749899834394455,
                    -0.08789563179016113,
                    -0.22583815455436707,
                    0.046342939138412476,
                    0.03158247843384743,
                    0.037365224212408066,
                    -0.03701180964708328,
                    0.057904426008462906,
                    0.03159800171852112,
                    -0.014421888627111912,
                    0.068024642765522,
                    0.02324715442955494,
                    -0.03012671507894993,
                    -0.0005617564311251044,
                    0.09456196427345276,
                    -0.05639670789241791,
                    0.1336098164319992,
                    -0.028289329260587692,
                    0.01700218766927719,
                    0.0755939707159996,
                    -0.033386919647455215,
                    -0.03238314762711525,
                    0.0279211588203907,
                    0.00950887706130743,
                    0.05283452942967415,
                    0.06922493875026703,
                    -0.08531446754932404,
                    -0.03539516404271126,
                    -0.042450398206710815,
                    -0.11293885856866837,
                    -0.08691088855266571,
                    -0.125614196062088,
                    0.07056652754545212,
                    0.018859971314668655,
                    0.05156143754720688,
                    -0.016289370134472847,
                    -0.07464118301868439,
                    -0.05015196651220322,
                    0.018175864592194557,
                    0.03382887318730354,
                    0.02607252635061741,
                    -0.018124718219041824,
                    0.03287394717335701,
                    -0.004597379360347986,
                    -0.01803405210375786,
                    0.057532183825969696,
                    -0.030466653406620026,
                    -0.08262339234352112,
                    0.07364613562822342,
                    0.03132683411240578,
                    -0.02347850799560547,
                    0.02692817524075508,
                    -0.10800103843212128,
                    -0.06483586877584457,
                    -0.06062278151512146,
                    -0.06788094341754913,
                    -0.051368750631809235,
                    0.029832229018211365,
                    -0.17187674343585968,
                    0.09123630076646805,
                    -0.0382104329764843,
                    -0.10775511711835861,
                    0.03670632094144821,
                    0.018473247066140175,
                    0.02604723535478115,
                    -0.02330969274044037,
                    0.09836427122354507,
                    -0.002664373954758048,
                    0.037976015359163284,
                    0.03406142070889473,
                    0.004597695078700781,
                    0.11191147565841675,
                    -0.06590267270803452,
                    0.05889689549803734,
                    -0.0713241770863533,
                    -0.002105397405102849,
                    -0.03669004514813423,
                    -0.021251294761896133,
                    0.0867355614900589,
                    -0.07798904180526733,
                    -0.06255883723497391,
                    0.047851305454969406,
                    -0.02879795804619789,
                    -0.003833937458693981,
                    0.12569616734981537,
                    -0.05993744730949402,
                    0.08743201941251755,
                    0.025260282680392265,
                    0.02035634219646454,
                    -0.05548636242747307,
                    0.004398577846586704,
                    -0.04698888584971428,
                    0.12176834046840668,
                    -0.07517125457525253,
                    -0.05953484773635864,
                    0.007283987011760473,
                    0.03312373161315918,
                    -0.01361383218318224,
                    0.03858700394630432,
                    -0.01728173904120922,
                    -0.026215266436338425,
                    -0.08042842149734497,
                    -0.07476911693811417,
                    0.01217699982225895,
                    -0.03969407454133034,
                    0.003481923835352063,
                    -0.10016000270843506,
                    0.07830286026000977,
                    0.04290056601166725,
                    -0.07091980427503586,
                    0.07260274887084961,
                    0.033596768975257874,
                    -0.04092870280146599,
                    0.13588207960128784,
                    0.06236450746655464,
                    -0.050793346017599106,
                    -0.13462135195732117,
                    0.04640001058578491,
                    0.0072690867818892,
                    0.07741300016641617,
                    0.042970024049282074,
                    0.09126384556293488,
                    3.925967030227184e-05,
                    -0.10469401627779007,
                    -0.0476132370531559,
                    -0.03962099179625511,
                    0.0006291883182711899,
                    0.07736215740442276,
                    0.11368772387504578,
                    0.06104453653097153,
                    -0.0704285129904747,
                    0.01584763266146183,
                    0.03400298207998276,
                    -0.05442725494503975,
                    0.043868083506822586,
                    0.11752787232398987,
                    0.09172572940587997,
                    0.007025172468274832,
                    0.11447189748287201,
                    0.0341678112745285,
                    0.08566934615373611,
                    0.08766280859708786,
                    0.00297048082575202,
                    0.032805975526571274,
                    -0.06252466142177582,
                    -0.0612766295671463,
                    0.055877041071653366,
                    0.07497692108154297,
                    -0.008452056907117367,
                    -0.0822041779756546,
                    0.08028184622526169,
                    -0.05975061655044556,
                    -0.08273012191057205,
                    -0.09469345211982727,
                    0.020982321351766586,
                    0.020534543320536613,
                    0.010890796780586243,
                    -0.0390804298222065,
                    -0.06307730078697205,
                    -0.08161567896604538,
                    -0.06523185968399048,
                    0.10835078358650208,
                    0.02927246317267418,
                    0.054230738431215286,
                    -0.011811328120529652,
                    0.03988495469093323,
                    0.06031937152147293,
                    -0.018384644761681557,
                    0.030497735366225243,
                    0.053518425673246384,
                    0.003355722874403,
                    0.04121780022978783,
                    0.013612296432256699,
                    -0.13506722450256348,
                    0.04354671761393547,
                    -0.02111993357539177,
                    -0.03331105411052704,
                    0.006307374686002731,
                    -0.0313616581261158,
                    -0.04978519678115845,
                    -0.00698695657774806,
                    -0.01979043520987034,
                    -0.05763141065835953,
                    -0.03602958098053932,
                    -0.0287697222083807,
                    0.04686059430241585,
                    -0.0027628776151686907,
                    0.059527527540922165,
                    0.0036954793613404036,
                    0.04975852742791176,
                    0.07590222358703613,
                    -0.02762710675597191,
                    0.0023362264037132263,
                    -0.03366104140877724,
                    -0.04665552079677582,
                    0.03063693642616272,
                    0.05561036616563797,
                    -0.04548078030347824,
                    0.02654547058045864,
                    -0.10762795805931091,
                    -0.063266322016716,
                    -0.05116746574640274,
                    0.06892148405313492,
                    0.03719443082809448,
                    0.028802182525396347,
                    -0.07700430601835251,
                    0.03571319952607155,
                    -0.07721646875143051,
                    0.09729493409395218,
                    0.040840525180101395,
                    -0.03146567940711975,
                    0.02649785578250885,
                    0.08769117295742035,
                    0.01337456051260233,
                    -0.0003417587431613356,
                    -0.08544546365737915,
                    0.003974423743784428,
                    0.023353248834609985,
                    -0.03400513529777527,
                    0.018563678488135338,
                    -0.038338519632816315,
                    -0.022010967135429382,
                    0.08249899744987488,
                    -0.019841386005282402,
                    0.07296246290206909,
                    -0.07403229176998138,
                    0.01882418990135193,
                    0.046581070870161057,
                    0.09232629835605621,
                    0.06332020461559296,
                    -0.07882516831159592,
                    0.06858900189399719,
                    -0.05287346616387367,
                    -0.031038198620080948,
                    0.05932826176285744,
                    0.0013894379371777177,
                    0.0628456100821495,
                    0.007407651282846928,
                    -0.049123410135507584,
                    -0.0673990473151207,
                    0.07533849030733109,
                    0.03993896022439003,
                    -0.06692724674940109,
                    0.06728586554527283,
                    0.1450677067041397,
                    -0.12627574801445007,
                    -0.07706507295370102,
                    0.06832664459943771,
                    -0.11790486425161362,
                    0.05392228811979294,
                    0.02648111991584301,
                    0.06098188832402229,
                    0.050042569637298584,
                    0.09457197040319443,
                    0.03583398088812828,
                    -0.03518223017454147
                ],
                "diffText": "diff --git a/src/librawspeed/decompressors/FujiDecompressor.cpp b/src/librawspeed/decompressors/FujiDecompressor.cpp\nindex ba21635d..013dc2a0 100644\n--- a/src/librawspeed/decompressors/FujiDecompressor.cpp\n+++ b/src/librawspeed/decompressors/FujiDecompressor.cpp\n@@ -37,6 +37,10 @@ namespace rawspeed {\n \n FujiDecompressor::FujiDecompressor(const RawImage& img, ByteStream input_)\n     : AbstractParallelizedDecompressor(img), input(std::move(input_)) {\n+  if (mRaw->getCpp() != 1 || mRaw->getDataType() != TYPE_USHORT16 ||\n+      mRaw->getBpp() != 2)\n+    ThrowRDE(\"Unexpected component count / data type\");\n+\n   input.setByteOrder(Endianness::big);\n \n   header = FujiHeader(&input);"
            }
        },
        "relation2": {
            "identity": 6052,
            "start": 3200,
            "end": 3199,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 3199,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "src/librawspeed/decompressors/FujiDecompressor.cpp"
            }
        }
    },
    {
        "baseNode": {
            "identity": 3194,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-4812"
            }
        },
        "relation1": {
            "identity": 6049,
            "start": 3194,
            "end": 759,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 759,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "librawspeed"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 3194,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-4812"
            }
        },
        "relation1": {
            "identity": 6048,
            "start": 3194,
            "end": 3198,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 3198,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "Reading 5197 bytes from /tmp/poc\n======================= INFO =========================\nThis binary is built for AFL-fuzz.\nTo run the target function on individual input(s) execute this:\n  /out/FujiDecompressorFuzzer < INPUT_FILE\nor\n  /out/FujiDecompressorFuzzer INPUT_FILE1 [INPUT_FILE2 ... ]\nTo fuzz with afl-fuzz execute this:\n  afl-fuzz [afl-flags] /out/FujiDecompressorFuzzer [-N]\nafl-fuzz will run N iterations before re-spawning the process (default: 1000)\n======================================================\n=================================================================\n==1==ERROR: AddressSanitizer: use-after-poison on address 0x7fbdbc3fe800 at pc 0x000000560461 bp 0x7ffd86c29810 sp 0x7ffd86c29808\nWRITE of size 2 at 0x7fbdbc3fe800 thread T0\nSCARINESS: 43 (2-byte-write-use-after-poison)\n    #0 0x560460 in void rawspeed::FujiDecompressor::copy_line<rawspeed::FujiDecompressor::copy_line_to_xtrans(rawspeed::FujiDecompressor::fuji_compressed_block*, rawspeed::FujiDecompressor::FujiStrip const&, int) const::$_7&>(rawspeed::FujiDecompressor::fuji_compressed_block*, rawspeed::FujiDecompressor::FujiStrip const&, int, rawspeed::FujiDecompressor::copy_line_to_xtrans(rawspeed::FujiDecompressor::fuji_compressed_block*, rawspeed::FujiDecompressor::FujiStrip const&, int) const::$_7&) const /src/librawspeed/src/librawspeed/decompressors/FujiDecompressor.cpp:197:35\n    #1 0x560460 in rawspeed::FujiDecompressor::copy_line_to_xtrans(rawspeed::FujiDecompressor::fuji_compressed_block*, rawspeed::FujiDecompressor::FujiStrip const&, int) const /src/librawspeed/src/librawspeed/decompressors/FujiDecompressor.cpp:210\n    #2 0x56e845 in rawspeed::FujiDecompressor::fuji_decode_strip(rawspeed::FujiDecompressor::fuji_compressed_block*, rawspeed::FujiDecompressor::FujiStrip const&) const /src/librawspeed/src/librawspeed/decompressors/FujiDecompressor.cpp:724:7\n    #3 0x56f1e5 in rawspeed::FujiDecompressor::decompressThreaded(rawspeed::RawDecompressorThread const*) const /src/librawspeed/src/librawspeed/decompressors/FujiDecompressor.cpp:774:5\n    #4 0x55a5ef in rawspeed::RawDecompressorThread::start_routine(void*) /src/librawspeed/src/librawspeed/decompressors/AbstractParallelizedDecompressor.h:67:22\n    #5 0x55a129 in rawspeed::AbstractParallelizedDecompressor::decompressOne(unsigned int) const /src/librawspeed/src/librawspeed/decompressors/AbstractParallelizedDecompressor.cpp:39:3\n    #6 0x5469f2 in LLVMFuzzerTestOneInput /src/librawspeed/fuzz/librawspeed/decompressors/FujiDecompressor.cpp:47:7\n    #7 0x57e7ef in ExecuteFilesOnyByOne(int, char**) /src/libfuzzer/afl/afl_driver.cpp:271:5\n    #8 0x57ed8f in main /src/libfuzzer/afl/afl_driver.cpp:308:12\n    #9 0x7fbdbedb583f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n    #10 0x447f68 in _start (/out/FujiDecompressorFuzzer+0x447f68)\n\nDEDUP_TOKEN: void rawspeed::FujiDecompressor::copy_line<rawspeed::FujiDecompressor::copy_line_to_xtrans(rawspeed::FujiDecompressor::fuji_compressed_block*, rawspeed::FujiDecompressor::FujiStrip const&, int) const::$_7&>(rawspeed::FujiDecompressor::fuji_compressed_block*, rawspeed::FujiDecompressor::FujiStrip const&, int, rawspeed::FujiDecompressor::copy_line_to_xtrans(rawspeed::FujiDecompressor::fuji_compressed_block*, rawspeed::FujiDecompressor::FujiStrip const&, int) const::$_7&) const--rawspeed::FujiDecompressor::copy_line_to_xtrans(rawspeed::FujiDecompressor::fuji_compressed_block*, rawspeed::FujiDecompressor::FujiStrip const&, int) const--rawspeed::FujiDecompressor::fuji_decode_strip(rawspeed::FujiDecompressor::fuji_compressed_block*, rawspeed::FujiDecompressor::FujiStrip const&) const\n0x7fbdbc3fe800 is located 0 bytes inside of 3145728-byte region [0x7fbdbc3fe800,0x7fbdbc6fe800)\nallocated by thread T0 here:\n    #0 0x50b8c0 in __interceptor_posix_memalign /src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:157\n    #1 0x57499b in rawspeed::alignedMalloc(unsigned long, unsigned long) /src/librawspeed/src/librawspeed/common/Memory.cpp:62:12\n    #2 0x54943b in unsigned char* rawspeed::alignedMalloc<unsigned char, 16ul>(unsigned long) /src/librawspeed/src/librawspeed/common/Memory.h:60:31\n    #3 0x54943b in unsigned char* rawspeed::alignedMallocArray<unsigned char, 16ul, false>(unsigned long, unsigned long) /src/librawspeed/src/librawspeed/common/Memory.h:78\n    #4 0x54943b in rawspeed::RawImageData::createData() /src/librawspeed/src/librawspeed/common/RawImage.cpp:100\n    #5 0x5469de in LLVMFuzzerTestOneInput /src/librawspeed/fuzz/librawspeed/decompressors/FujiDecompressor.cpp:46:11\n    #6 0x57e7ef in ExecuteFilesOnyByOne(int, char**) /src/libfuzzer/afl/afl_driver.cpp:271:5\n    #7 0x57ed8f in main /src/libfuzzer/afl/afl_driver.cpp:308:12\n    #8 0x7fbdbedb583f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)\n\nDEDUP_TOKEN: __interceptor_posix_memalign--rawspeed::alignedMalloc(unsigned long, unsigned long)--unsigned char* rawspeed::alignedMalloc<unsigned char, 16ul>(unsigned long)\nSUMMARY: AddressSanitizer: use-after-poison /src/librawspeed/src/librawspeed/decompressors/FujiDecompressor.cpp:197:35 in void rawspeed::FujiDecompressor::copy_line<rawspeed::FujiDecompressor::copy_line_to_xtrans(rawspeed::FujiDecompressor::fuji_compressed_block*, rawspeed::FujiDecompressor::FujiStrip const&, int) const::$_7&>(rawspeed::FujiDecompressor::fuji_compressed_block*, rawspeed::FujiDecompressor::FujiStrip const&, int, rawspeed::FujiDecompressor::copy_line_to_xtrans(rawspeed::FujiDecompressor::fuji_compressed_block*, rawspeed::FujiDecompressor::FujiStrip const&, int) const::$_7&) const\nShadow bytes around the buggy address:\n  0x0ff837877cb0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0ff837877cc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0ff837877cd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0ff837877ce0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0ff837877cf0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n=>0x0ff837877d00:[f7]f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7\n  0x0ff837877d10: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7\n  0x0ff837877d20: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7\n  0x0ff837877d30: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7\n  0x0ff837877d40: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7\n  0x0ff837877d50: f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7 f7\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.025020482018589973,
                    0.046536535024642944,
                    -0.10369199514389038,
                    0.0030030645430088043,
                    0.004922427702695131,
                    0.0272693932056427,
                    -0.04845335707068443,
                    0.05031822249293327,
                    0.07656161487102509,
                    -0.031850773841142654,
                    0.030122486874461174,
                    0.004892035853117704,
                    -0.031223518773913383,
                    0.02173653431236744,
                    0.059254199266433716,
                    -0.0016166958957910538,
                    0.08918584138154984,
                    -0.016020437702536583,
                    0.048441577702760696,
                    0.05608006939291954,
                    -0.020038366317749023,
                    -0.011536912061274052,
                    -0.030914047732949257,
                    -0.015459246933460236,
                    -0.03682861849665642,
                    0.029390715062618256,
                    -0.11590046435594559,
                    -0.007006751839071512,
                    -0.04545788839459419,
                    -0.02616634964942932,
                    -0.0770510584115982,
                    -0.16885501146316528,
                    0.015714945271611214,
                    -0.011792165227234364,
                    0.02683323621749878,
                    -0.023690903559327126,
                    -0.04467160999774933,
                    0.0008338969200849533,
                    0.00428495928645134,
                    0.08539167046546936,
                    -0.059987593442201614,
                    -0.05487899109721184,
                    0.010281428694725037,
                    -0.032109249383211136,
                    -0.06297009438276291,
                    0.05006637051701546,
                    0.02347795106470585,
                    -0.057002440094947815,
                    0.06445314735174179,
                    -0.007990876212716103,
                    -0.05986401438713074,
                    0.014402239583432674,
                    -0.03533543273806572,
                    -0.07921867072582245,
                    -0.0391632579267025,
                    -0.07096624374389648,
                    0.027004970237612724,
                    0.05724834278225899,
                    -0.0919896736741066,
                    0.10801409929990768,
                    0.0027405815199017525,
                    -0.061083946377038956,
                    0.055431004613637924,
                    -0.019943077117204666,
                    -0.020914075896143913,
                    0.024768942967057228,
                    0.1051863431930542,
                    0.032951708883047104,
                    0.029861100018024445,
                    0.004149063024669886,
                    0.01495357695966959,
                    0.16452749073505402,
                    -0.04233376309275627,
                    -0.05203082785010338,
                    0.002085621701553464,
                    0.02086428366601467,
                    -0.028209568932652473,
                    0.02470136433839798,
                    -0.011815667152404785,
                    -0.09344267845153809,
                    -0.038393013179302216,
                    -0.00883718766272068,
                    0.01229831948876381,
                    0.0414029099047184,
                    0.028516218066215515,
                    0.005511652212589979,
                    0.011286438442766666,
                    -0.03022911585867405,
                    -0.00933763850480318,
                    -0.038342904299497604,
                    0.04908556118607521,
                    -0.09506294876337051,
                    0.06629583984613419,
                    -0.03915683180093765,
                    0.010777764022350311,
                    -0.01703277975320816,
                    0.02700541727244854,
                    -0.0030842896085232496,
                    -0.02674044482409954,
                    -0.02519889362156391,
                    -0.031166180968284607,
                    -0.09366840869188309,
                    -0.010510511696338654,
                    -0.028799131512641907,
                    -0.010355309583246708,
                    0.05079587921500206,
                    -0.07060405611991882,
                    -0.0012045885669067502,
                    -0.02110360749065876,
                    -0.03411257639527321,
                    0.03834133222699165,
                    -0.01775921694934368,
                    -0.04187607765197754,
                    0.06733769923448563,
                    0.059673089534044266,
                    -0.03885246068239212,
                    -0.05370534956455231,
                    -0.014663077890872955,
                    -0.012935158796608448,
                    0.0395759716629982,
                    0.03816424310207367,
                    0.01951131410896778,
                    -0.01612526923418045,
                    -0.007351951207965612,
                    0.010261106304824352,
                    -0.040842875838279724,
                    0.04777773842215538,
                    0.057189345359802246,
                    0.08999430388212204,
                    0.1083519235253334,
                    -0.047415707260370255,
                    0.03727047145366669,
                    0.028417838737368584,
                    -0.028463944792747498,
                    0.029520737007260323,
                    0.037578035145998,
                    0.10307735204696655,
                    -0.030646078288555145,
                    0.04588261619210243,
                    0.04246433451771736,
                    0.08801823854446411,
                    0.03206340968608856,
                    -0.01474920567125082,
                    0.023706385865807533,
                    -0.020176345482468605,
                    -0.04690369591116905,
                    -0.006871250923722982,
                    0.04055507853627205,
                    -0.02406163327395916,
                    -0.014775506220757961,
                    -0.023186124861240387,
                    -0.0171012282371521,
                    -0.0810370147228241,
                    -0.08117113262414932,
                    -0.0003424398601055145,
                    -0.022086774930357933,
                    -0.0073188249953091145,
                    -0.0013695204397663474,
                    -0.06164562329649925,
                    -0.015768827870488167,
                    0.006997672840952873,
                    0.13407748937606812,
                    0.044218938797712326,
                    0.1259949803352356,
                    -0.04279453679919243,
                    0.07389940321445465,
                    0.009436129592359066,
                    0.009260374121367931,
                    0.01578604243695736,
                    0.03927234187722206,
                    -0.05548258498311043,
                    0.01100268866866827,
                    0.01331377774477005,
                    -0.07788567245006561,
                    0.02503216452896595,
                    -0.006549424957484007,
                    0.007356384303420782,
                    0.05574610456824303,
                    0.05096444860100746,
                    -0.016436148434877396,
                    -0.04223931208252907,
                    -0.0044821687042713165,
                    -0.03910427168011665,
                    -0.030665406957268715,
                    -0.06573090702295303,
                    0.0764584019780159,
                    -0.07158651947975159,
                    0.03848910331726074,
                    0.04145753011107445,
                    0.006664775777608156,
                    0.02861020900309086,
                    -0.02461245097219944,
                    0.08092162758111954,
                    -0.004579348023980856,
                    -0.06620077043771744,
                    0.027391739189624786,
                    0.006331270560622215,
                    0.04973616823554039,
                    0.012605446390807629,
                    -0.10160259157419205,
                    -0.052479054778814316,
                    -0.07813192158937454,
                    0.07452195137739182,
                    -0.0005027665756642818,
                    0.024053139612078667,
                    -0.08540109544992447,
                    0.070674367249012,
                    -0.0331127755343914,
                    0.06096024438738823,
                    0.005718655418604612,
                    0.017612343654036522,
                    0.006748432759195566,
                    0.11093032360076904,
                    0.059284329414367676,
                    0.006458073388785124,
                    -0.06648945063352585,
                    0.03288194164633751,
                    -0.04447507485747337,
                    -0.07550332695245743,
                    0.029113881289958954,
                    -0.05283600091934204,
                    -0.007956065237522125,
                    0.007753830403089523,
                    -0.025586115196347237,
                    0.04434288665652275,
                    -0.05261349678039551,
                    -0.016635678708553314,
                    0.07646513730287552,
                    0.11955934762954712,
                    0.08470795303583145,
                    -0.13083770871162415,
                    0.023278243839740753,
                    -0.01619500294327736,
                    0.02097468636929989,
                    0.049378544092178345,
                    0.013482549227774143,
                    0.08522450178861618,
                    0.05274320766329765,
                    -0.05865001305937767,
                    -0.047875892370939255,
                    0.009022757411003113,
                    -0.006845981348305941,
                    -0.0548713319003582,
                    -0.001166991307400167,
                    0.1390329748392105,
                    -0.06439792364835739,
                    -0.08465200662612915,
                    0.03553302586078644,
                    -0.0401669405400753,
                    0.05710679292678833,
                    -0.053605567663908005,
                    0.007990669459104538,
                    0.10753032565116882,
                    0.01345555204898119,
                    -0.004219777882099152,
                    -0.030141478404402733
                ],
                "report_type": "Use-after-poison WRITE 2",
                "severity": "High"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 3194,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-4812"
            }
        },
        "relation1": {
            "identity": 6047,
            "start": 3194,
            "end": 3197,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 3197,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "FujiDecompressor: don't forget to sanitize cpp/bpp\n",
                "sha": "2d8507d1909829e9151fac73ffc0d20f691f558c",
                "repo": "librawspeed",
                "encoding": "UTF-8",
                "authored_date": 1514385198,
                "committer_tz_offset": -10800,
                "author_tz_offset": -10800,
                "committed_date": 1514385198
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 3194,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-librawspeed-4812"
            }
        },
        "relation1": {
            "identity": 6041,
            "start": 3194,
            "end": 3195,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 3195,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "FujiDecompressor::FujiHeader: sanitize blocks_in_row wrt. raw_width and block_size\n\nFuji compressed RAF's are split into strips (blocks):\n       0\n     0 /----|----|---#\\\n       | s0 | s1 | s2#|\nheight \\----|----|---#/\n                    /|\\\n                  width\n\nEach strip spans entire height, but only part of the width.\nFor padding purposes, all the strips encode the same\namount of columns, but the final image may be smaller\nthan that, so some columns of the last slice may be ignored.\n\nThere is an assertion in FujiDecompressor.h:91:\n\tassert(h.block_size * h.blocks_in_row >= h.raw_width);\nIt ensures that last strip does actually contain enough pixels\nto finish the row. (Well, it checks that all the slices produce\nat least enough columns for the entire image).\n\nBut the FujiHeader sanitization did not actually sanitize\nthat case, so it was possible to hit the assert.\n",
                "sha": "f6a608b1a9ee4001c62515539629f18e6c7a9332",
                "repo": "librawspeed",
                "encoding": "UTF-8",
                "authored_date": 1514317580,
                "committer_tz_offset": -10800,
                "author_tz_offset": -10800,
                "committed_date": 1514318144
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]