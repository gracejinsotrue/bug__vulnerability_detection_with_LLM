[
    {
        "baseNode": {
            "identity": 6733,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-22094"
            }
        },
        "relation1": {
            "identity": 13506,
            "start": 6733,
            "end": 6738,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 6738,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.07758430391550064,
                    0.016282932832837105,
                    -0.13881289958953857,
                    0.13832810521125793,
                    -0.05500832200050354,
                    0.0533023439347744,
                    -0.027107981964945793,
                    0.002798809204250574,
                    0.05834127962589264,
                    0.02945902571082115,
                    -0.0018764863489195704,
                    -0.059103451669216156,
                    -0.046003155410289764,
                    0.0017350779380649328,
                    0.09510388970375061,
                    -0.07938691228628159,
                    0.08608102798461914,
                    -0.029704667627811432,
                    0.0149114690721035,
                    0.026414327323436737,
                    -0.024251261726021767,
                    -0.0352962389588356,
                    0.017520256340503693,
                    0.019038096070289612,
                    0.05091097950935364,
                    -0.003539835335686803,
                    -0.10166792571544647,
                    0.03383074700832367,
                    0.06593959778547287,
                    -0.0760832354426384,
                    -0.12855003774166107,
                    -0.09251575171947479,
                    0.07382876425981522,
                    0.022840818390250206,
                    -0.06046954169869423,
                    -0.005216236691921949,
                    -0.06658205389976501,
                    -0.03608813136816025,
                    0.03499044477939606,
                    0.08723394572734833,
                    -0.12729904055595398,
                    0.0023529345635324717,
                    0.01077309437096119,
                    -0.03125881403684616,
                    -0.01945391297340393,
                    -0.006960457190871239,
                    -0.027549266815185547,
                    -0.09084156900644302,
                    -0.01744975708425045,
                    0.00912417285144329,
                    -0.03968651965260506,
                    -0.007355996407568455,
                    -0.0647955909371376,
                    -0.002316047204658389,
                    -0.1064935177564621,
                    0.018125398084521294,
                    -0.0732489675283432,
                    0.06885036081075668,
                    -0.03989334776997566,
                    0.00658324733376503,
                    -0.02487647533416748,
                    -0.15200179815292358,
                    -0.05722934007644653,
                    -0.02797284722328186,
                    0.014957934617996216,
                    0.038647476583719254,
                    0.1017640084028244,
                    -0.07521729171276093,
                    0.03381315991282463,
                    -0.059340186417102814,
                    0.07322002947330475,
                    0.042315319180488586,
                    -0.13582217693328857,
                    -0.051388755440711975,
                    -0.07764269411563873,
                    0.0017485609278082848,
                    -0.08092290163040161,
                    -0.04277743026614189,
                    -0.01445096731185913,
                    -0.23112870752811432,
                    -0.10191726684570312,
                    0.09074684977531433,
                    -0.04464588686823845,
                    0.003260355442762375,
                    0.11558713018894196,
                    -0.03552316129207611,
                    0.08397118747234344,
                    -0.004436923656612635,
                    -0.01744135469198227,
                    -0.006548152305185795,
                    0.029084252193570137,
                    -0.03215982764959335,
                    0.029181277379393578,
                    -0.06788705289363861,
                    -0.03264220058917999,
                    0.07798220217227936,
                    -0.01457858644425869,
                    -0.03712082281708717,
                    0.03088657185435295,
                    0.026287926360964775,
                    0.01742664724588394,
                    -0.07836712151765823,
                    -0.09106317907571793,
                    -0.08321007341146469,
                    -0.04679541662335396,
                    -0.10387738794088364,
                    -0.07804302126169205,
                    0.04107680544257164,
                    0.06625925004482269,
                    -0.07135888934135437,
                    0.0022350698709487915,
                    0.032693203538656235,
                    -0.06372161954641342,
                    0.030886922031641006,
                    -0.016935402527451515,
                    -0.11597912758588791,
                    -0.010255691595375538,
                    -0.014101237989962101,
                    -0.008025764487683773,
                    0.05173207446932793,
                    0.06611678004264832,
                    -0.012171720154583454,
                    0.02508234791457653,
                    -0.09198565781116486,
                    -0.03545861691236496,
                    -0.053227994590997696,
                    -0.0007314531831070781,
                    0.09882860630750656,
                    0.03308180347084999,
                    0.10192105919122696,
                    -0.06006414815783501,
                    -0.035728681832551956,
                    -0.01564272865653038,
                    -0.000342672283295542,
                    -0.02086273767054081,
                    0.02126873843371868,
                    0.008142093196511269,
                    0.05512065067887306,
                    0.09434767812490463,
                    0.018546337261795998,
                    -0.010820189490914345,
                    0.06712904572486877,
                    -0.07857069373130798,
                    -0.01986006274819374,
                    0.10773921012878418,
                    0.020295899361371994,
                    0.07902311533689499,
                    0.007137633394449949,
                    0.04997928813099861,
                    0.0015052038943395019,
                    0.06551527976989746,
                    -0.04856717213988304,
                    -0.1034664735198021,
                    -0.07709216326475143,
                    0.06043069064617157,
                    0.05986732617020607,
                    0.027064872905611992,
                    0.062101658433675766,
                    0.013797708787024021,
                    -0.07784132659435272,
                    0.02963540144264698,
                    0.09473565965890884,
                    0.007453732192516327,
                    0.127588152885437,
                    0.04114183038473129,
                    0.009890813380479813,
                    0.008234763517975807,
                    0.005839519202709198,
                    0.025044454261660576,
                    0.052217997610569,
                    0.025501903146505356,
                    0.057376712560653687,
                    -0.010137411765754223,
                    0.04109730198979378,
                    -0.012969913892447948,
                    -0.10838275402784348,
                    -0.03957706689834595,
                    -0.010429678484797478,
                    -0.011144282296299934,
                    -0.04069015383720398,
                    0.09447295218706131,
                    -0.05457872152328491,
                    -0.13909052312374115,
                    -0.05752493441104889,
                    -0.06789860874414444,
                    0.07035146653652191,
                    -0.018680928274989128,
                    -0.029079286381602287,
                    -0.008509252220392227,
                    0.04078109562397003,
                    0.028526894748210907,
                    -0.03860189765691757,
                    0.08998476713895798,
                    -0.10435806214809418,
                    -0.13146857917308807,
                    0.08591170608997345,
                    -0.07639893144369125,
                    -0.0780300498008728,
                    -0.032852355390787125,
                    -0.008070613257586956,
                    -0.04310091957449913,
                    -0.06617695093154907,
                    0.06653428077697754,
                    0.027916638180613518,
                    0.0024442686699330807,
                    -0.081023208796978,
                    0.09067179262638092,
                    -0.08956558257341385,
                    0.04665691405534744,
                    -0.04254191368818283,
                    -0.013308794237673283,
                    0.029782313853502274,
                    0.12230832129716873,
                    0.06927052140235901,
                    0.004548297263681889,
                    0.008159085176885128,
                    -0.030520731583237648,
                    0.001487787812948227,
                    -0.05128693953156471,
                    -0.01870773173868656,
                    -0.072552889585495,
                    -0.009029123932123184,
                    -0.022292664274573326,
                    0.08308884501457214,
                    0.045800551772117615,
                    0.01091000996530056,
                    0.03888601064682007,
                    -0.018915360793471336,
                    0.11392983794212341,
                    0.08107815682888031,
                    -0.05360514670610428,
                    0.09520231187343597,
                    -0.028988271951675415,
                    -0.06173399090766907,
                    0.03236444666981697,
                    -0.07868931442499161,
                    0.03920019045472145,
                    0.0014944596914574504,
                    0.045614127069711685,
                    -0.036575257778167725,
                    0.056417666375637054,
                    0.04492795467376709,
                    -0.021471884101629257,
                    -0.057195957750082016,
                    0.0427815206348896,
                    0.001416398910805583,
                    -0.03163033351302147,
                    0.09023290872573853,
                    -0.05962066724896431,
                    0.059925492852926254,
                    0.07123249024152756,
                    0.14099162817001343,
                    0.03929617628455162,
                    0.12283835560083389,
                    -0.009392572566866875,
                    -0.11811158061027527
                ],
                "diffText": "diff --git a/libheif/heif_colorconversion.cc b/libheif/heif_colorconversion.cc\nindex 33fb746..54771fd 100644\n--- a/libheif/heif_colorconversion.cc\n+++ b/libheif/heif_colorconversion.cc\n@@ -2924,6 +2924,23 @@ std::shared_ptr<HeifPixelImage> heif::convert_colorspace(const std::shared_ptr<H\n                                                          std::shared_ptr<const color_profile_nclx> target_profile,\n                                                          int output_bpp)\n {\n+  // --- check that input image is valid\n+\n+  int width = input->get_width();\n+  int height = input->get_width();\n+\n+  // alpha image should have full image resolution\n+\n+  if (input->has_channel(heif_channel_Alpha)) {\n+    if (input->get_width(heif_channel_Alpha) != width ||\n+        input->get_height(heif_channel_Alpha) != height) {\n+      return nullptr;\n+    }\n+  }\n+\n+\n+  // --- prepare conversion\n+\n   ColorState input_state;\n   input_state.colorspace = input->get_colorspace();\n   input_state.chroma = input->get_chroma_format();"
            }
        },
        "relation2": {
            "identity": 13506,
            "start": 6738,
            "end": 6733,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 6733,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-22094"
            }
        }
    },
    {
        "baseNode": {
            "identity": 6733,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-22094"
            }
        },
        "relation1": {
            "identity": 13506,
            "start": 6733,
            "end": 6738,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 6738,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.07758430391550064,
                    0.016282932832837105,
                    -0.13881289958953857,
                    0.13832810521125793,
                    -0.05500832200050354,
                    0.0533023439347744,
                    -0.027107981964945793,
                    0.002798809204250574,
                    0.05834127962589264,
                    0.02945902571082115,
                    -0.0018764863489195704,
                    -0.059103451669216156,
                    -0.046003155410289764,
                    0.0017350779380649328,
                    0.09510388970375061,
                    -0.07938691228628159,
                    0.08608102798461914,
                    -0.029704667627811432,
                    0.0149114690721035,
                    0.026414327323436737,
                    -0.024251261726021767,
                    -0.0352962389588356,
                    0.017520256340503693,
                    0.019038096070289612,
                    0.05091097950935364,
                    -0.003539835335686803,
                    -0.10166792571544647,
                    0.03383074700832367,
                    0.06593959778547287,
                    -0.0760832354426384,
                    -0.12855003774166107,
                    -0.09251575171947479,
                    0.07382876425981522,
                    0.022840818390250206,
                    -0.06046954169869423,
                    -0.005216236691921949,
                    -0.06658205389976501,
                    -0.03608813136816025,
                    0.03499044477939606,
                    0.08723394572734833,
                    -0.12729904055595398,
                    0.0023529345635324717,
                    0.01077309437096119,
                    -0.03125881403684616,
                    -0.01945391297340393,
                    -0.006960457190871239,
                    -0.027549266815185547,
                    -0.09084156900644302,
                    -0.01744975708425045,
                    0.00912417285144329,
                    -0.03968651965260506,
                    -0.007355996407568455,
                    -0.0647955909371376,
                    -0.002316047204658389,
                    -0.1064935177564621,
                    0.018125398084521294,
                    -0.0732489675283432,
                    0.06885036081075668,
                    -0.03989334776997566,
                    0.00658324733376503,
                    -0.02487647533416748,
                    -0.15200179815292358,
                    -0.05722934007644653,
                    -0.02797284722328186,
                    0.014957934617996216,
                    0.038647476583719254,
                    0.1017640084028244,
                    -0.07521729171276093,
                    0.03381315991282463,
                    -0.059340186417102814,
                    0.07322002947330475,
                    0.042315319180488586,
                    -0.13582217693328857,
                    -0.051388755440711975,
                    -0.07764269411563873,
                    0.0017485609278082848,
                    -0.08092290163040161,
                    -0.04277743026614189,
                    -0.01445096731185913,
                    -0.23112870752811432,
                    -0.10191726684570312,
                    0.09074684977531433,
                    -0.04464588686823845,
                    0.003260355442762375,
                    0.11558713018894196,
                    -0.03552316129207611,
                    0.08397118747234344,
                    -0.004436923656612635,
                    -0.01744135469198227,
                    -0.006548152305185795,
                    0.029084252193570137,
                    -0.03215982764959335,
                    0.029181277379393578,
                    -0.06788705289363861,
                    -0.03264220058917999,
                    0.07798220217227936,
                    -0.01457858644425869,
                    -0.03712082281708717,
                    0.03088657185435295,
                    0.026287926360964775,
                    0.01742664724588394,
                    -0.07836712151765823,
                    -0.09106317907571793,
                    -0.08321007341146469,
                    -0.04679541662335396,
                    -0.10387738794088364,
                    -0.07804302126169205,
                    0.04107680544257164,
                    0.06625925004482269,
                    -0.07135888934135437,
                    0.0022350698709487915,
                    0.032693203538656235,
                    -0.06372161954641342,
                    0.030886922031641006,
                    -0.016935402527451515,
                    -0.11597912758588791,
                    -0.010255691595375538,
                    -0.014101237989962101,
                    -0.008025764487683773,
                    0.05173207446932793,
                    0.06611678004264832,
                    -0.012171720154583454,
                    0.02508234791457653,
                    -0.09198565781116486,
                    -0.03545861691236496,
                    -0.053227994590997696,
                    -0.0007314531831070781,
                    0.09882860630750656,
                    0.03308180347084999,
                    0.10192105919122696,
                    -0.06006414815783501,
                    -0.035728681832551956,
                    -0.01564272865653038,
                    -0.000342672283295542,
                    -0.02086273767054081,
                    0.02126873843371868,
                    0.008142093196511269,
                    0.05512065067887306,
                    0.09434767812490463,
                    0.018546337261795998,
                    -0.010820189490914345,
                    0.06712904572486877,
                    -0.07857069373130798,
                    -0.01986006274819374,
                    0.10773921012878418,
                    0.020295899361371994,
                    0.07902311533689499,
                    0.007137633394449949,
                    0.04997928813099861,
                    0.0015052038943395019,
                    0.06551527976989746,
                    -0.04856717213988304,
                    -0.1034664735198021,
                    -0.07709216326475143,
                    0.06043069064617157,
                    0.05986732617020607,
                    0.027064872905611992,
                    0.062101658433675766,
                    0.013797708787024021,
                    -0.07784132659435272,
                    0.02963540144264698,
                    0.09473565965890884,
                    0.007453732192516327,
                    0.127588152885437,
                    0.04114183038473129,
                    0.009890813380479813,
                    0.008234763517975807,
                    0.005839519202709198,
                    0.025044454261660576,
                    0.052217997610569,
                    0.025501903146505356,
                    0.057376712560653687,
                    -0.010137411765754223,
                    0.04109730198979378,
                    -0.012969913892447948,
                    -0.10838275402784348,
                    -0.03957706689834595,
                    -0.010429678484797478,
                    -0.011144282296299934,
                    -0.04069015383720398,
                    0.09447295218706131,
                    -0.05457872152328491,
                    -0.13909052312374115,
                    -0.05752493441104889,
                    -0.06789860874414444,
                    0.07035146653652191,
                    -0.018680928274989128,
                    -0.029079286381602287,
                    -0.008509252220392227,
                    0.04078109562397003,
                    0.028526894748210907,
                    -0.03860189765691757,
                    0.08998476713895798,
                    -0.10435806214809418,
                    -0.13146857917308807,
                    0.08591170608997345,
                    -0.07639893144369125,
                    -0.0780300498008728,
                    -0.032852355390787125,
                    -0.008070613257586956,
                    -0.04310091957449913,
                    -0.06617695093154907,
                    0.06653428077697754,
                    0.027916638180613518,
                    0.0024442686699330807,
                    -0.081023208796978,
                    0.09067179262638092,
                    -0.08956558257341385,
                    0.04665691405534744,
                    -0.04254191368818283,
                    -0.013308794237673283,
                    0.029782313853502274,
                    0.12230832129716873,
                    0.06927052140235901,
                    0.004548297263681889,
                    0.008159085176885128,
                    -0.030520731583237648,
                    0.001487787812948227,
                    -0.05128693953156471,
                    -0.01870773173868656,
                    -0.072552889585495,
                    -0.009029123932123184,
                    -0.022292664274573326,
                    0.08308884501457214,
                    0.045800551772117615,
                    0.01091000996530056,
                    0.03888601064682007,
                    -0.018915360793471336,
                    0.11392983794212341,
                    0.08107815682888031,
                    -0.05360514670610428,
                    0.09520231187343597,
                    -0.028988271951675415,
                    -0.06173399090766907,
                    0.03236444666981697,
                    -0.07868931442499161,
                    0.03920019045472145,
                    0.0014944596914574504,
                    0.045614127069711685,
                    -0.036575257778167725,
                    0.056417666375637054,
                    0.04492795467376709,
                    -0.021471884101629257,
                    -0.057195957750082016,
                    0.0427815206348896,
                    0.001416398910805583,
                    -0.03163033351302147,
                    0.09023290872573853,
                    -0.05962066724896431,
                    0.059925492852926254,
                    0.07123249024152756,
                    0.14099162817001343,
                    0.03929617628455162,
                    0.12283835560083389,
                    -0.009392572566866875,
                    -0.11811158061027527
                ],
                "diffText": "diff --git a/libheif/heif_colorconversion.cc b/libheif/heif_colorconversion.cc\nindex 33fb746..54771fd 100644\n--- a/libheif/heif_colorconversion.cc\n+++ b/libheif/heif_colorconversion.cc\n@@ -2924,6 +2924,23 @@ std::shared_ptr<HeifPixelImage> heif::convert_colorspace(const std::shared_ptr<H\n                                                          std::shared_ptr<const color_profile_nclx> target_profile,\n                                                          int output_bpp)\n {\n+  // --- check that input image is valid\n+\n+  int width = input->get_width();\n+  int height = input->get_width();\n+\n+  // alpha image should have full image resolution\n+\n+  if (input->has_channel(heif_channel_Alpha)) {\n+    if (input->get_width(heif_channel_Alpha) != width ||\n+        input->get_height(heif_channel_Alpha) != height) {\n+      return nullptr;\n+    }\n+  }\n+\n+\n+  // --- prepare conversion\n+\n   ColorState input_state;\n   input_state.colorspace = input->get_colorspace();\n   input_state.chroma = input->get_chroma_format();"
            }
        },
        "relation2": {
            "identity": 13505,
            "start": 6738,
            "end": 5017,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 5017,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "libheif/heif_colorconversion.cc"
            }
        }
    },
    {
        "baseNode": {
            "identity": 6733,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-22094"
            }
        },
        "relation1": {
            "identity": 13503,
            "start": 6733,
            "end": 5009,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 5009,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "libheif"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 6733,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-22094"
            }
        },
        "relation1": {
            "identity": 13502,
            "start": 6733,
            "end": 6737,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 6737,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "INFO: Seed: 3277304366\nINFO: Loaded 1 modules   (51763 inline 8-bit counters): 51763 [0x8c669c0, 0x8c733f3), \nINFO: Loaded 1 PC tables (51763 PCs): 51763 [0x8adff10,0x8b450a8), \n/out/file-fuzzer: Running 1 inputs 1 time(s) each.\nRunning: /tmp/poc\n=================================================================\n==1==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xf300890f at pc 0x0835f48e bp 0xffa4d588 sp 0xffa4d580\nREAD of size 1 at 0xf300890f thread T0\nSCARINESS: 12 (1-byte-read-heap-buffer-overflow)\n    #0 0x835f48d in Op_RGB_to_RGB24_32::convert_colorspace(std::__1::shared_ptr<heif::HeifPixelImage const> const&, heif::ColorState, heif::ColorConversionOptions) /src/libheif/libheif/heif_colorconversion.cc:164:43\n    #1 0x837ad1a in heif::ColorConversionPipeline::convert_image(std::__1::shared_ptr<heif::HeifPixelImage> const&) /src/libheif/libheif/heif_colorconversion.cc:2446:15\n    #2 0x82ee5d5 in heif::convert_colorspace(std::__1::shared_ptr<heif::HeifPixelImage> const&, heif_colorspace, heif_chroma) /src/libheif/libheif/heif_image.cc:396:19\n    #3 0x83215f8 in heif::HeifContext::Image::decode_image(std::__1::shared_ptr<heif::HeifPixelImage>&, heif_colorspace, heif_chroma, heif_decoding_options const*) const /src/libheif/libheif/heif_context.cc:896:11\n    #4 0x830319a in heif_decode_image /src/libheif/libheif/heif.cc:660:33\n    #5 0x839c2ec in TestDecodeImage(heif_context*, heif_image_handle const*, unsigned int) /src/libheif/libheif/file_fuzzer.cc:59:9\n    #6 0x839ba43 in LLVMFuzzerTestOneInput /src/libheif/libheif/file_fuzzer.cc:98:5\n    #7 0x814c2b6 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:556:15\n    #8 0x8138763 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:292:6\n    #9 0x813de68 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:774:9\n    #10 0x8162c77 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10\n    #11 0xf7cc6646 in __libc_start_main (/lib32/libc.so.6+0x18646)\n    #12 0x811373b in _start (/out/file-fuzzer+0x811373b)\n\nDEDUP_TOKEN: Op_RGB_to_RGB24_32::convert_colorspace(std::__1::shared_ptr<heif::HeifPixelImage const> const&, heif::ColorState, heif::ColorConversionOptions)--heif::ColorConversionPipeline::convert_image(std::__1::shared_ptr<heif::HeifPixelImage> const&)--heif::convert_colorspace(std::__1::shared_ptr<heif::HeifPixelImage> const&, heif_colorspace, heif_chroma)\n0xf300890f is located 0 bytes to the right of 4111-byte region [0xf3007900,0xf300890f)\nallocated by thread T0 here:\n    #0 0x8245019 in operator new[](unsigned int) /src/llvm-project/compiler-rt/lib/asan/asan_new_delete.cpp:102:3\n    #1 0x82ebcae in heif::HeifPixelImage::add_plane(heif_channel, int, int, int) /src/libheif/libheif/heif_image.cc:151:27\n    #2 0x83038e0 in heif_image_add_plane /src/libheif/libheif/heif.cc:745:22\n    #3 0x83938da in convert_libde265_image_to_heif_image(libde265_decoder*, de265_image const*, heif_image**) /src/libheif/libheif/heif_decoder_libde265.cc:126:11\n    #4 0x83934ce in libde265_v1_decode_image(void*, heif_image**) /src/libheif/libheif/heif_decoder_libde265.cc:306:13\n    #5 0x8323125 in heif::HeifContext::decode_image(unsigned int, std::__1::shared_ptr<heif::HeifPixelImage>&, heif_decoding_options const*) const /src/libheif/libheif/heif_context.cc:944:11\n    #6 0x83214c2 in heif::HeifContext::Image::decode_image(std::__1::shared_ptr<heif::HeifPixelImage>&, heif_colorspace, heif_chroma, heif_decoding_options const*) const /src/libheif/libheif/heif_context.cc:880:31\n    #7 0x83223da in heif::HeifContext::decode_image(unsigned int, std::__1::shared_ptr<heif::HeifPixelImage>&, heif_decoding_options const*) const /src/libheif/libheif/heif_context.cc:1017:32\n    #8 0x83214c2 in heif::HeifContext::Image::decode_image(std::__1::shared_ptr<heif::HeifPixelImage>&, heif_colorspace, heif_chroma, heif_decoding_options const*) const /src/libheif/libheif/heif_context.cc:880:31\n    #9 0x830319a in heif_decode_image /src/libheif/libheif/heif.cc:660:33\n    #10 0x839c2ec in TestDecodeImage(heif_context*, heif_image_handle const*, unsigned int) /src/libheif/libheif/file_fuzzer.cc:59:9\n    #11 0x839ba43 in LLVMFuzzerTestOneInput /src/libheif/libheif/file_fuzzer.cc:98:5\n    #12 0x814c2b6 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:556:15\n    #13 0x8138763 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned int) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:292:6\n    #14 0x813de68 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned int)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:774:9\n    #15 0x8162c77 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:19:10\n    #16 0xf7cc6646 in __libc_start_main (/lib32/libc.so.6+0x18646)\n\nDEDUP_TOKEN: operator new[](unsigned int)--heif::HeifPixelImage::add_plane(heif_channel, int, int, int)--heif_image_add_plane\nSUMMARY: AddressSanitizer: heap-buffer-overflow /src/libheif/libheif/heif_colorconversion.cc:164:43 in Op_RGB_to_RGB24_32::convert_colorspace(std::__1::shared_ptr<heif::HeifPixelImage const> const&, heif::ColorState, heif::ColorConversionOptions)\nShadow bytes around the buggy address:\n  0x3e6010d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x3e6010e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x3e6010f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x3e601100: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x3e601110: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=>0x3e601120: 00[07]fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x3e601130: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x3e601140: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x3e601150: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x3e601160: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x3e601170: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n  Shadow gap:              cc\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.043729111552238464,
                    0.03714132308959961,
                    -0.0976940467953682,
                    -0.0008665942586958408,
                    -0.044647637754678726,
                    0.0271324273198843,
                    -0.013418416492640972,
                    0.011340214870870113,
                    0.03611509129405022,
                    -0.02769850753247738,
                    -0.008760455995798111,
                    -0.009310734458267689,
                    -0.06916997581720352,
                    -0.011499877087771893,
                    0.04428299143910408,
                    -0.013942766934633255,
                    0.11181151866912842,
                    0.010137069039046764,
                    -0.0012072743847966194,
                    0.06278759241104126,
                    -0.05338309705257416,
                    0.02178282104432583,
                    -0.006682808976620436,
                    -0.01348462700843811,
                    -0.006200285162776709,
                    0.04856880381703377,
                    -0.10780168324708939,
                    -0.0036166540812700987,
                    -0.022969046607613564,
                    -0.012954860925674438,
                    -0.12433204799890518,
                    -0.12371206283569336,
                    0.0072077177464962006,
                    -0.005966440308839083,
                    0.01639840379357338,
                    0.017208633944392204,
                    -0.019342051818966866,
                    -0.009222318418323994,
                    0.03581451252102852,
                    0.10346619039773941,
                    -0.0989791750907898,
                    -0.04135793074965477,
                    0.01817280612885952,
                    -0.01145682018250227,
                    -0.10361453890800476,
                    0.018127955496311188,
                    0.012971527874469757,
                    -0.020563485100865364,
                    0.08688647300004959,
                    -0.006540834903717041,
                    -0.12702424824237823,
                    -0.024539873003959656,
                    -0.02129746787250042,
                    -0.05368258059024811,
                    -0.04755726829171181,
                    -0.04624975100159645,
                    -0.008480977267026901,
                    0.05340101197361946,
                    -0.06348779052495956,
                    0.08557179570198059,
                    0.011672581546008587,
                    -0.08023672550916672,
                    0.0011237263679504395,
                    -0.008179298602044582,
                    0.023068079724907875,
                    0.04653498902916908,
                    0.08634843677282333,
                    -0.012125455774366856,
                    0.04148062691092491,
                    -0.008095943368971348,
                    0.04137268662452698,
                    0.09751956909894943,
                    -0.07973862439393997,
                    -0.09594663977622986,
                    -0.0657348781824112,
                    0.02350149303674698,
                    -0.03316959738731384,
                    -0.011946621350944042,
                    -0.034046877175569534,
                    -0.13014017045497894,
                    -0.07011367380619049,
                    0.03292981535196304,
                    0.017691971734166145,
                    0.006454933434724808,
                    0.0331098698079586,
                    0.014921237714588642,
                    -0.0050832792185246944,
                    -0.0796230286359787,
                    -0.010807774029672146,
                    -0.037345051765441895,
                    0.025081343948841095,
                    -0.08932221680879593,
                    0.01262450497597456,
                    -0.005914994049817324,
                    0.0003368842008057982,
                    0.01255075540393591,
                    0.0028665356803685427,
                    -0.05793321505188942,
                    0.008054034784436226,
                    0.040766969323158264,
                    -0.03608034551143646,
                    -0.025770803913474083,
                    -0.039296530187129974,
                    -0.029187249019742012,
                    0.0010902051581069827,
                    0.0063970647752285,
                    -0.05348782613873482,
                    -0.003993839491158724,
                    -0.013419948518276215,
                    -0.05411756411194801,
                    -0.0047990442253649235,
                    -0.006093105301260948,
                    -0.012584280222654343,
                    0.03364896774291992,
                    0.05936470627784729,
                    -0.06928310543298721,
                    -0.03335585817694664,
                    -0.05268236994743347,
                    0.024479754269123077,
                    0.03360302746295929,
                    0.02654433064162731,
                    0.04113432392477989,
                    -0.024902159348130226,
                    0.01146727055311203,
                    -0.007041383534669876,
                    -0.027249321341514587,
                    0.041361816227436066,
                    0.028867483139038086,
                    0.0491860955953598,
                    0.09391423314809799,
                    -0.039588455110788345,
                    0.010690069757401943,
                    0.01886550337076187,
                    -0.025647519156336784,
                    -0.015894867479801178,
                    0.018734270706772804,
                    0.08677610754966736,
                    0.017347030341625214,
                    0.03715340793132782,
                    0.0011896118521690369,
                    0.05658575892448425,
                    0.027390947565436363,
                    -0.026084907352924347,
                    0.004719472024589777,
                    0.06769104301929474,
                    -0.0021821458358317614,
                    0.05135932192206383,
                    0.011622791178524494,
                    0.012501566670835018,
                    -0.025497430935502052,
                    0.03338596597313881,
                    -0.04501305893063545,
                    -0.04689107835292816,
                    -0.04797496274113655,
                    0.05196547508239746,
                    -0.0016403101617470384,
                    -0.004842841997742653,
                    -0.01947145164012909,
                    -0.02837185747921467,
                    -0.010915792547166348,
                    0.01589779742062092,
                    0.07150972634553909,
                    -0.025250760838389397,
                    0.1422744244337082,
                    -0.012283985503017902,
                    0.011645312421023846,
                    -0.054785776883363724,
                    0.011981076560914516,
                    0.02896704711019993,
                    0.039356958121061325,
                    -0.04845830798149109,
                    -0.007749153301119804,
                    0.021040210500359535,
                    0.012161633931100368,
                    0.02152465097606182,
                    -0.03539973869919777,
                    -0.026281429454684258,
                    0.049058813601732254,
                    0.026348307728767395,
                    0.0014569187769666314,
                    0.020442232489585876,
                    0.04245351627469063,
                    -0.09303012490272522,
                    -0.047051649540662766,
                    -0.05115552246570587,
                    0.027780132368206978,
                    -0.08879423141479492,
                    -0.05577850341796875,
                    -0.04297901317477226,
                    0.04507709667086601,
                    0.02986287884414196,
                    -0.0157537292689085,
                    0.0644276961684227,
                    -0.0330703929066658,
                    -0.1295270174741745,
                    -0.009514535777270794,
                    0.003079391084611416,
                    0.003395161824300885,
                    0.012983035296201706,
                    -0.09481396526098251,
                    -0.08401886373758316,
                    -0.03417098894715309,
                    0.06773803383111954,
                    0.02622275985777378,
                    0.039347633719444275,
                    -0.07693604379892349,
                    0.09543570131063461,
                    -0.013286200352013111,
                    0.09152767062187195,
                    -0.01752339117228985,
                    -0.03033251129090786,
                    0.011811318807303905,
                    0.10509175807237625,
                    0.05796827748417854,
                    0.012180249206721783,
                    -0.0187832098454237,
                    0.008517755195498466,
                    -0.010985608212649822,
                    -0.07115281373262405,
                    0.013249531388282776,
                    -0.023752665147185326,
                    0.012863713316619396,
                    -0.016420328989624977,
                    -0.029212646186351776,
                    0.035611096769571304,
                    0.02459283359348774,
                    -0.038099505007267,
                    0.04503751918673515,
                    0.07689429074525833,
                    0.05567486956715584,
                    -0.04897550866007805,
                    0.04231378436088562,
                    -0.01525494921952486,
                    0.031470123678445816,
                    0.02198570966720581,
                    -0.004215950611978769,
                    0.07951052486896515,
                    0.025125110521912575,
                    -0.01194628607481718,
                    -0.05070781335234642,
                    -0.010185438208281994,
                    -0.015905248001217842,
                    -0.01702217571437359,
                    -0.019330965355038643,
                    0.06626057624816895,
                    -0.049785539507865906,
                    -0.04341473802924156,
                    0.0648057833313942,
                    -0.00045430721365846694,
                    0.05255923792719841,
                    0.027914276346564293,
                    -0.013510814867913723,
                    0.10285364836454391,
                    0.04712146520614624,
                    0.008021821267902851,
                    -0.02988913655281067
                ],
                "report_type": "Heap-buffer-overflow READ 1",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 6733,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-22094"
            }
        },
        "relation1": {
            "identity": 13501,
            "start": 6733,
            "end": 6736,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 6736,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "check color conversion input for correct size of alpha plane (oss-fuzz 22094)\n",
                "sha": "b7484d2ed35338970b727e55adb509f2200b0e40",
                "repo": "libheif",
                "encoding": "UTF-8",
                "authored_date": 1597403104,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1597403104
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 6733,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-libheif-22094"
            }
        },
        "relation1": {
            "identity": 13496,
            "start": 6733,
            "end": 6734,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 6734,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "fix testing code for chroma 4:2:2 in colorspace_fuzzer\n",
                "sha": "0e329635b8539d4a22f45dfc4d537c7717932eb8",
                "repo": "libheif",
                "encoding": "UTF-8",
                "authored_date": 1597401319,
                "committer_tz_offset": -7200,
                "author_tz_offset": -7200,
                "committed_date": 1597401319
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]