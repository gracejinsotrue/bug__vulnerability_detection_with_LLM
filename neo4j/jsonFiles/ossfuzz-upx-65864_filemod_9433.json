[
    {
        "baseNode": {
            "identity": 9428,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-upx-65864"
            }
        },
        "relation1": {
            "identity": 19368,
            "start": 9428,
            "end": 9433,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 9433,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.04353717714548111,
                    -0.061063505709171295,
                    -0.17925073206424713,
                    0.12526781857013702,
                    -0.019826097413897514,
                    0.02589142881333828,
                    -0.056012723594903946,
                    0.12849420309066772,
                    0.0317285917699337,
                    -0.03306973725557327,
                    0.05092909559607506,
                    0.056102003902196884,
                    -0.0014305294025689363,
                    -0.025943227112293243,
                    0.07095266878604889,
                    -0.05651060864329338,
                    0.15404494106769562,
                    -0.06527608633041382,
                    0.032989632338285446,
                    0.09276951104402542,
                    -0.06725408136844635,
                    -0.042601969093084335,
                    -0.041602540761232376,
                    0.13363005220890045,
                    -0.009959938935935497,
                    -0.10180674493312836,
                    -0.0791221484541893,
                    -0.0094318687915802,
                    -0.05112559348344803,
                    -0.005947841331362724,
                    -0.06622792035341263,
                    -0.18041588366031647,
                    0.016336854547262192,
                    -0.04098369553685188,
                    0.046238064765930176,
                    -0.005541109014302492,
                    0.02986772172152996,
                    -0.07545943558216095,
                    -0.017308587208390236,
                    0.03707784786820412,
                    -0.07019378244876862,
                    -0.05189394950866699,
                    0.07352402806282043,
                    -0.03421272709965706,
                    -0.07118013501167297,
                    0.075722835958004,
                    -0.02743893302977085,
                    -0.031554270535707474,
                    -0.020535312592983246,
                    -0.015561085194349289,
                    0.023749222978949547,
                    0.02468683198094368,
                    -0.1410485953092575,
                    -0.07866865396499634,
                    -0.03680107370018959,
                    -0.024486729875206947,
                    -0.053179189562797546,
                    0.06529807299375534,
                    -0.05547226220369339,
                    0.06692691892385483,
                    -0.00785856880247593,
                    0.0011216846760362387,
                    0.04729838669300079,
                    -0.034557096660137177,
                    0.05155111104249954,
                    0.06179241091012955,
                    0.09696795791387558,
                    -0.08567537367343903,
                    -0.005392846185714006,
                    0.008339118212461472,
                    0.08385028690099716,
                    0.06219314783811569,
                    -0.07294785976409912,
                    0.004436499439179897,
                    -0.08244393020868301,
                    -0.027464494109153748,
                    0.014628798700869083,
                    -0.04979702830314636,
                    0.05363452062010765,
                    -0.14078983664512634,
                    -0.07060576230287552,
                    0.0632399320602417,
                    0.0647030919790268,
                    -0.0644061416387558,
                    0.09799410402774811,
                    -0.039389438927173615,
                    0.0071238307282328606,
                    0.03191584721207619,
                    0.03770845755934715,
                    0.06868083775043488,
                    0.06425175070762634,
                    -0.12426230311393738,
                    0.13392043113708496,
                    -0.03238661214709282,
                    0.05752354860305786,
                    -0.00725652975961566,
                    0.03243754431605339,
                    -0.013742726296186447,
                    -0.020524853840470314,
                    -0.023084530606865883,
                    -0.05339384824037552,
                    -0.09364765882492065,
                    -0.04190238565206528,
                    -0.06814535707235336,
                    -0.02852482721209526,
                    0.006443561054766178,
                    -0.10996105521917343,
                    0.03902769088745117,
                    0.04929472878575325,
                    -0.0675770491361618,
                    0.06645455956459045,
                    0.07905268669128418,
                    -0.051140617579221725,
                    0.09928088635206223,
                    0.09244987368583679,
                    -0.021890148520469666,
                    -0.047968532890081406,
                    -0.05543414130806923,
                    0.011754394508898258,
                    0.0457974448800087,
                    0.09881506860256195,
                    -0.017949676141142845,
                    0.045666541904211044,
                    0.034257590770721436,
                    -0.029333721846342087,
                    -0.05653875693678856,
                    -0.05981123819947243,
                    0.07685577124357224,
                    0.08465110510587692,
                    0.06396295875310898,
                    -0.02599431946873665,
                    -0.04172605276107788,
                    0.07042476534843445,
                    -0.02867979183793068,
                    0.03832961246371269,
                    0.0665532797574997,
                    0.1524457484483719,
                    0.09474503248929977,
                    0.08160161972045898,
                    -0.014238721691071987,
                    0.0386711061000824,
                    0.07322779297828674,
                    -0.0371975302696228,
                    0.03818070888519287,
                    0.07211378216743469,
                    -0.06981675326824188,
                    0.04676700755953789,
                    -0.014029772020876408,
                    -0.029287206009030342,
                    -0.08733813464641571,
                    0.034576866775751114,
                    -0.07981057465076447,
                    -0.12345079332590103,
                    -0.0070357611402869225,
                    -0.01258369255810976,
                    0.0014581010909751058,
                    0.053570423275232315,
                    0.07734882831573486,
                    -0.14244979619979858,
                    -0.015812182798981667,
                    -0.023285089060664177,
                    0.08869905024766922,
                    0.0700555145740509,
                    0.062335532158613205,
                    0.022490274161100388,
                    0.02274811640381813,
                    0.02763945795595646,
                    -0.015604016371071339,
                    0.008495240472257137,
                    0.030147666111588478,
                    -0.015238194726407528,
                    -0.008745317347347736,
                    -0.014919430948793888,
                    -0.11944699287414551,
                    0.026445191353559494,
                    -0.06494292616844177,
                    0.016154754906892776,
                    0.016128571704030037,
                    -0.06536932289600372,
                    0.010262922383844852,
                    0.014258258044719696,
                    -0.04860156401991844,
                    -0.06448511779308319,
                    -0.02291828580200672,
                    -0.01789642870426178,
                    0.011819107457995415,
                    0.013969194144010544,
                    -0.06053869426250458,
                    0.00012509507359936833,
                    0.008085362613201141,
                    0.052046459168195724,
                    -0.10159635543823242,
                    0.037685345858335495,
                    0.05070073530077934,
                    -0.018339546397328377,
                    0.08922207355499268,
                    -0.05071088671684265,
                    0.042173415422439575,
                    -0.02600506693124771,
                    -0.08318998664617538,
                    -0.06387082487344742,
                    -0.04287634789943695,
                    0.13708896934986115,
                    -0.04945388436317444,
                    0.08753173053264618,
                    -0.05819122865796089,
                    0.00017491992912255228,
                    -0.007138900458812714,
                    -0.03720729425549507,
                    -0.03149893507361412,
                    0.03701888397336006,
                    0.007544402498751879,
                    0.08073335886001587,
                    0.06291889399290085,
                    0.016812574118375778,
                    -0.05835757777094841,
                    0.019196711480617523,
                    0.026067007333040237,
                    0.03193698450922966,
                    -0.002014529425650835,
                    -0.048144202679395676,
                    -0.02365105226635933,
                    -0.008021673187613487,
                    -0.037035923451185226,
                    0.09054882824420929,
                    -0.10602549463510513,
                    -0.0746012032032013,
                    -0.01849468983709812,
                    0.11568373441696167,
                    0.08100669831037521,
                    -0.05863526463508606,
                    0.007963821291923523,
                    -0.07148215174674988,
                    -0.03328844904899597,
                    -0.006207827944308519,
                    -0.03007693774998188,
                    -0.009371860884130001,
                    0.06053832173347473,
                    -0.07377296686172485,
                    -0.041133057326078415,
                    0.013673629611730576,
                    0.012876455672085285,
                    -0.03017209842801094,
                    -0.05164295434951782,
                    0.13981787860393524,
                    -0.13452251255512238,
                    -0.0489044226706028,
                    0.08647023886442184,
                    -0.06888628751039505,
                    0.02951599285006523,
                    0.007542464416474104,
                    0.04609264060854912,
                    -0.01608714647591114,
                    0.06152493506669998,
                    -0.02501998282968998,
                    -0.09449166059494019
                ],
                "diffText": "diff --git a/src/p_unix.cpp b/src/p_unix.cpp\nindex bbc30b0b..ee08e751 100644\n--- a/src/p_unix.cpp\n+++ b/src/p_unix.cpp\n@@ -619,9 +619,14 @@ void PackUnix::unpack(OutputFile *fo)\n         fi->readx(&hbuf, sizeof(hbuf));\n         orig_file_size = get_te32(&hbuf.p_filesize);\n         blocksize = get_te32(&hbuf.p_blocksize);\n+        off_t max_inflated = file_size * 273;  // zlib limit (256 + 16 + 1)\n \n-        if (file_size > (off_t)orig_file_size || blocksize > orig_file_size)\n+        if (max_inflated < orig_file_size\n+        ||  max_inflated < blocksize\n+        ||  file_size > (off_t)orig_file_size\n+        ||  blocksize > orig_file_size) {\n             throwCantUnpack(\"file header corrupted\");\n+        }\n     }\n     else\n     {"
            }
        },
        "relation2": {
            "identity": 19368,
            "start": 9433,
            "end": 9428,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 9428,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-upx-65864"
            }
        }
    },
    {
        "baseNode": {
            "identity": 9428,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-upx-65864"
            }
        },
        "relation1": {
            "identity": 19368,
            "start": 9428,
            "end": 9433,
            "type": "PATCHED_FILE",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 9433,
            "labels": [
                "FileModification"
            ],
            "properties": {
                "diffEmbeddings": [
                    0.04353717714548111,
                    -0.061063505709171295,
                    -0.17925073206424713,
                    0.12526781857013702,
                    -0.019826097413897514,
                    0.02589142881333828,
                    -0.056012723594903946,
                    0.12849420309066772,
                    0.0317285917699337,
                    -0.03306973725557327,
                    0.05092909559607506,
                    0.056102003902196884,
                    -0.0014305294025689363,
                    -0.025943227112293243,
                    0.07095266878604889,
                    -0.05651060864329338,
                    0.15404494106769562,
                    -0.06527608633041382,
                    0.032989632338285446,
                    0.09276951104402542,
                    -0.06725408136844635,
                    -0.042601969093084335,
                    -0.041602540761232376,
                    0.13363005220890045,
                    -0.009959938935935497,
                    -0.10180674493312836,
                    -0.0791221484541893,
                    -0.0094318687915802,
                    -0.05112559348344803,
                    -0.005947841331362724,
                    -0.06622792035341263,
                    -0.18041588366031647,
                    0.016336854547262192,
                    -0.04098369553685188,
                    0.046238064765930176,
                    -0.005541109014302492,
                    0.02986772172152996,
                    -0.07545943558216095,
                    -0.017308587208390236,
                    0.03707784786820412,
                    -0.07019378244876862,
                    -0.05189394950866699,
                    0.07352402806282043,
                    -0.03421272709965706,
                    -0.07118013501167297,
                    0.075722835958004,
                    -0.02743893302977085,
                    -0.031554270535707474,
                    -0.020535312592983246,
                    -0.015561085194349289,
                    0.023749222978949547,
                    0.02468683198094368,
                    -0.1410485953092575,
                    -0.07866865396499634,
                    -0.03680107370018959,
                    -0.024486729875206947,
                    -0.053179189562797546,
                    0.06529807299375534,
                    -0.05547226220369339,
                    0.06692691892385483,
                    -0.00785856880247593,
                    0.0011216846760362387,
                    0.04729838669300079,
                    -0.034557096660137177,
                    0.05155111104249954,
                    0.06179241091012955,
                    0.09696795791387558,
                    -0.08567537367343903,
                    -0.005392846185714006,
                    0.008339118212461472,
                    0.08385028690099716,
                    0.06219314783811569,
                    -0.07294785976409912,
                    0.004436499439179897,
                    -0.08244393020868301,
                    -0.027464494109153748,
                    0.014628798700869083,
                    -0.04979702830314636,
                    0.05363452062010765,
                    -0.14078983664512634,
                    -0.07060576230287552,
                    0.0632399320602417,
                    0.0647030919790268,
                    -0.0644061416387558,
                    0.09799410402774811,
                    -0.039389438927173615,
                    0.0071238307282328606,
                    0.03191584721207619,
                    0.03770845755934715,
                    0.06868083775043488,
                    0.06425175070762634,
                    -0.12426230311393738,
                    0.13392043113708496,
                    -0.03238661214709282,
                    0.05752354860305786,
                    -0.00725652975961566,
                    0.03243754431605339,
                    -0.013742726296186447,
                    -0.020524853840470314,
                    -0.023084530606865883,
                    -0.05339384824037552,
                    -0.09364765882492065,
                    -0.04190238565206528,
                    -0.06814535707235336,
                    -0.02852482721209526,
                    0.006443561054766178,
                    -0.10996105521917343,
                    0.03902769088745117,
                    0.04929472878575325,
                    -0.0675770491361618,
                    0.06645455956459045,
                    0.07905268669128418,
                    -0.051140617579221725,
                    0.09928088635206223,
                    0.09244987368583679,
                    -0.021890148520469666,
                    -0.047968532890081406,
                    -0.05543414130806923,
                    0.011754394508898258,
                    0.0457974448800087,
                    0.09881506860256195,
                    -0.017949676141142845,
                    0.045666541904211044,
                    0.034257590770721436,
                    -0.029333721846342087,
                    -0.05653875693678856,
                    -0.05981123819947243,
                    0.07685577124357224,
                    0.08465110510587692,
                    0.06396295875310898,
                    -0.02599431946873665,
                    -0.04172605276107788,
                    0.07042476534843445,
                    -0.02867979183793068,
                    0.03832961246371269,
                    0.0665532797574997,
                    0.1524457484483719,
                    0.09474503248929977,
                    0.08160161972045898,
                    -0.014238721691071987,
                    0.0386711061000824,
                    0.07322779297828674,
                    -0.0371975302696228,
                    0.03818070888519287,
                    0.07211378216743469,
                    -0.06981675326824188,
                    0.04676700755953789,
                    -0.014029772020876408,
                    -0.029287206009030342,
                    -0.08733813464641571,
                    0.034576866775751114,
                    -0.07981057465076447,
                    -0.12345079332590103,
                    -0.0070357611402869225,
                    -0.01258369255810976,
                    0.0014581010909751058,
                    0.053570423275232315,
                    0.07734882831573486,
                    -0.14244979619979858,
                    -0.015812182798981667,
                    -0.023285089060664177,
                    0.08869905024766922,
                    0.0700555145740509,
                    0.062335532158613205,
                    0.022490274161100388,
                    0.02274811640381813,
                    0.02763945795595646,
                    -0.015604016371071339,
                    0.008495240472257137,
                    0.030147666111588478,
                    -0.015238194726407528,
                    -0.008745317347347736,
                    -0.014919430948793888,
                    -0.11944699287414551,
                    0.026445191353559494,
                    -0.06494292616844177,
                    0.016154754906892776,
                    0.016128571704030037,
                    -0.06536932289600372,
                    0.010262922383844852,
                    0.014258258044719696,
                    -0.04860156401991844,
                    -0.06448511779308319,
                    -0.02291828580200672,
                    -0.01789642870426178,
                    0.011819107457995415,
                    0.013969194144010544,
                    -0.06053869426250458,
                    0.00012509507359936833,
                    0.008085362613201141,
                    0.052046459168195724,
                    -0.10159635543823242,
                    0.037685345858335495,
                    0.05070073530077934,
                    -0.018339546397328377,
                    0.08922207355499268,
                    -0.05071088671684265,
                    0.042173415422439575,
                    -0.02600506693124771,
                    -0.08318998664617538,
                    -0.06387082487344742,
                    -0.04287634789943695,
                    0.13708896934986115,
                    -0.04945388436317444,
                    0.08753173053264618,
                    -0.05819122865796089,
                    0.00017491992912255228,
                    -0.007138900458812714,
                    -0.03720729425549507,
                    -0.03149893507361412,
                    0.03701888397336006,
                    0.007544402498751879,
                    0.08073335886001587,
                    0.06291889399290085,
                    0.016812574118375778,
                    -0.05835757777094841,
                    0.019196711480617523,
                    0.026067007333040237,
                    0.03193698450922966,
                    -0.002014529425650835,
                    -0.048144202679395676,
                    -0.02365105226635933,
                    -0.008021673187613487,
                    -0.037035923451185226,
                    0.09054882824420929,
                    -0.10602549463510513,
                    -0.0746012032032013,
                    -0.01849468983709812,
                    0.11568373441696167,
                    0.08100669831037521,
                    -0.05863526463508606,
                    0.007963821291923523,
                    -0.07148215174674988,
                    -0.03328844904899597,
                    -0.006207827944308519,
                    -0.03007693774998188,
                    -0.009371860884130001,
                    0.06053832173347473,
                    -0.07377296686172485,
                    -0.041133057326078415,
                    0.013673629611730576,
                    0.012876455672085285,
                    -0.03017209842801094,
                    -0.05164295434951782,
                    0.13981787860393524,
                    -0.13452251255512238,
                    -0.0489044226706028,
                    0.08647023886442184,
                    -0.06888628751039505,
                    0.02951599285006523,
                    0.007542464416474104,
                    0.04609264060854912,
                    -0.01608714647591114,
                    0.06152493506669998,
                    -0.02501998282968998,
                    -0.09449166059494019
                ],
                "diffText": "diff --git a/src/p_unix.cpp b/src/p_unix.cpp\nindex bbc30b0b..ee08e751 100644\n--- a/src/p_unix.cpp\n+++ b/src/p_unix.cpp\n@@ -619,9 +619,14 @@ void PackUnix::unpack(OutputFile *fo)\n         fi->readx(&hbuf, sizeof(hbuf));\n         orig_file_size = get_te32(&hbuf.p_filesize);\n         blocksize = get_te32(&hbuf.p_blocksize);\n+        off_t max_inflated = file_size * 273;  // zlib limit (256 + 16 + 1)\n \n-        if (file_size > (off_t)orig_file_size || blocksize > orig_file_size)\n+        if (max_inflated < orig_file_size\n+        ||  max_inflated < blocksize\n+        ||  file_size > (off_t)orig_file_size\n+        ||  blocksize > orig_file_size) {\n             throwCantUnpack(\"file header corrupted\");\n+        }\n     }\n     else\n     {"
            }
        },
        "relation2": {
            "identity": 19367,
            "start": 9433,
            "end": 2248,
            "type": "FILE_MODIFICATION",
            "properties": {}
        },
        "twoEdgesAway": {
            "identity": 2248,
            "labels": [
                "SourceFile"
            ],
            "properties": {
                "path": "src/p_unix.cpp"
            }
        }
    },
    {
        "baseNode": {
            "identity": 9428,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-upx-65864"
            }
        },
        "relation1": {
            "identity": 19365,
            "start": 9428,
            "end": 1230,
            "type": "PROJECT_VULNERABILITIES",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 1230,
            "labels": [
                "Project"
            ],
            "properties": {
                "projectSource": "oss-fuzz",
                "projectName": "upx"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 9428,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-upx-65864"
            }
        },
        "relation1": {
            "identity": 19364,
            "start": 9428,
            "end": 9432,
            "type": "CRASH_PATCH",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 9432,
            "labels": [
                "CrashReport"
            ],
            "properties": {
                "sanitizer": "asan",
                "report_content": "INFO: Running with entropic power schedule (0xFF, 100).\nINFO: Seed: 1175089610\nINFO: Loaded 1 modules   (39761 inline 8-bit counters): 39761 [0xd24c98, 0xd2e7e9), \nINFO: Loaded 1 PC tables (39761 PCs): 39761 [0xba9168,0xc44678), \n/out/test_packed_file_fuzzer: Running 1 inputs 1 time(s) each.\nRunning: /tmp/poc\n                       Ultimate Packer for eXecutables\n                          Copyright (C) 1996 - 2024\nUPX git-b01944+ Markus Oberhumer, Laszlo Molnar & John Reiser    Jan 4th 2024\n\ntesting /tmp/libfuzzer.1 =================================================================\n==1==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f7fe19f8021 at pc 0x0000009088fe bp 0x7ffcf62540e0 sp 0x7ffcf62540d8\nREAD of size 4 at 0x7f7fe19f8021 thread T0\nSCARINESS: 17 (4-byte-read-heap-buffer-overflow)\n    #0 0x9088fd in ucl_nrv2e_decompress_safe_le32 /src/upx/vendor/ucl/src/n2e_d.c:80:35\n    #1 0x65ca70 in upx_ucl_decompress(unsigned char const*, unsigned int, unsigned char*, unsigned int*, int, upx_compress_result_t const*) /src/upx/src/compress/compress_ucl.cpp:183:13\n    #2 0x61c189 in upx_decompress(unsigned char const*, unsigned int, unsigned char*, unsigned int*, int, upx_compress_result_t const*) /src/upx/src/compress/compress.cpp:161:13\n    #3 0x840e12 in ph_decompress(PackHeader&, XSpan::PtrOrSpan<unsigned char const>, XSpan::PtrOrSpan<unsigned char>, bool, Filter*) /src/upx/src/packhead.cpp:335:13\n    #4 0x82bd84 in Packer::decompress(XSpan::PtrOrSpan<unsigned char const>, XSpan::PtrOrSpan<unsigned char>, bool, Filter*) /src/upx/src/packer.cpp:303:5\n    #5 0x7d99cb in PackUnix::unpack(OutputFile*) /src/upx/src/p_unix.cpp:675:13\n    #6 0x828bc1 in Packer::doTest() /src/upx/src/packer.cpp:104:5\n    #7 0x8d75ca in do_one_file(char const*, char*) /src/upx/src/work.cpp:335:12\n    #8 0x8d8f58 in do_files(int, int, char**) /src/upx/src/work.cpp:421:13\n    #9 0x6b183e in upx_main(int, char**) /src/upx/src/main.cpp:1303:9\n    #10 0x577a7c in LLVMFuzzerTestOneInput /src/upx/fuzzers/test_packed_file_fuzzer.cpp:43:5\n    #11 0x449213 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15\n    #12 0x434972 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6\n    #13 0x43a21c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9\n    #14 0x463752 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #15 0x7f7fe53f3082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: eebe5d5f4b608b8a53ec446b63981bba373ca0ca)\n    #16 0x42ab3d in _start (/out/test_packed_file_fuzzer+0x42ab3d)\n\nDEDUP_TOKEN: ucl_nrv2e_decompress_safe_le32--upx_ucl_decompress(unsigned char const*, unsigned int, unsigned char*, unsigned int*, int, upx_compress_result_t const*)--upx_decompress(unsigned char const*, unsigned int, unsigned char*, unsigned int*, int, upx_compress_result_t const*)\n0x7f7fe19f8021 is located 1 bytes to the right of 538978336-byte region [0x7f7fc17f5800,0x7f7fe19f8020)\nallocated by thread T0 here:\n    #0 0x53a3a6 in __interceptor_malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:69:3\n    #1 0x8b1b45 in MemBuffer::alloc(unsigned long long) /src/upx/src/util/membuffer.cpp:179:24\n    #2 0x7d911d in PackUnix::unpack(OutputFile*) /src/upx/src/p_unix.cpp:634:10\n    #3 0x828bc1 in Packer::doTest() /src/upx/src/packer.cpp:104:5\n    #4 0x8d75ca in do_one_file(char const*, char*) /src/upx/src/work.cpp:335:12\n    #5 0x8d8f58 in do_files(int, int, char**) /src/upx/src/work.cpp:421:13\n    #6 0x6b183e in upx_main(int, char**) /src/upx/src/main.cpp:1303:9\n    #7 0x577a7c in LLVMFuzzerTestOneInput /src/upx/fuzzers/test_packed_file_fuzzer.cpp:43:5\n    #8 0x449213 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:611:15\n    #9 0x434972 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:324:6\n    #10 0x43a21c in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:860:9\n    #11 0x463752 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\n    #12 0x7f7fe53f3082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: eebe5d5f4b608b8a53ec446b63981bba373ca0ca)\n\nDEDUP_TOKEN: __interceptor_malloc--MemBuffer::alloc(unsigned long long)--PackUnix::unpack(OutputFile*)\nSUMMARY: AddressSanitizer: heap-buffer-overflow /src/upx/vendor/ucl/src/n2e_d.c:80:35 in ucl_nrv2e_decompress_safe_le32\nShadow bytes around the buggy address:\n  0x0ff07c336fb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0ff07c336fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0ff07c336fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0ff07c336fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0ff07c336ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n=>0x0ff07c337000: 00 00 00 00[fa]fa fa fa fa fa fa fa fa fa fa fa\n  0x0ff07c337010: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0ff07c337020: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0ff07c337030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0ff07c337040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0ff07c337050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n==1==ABORTING\n\nReturn Code: 1\n",
                "report_embeddings": [
                    0.04283915087580681,
                    0.05705999955534935,
                    -0.11987587064504623,
                    -0.00250799092464149,
                    0.004519548732787371,
                    0.034599121659994125,
                    0.0012728888541460037,
                    0.044818852096796036,
                    0.06847493350505829,
                    -0.028629804030060768,
                    0.005458152387291193,
                    0.0019165711710229516,
                    -0.019489938393235207,
                    0.006982372608035803,
                    0.08694547414779663,
                    -0.008246218785643578,
                    0.074101023375988,
                    0.02804805338382721,
                    0.047296714037656784,
                    0.05401841923594475,
                    -0.06937454640865326,
                    0.0029227689374238253,
                    -0.01608632318675518,
                    -0.0035654716193675995,
                    -0.07384214550256729,
                    0.008386354893445969,
                    -0.15626606345176697,
                    -0.040984392166137695,
                    -0.005612068343907595,
                    -0.059185560792684555,
                    -0.11698003858327866,
                    -0.140940859913826,
                    -0.002680353121832013,
                    -0.06476173549890518,
                    0.019185511395335197,
                    -0.031129702925682068,
                    0.04299545660614967,
                    0.007794979959726334,
                    0.04016062989830971,
                    0.11271017789840698,
                    -0.05867863819003105,
                    -0.0615563839673996,
                    0.04479692876338959,
                    -0.017072247341275215,
                    -0.047166481614112854,
                    0.0610785186290741,
                    0.02058701403439045,
                    -0.020462797954678535,
                    0.04946248233318329,
                    -0.02207615226507187,
                    -0.09884987026453018,
                    0.04528171941637993,
                    -0.0765761286020279,
                    -0.08109421283006668,
                    -0.07582197338342667,
                    -0.09506106376647949,
                    0.02680634893476963,
                    0.06735151261091232,
                    -0.050237927585840225,
                    0.12135815620422363,
                    0.0308623518794775,
                    -0.05004962161183357,
                    0.04227656498551369,
                    0.016101256012916565,
                    -0.04552469030022621,
                    0.02763155661523342,
                    0.05338384583592415,
                    0.060000140219926834,
                    0.02598576992750168,
                    0.018112637102603912,
                    0.04271499812602997,
                    0.1599082499742508,
                    -0.06340040266513824,
                    -0.11237471550703049,
                    -0.034726135432720184,
                    0.06523992866277695,
                    -0.05933373048901558,
                    -0.004694438073784113,
                    -0.018397627398371696,
                    -0.14697785675525665,
                    -0.0433770976960659,
                    0.03569505363702774,
                    0.055800944566726685,
                    0.03143296018242836,
                    0.031946439296007156,
                    0.021697809919714928,
                    -0.029484132304787636,
                    -0.020418448373675346,
                    -0.025174444541335106,
                    -0.017025398090481758,
                    0.09235205501317978,
                    -0.13912470638751984,
                    0.03655574098229408,
                    -0.021967688575387,
                    0.051838770508766174,
                    -0.009764742106199265,
                    0.020515931770205498,
                    -0.00869277585297823,
                    -0.04306459426879883,
                    0.014819842763245106,
                    -0.03729928657412529,
                    -0.05755658820271492,
                    0.02243698202073574,
                    -0.026680009439587593,
                    -0.03112659603357315,
                    -0.027423853054642677,
                    -0.061848465353250504,
                    -0.026713907718658447,
                    0.005682036280632019,
                    -0.022933026775717735,
                    -0.01599965989589691,
                    -0.013317408971488476,
                    -0.01746785081923008,
                    0.06776093691587448,
                    0.09272155165672302,
                    -0.03972923383116722,
                    -0.037315916270017624,
                    -0.04571893811225891,
                    0.04389191046357155,
                    0.026675447821617126,
                    0.008145255036652088,
                    0.004900211934000254,
                    -0.016660165041685104,
                    -0.006121136248111725,
                    -0.022040655836462975,
                    0.019376590847969055,
                    0.027181826531887054,
                    0.013099373318254948,
                    0.03937375172972679,
                    0.07086949795484543,
                    -0.013706105761229992,
                    0.024155626073479652,
                    0.08642276376485825,
                    -0.008495156653225422,
                    -0.034217581152915955,
                    0.06373075395822525,
                    0.09497305750846863,
                    -0.026729119941592216,
                    0.008113974705338478,
                    -0.002037161262705922,
                    0.06649484485387802,
                    0.00952126458287239,
                    -0.04685482382774353,
                    0.01888604648411274,
                    0.0576624721288681,
                    -0.07452317327260971,
                    0.03078504651784897,
                    0.026042552664875984,
                    -0.001444811001420021,
                    0.032521843910217285,
                    0.0032843442168086767,
                    -0.03913749381899834,
                    -0.0931381806731224,
                    -0.032596033066511154,
                    0.007831295020878315,
                    0.01210881769657135,
                    0.03812095522880554,
                    0.015282385051250458,
                    -0.05377556383609772,
                    0.016329633072018623,
                    -0.006965741515159607,
                    0.11100136488676071,
                    -0.012739975936710835,
                    0.12613797187805176,
                    -0.036885734647512436,
                    0.0824819877743721,
                    -0.007326676044613123,
                    -0.021543657407164574,
                    -0.00158650369849056,
                    0.003501602215692401,
                    -0.031097784638404846,
                    0.008026432245969772,
                    0.020764365792274475,
                    -0.017538433894515038,
                    -0.006019811611622572,
                    -0.01992574706673622,
                    -0.03468955308198929,
                    0.04254274070262909,
                    -0.020581549033522606,
                    0.022812822833657265,
                    -0.01672402210533619,
                    0.05263837054371834,
                    -0.019000740721821785,
                    -0.021903270855545998,
                    -0.02536178193986416,
                    0.014579934068024158,
                    -0.053858425468206406,
                    -0.0441594123840332,
                    0.025625543668866158,
                    0.008636116050183773,
                    0.022339610382914543,
                    -0.03402962163090706,
                    0.01739741861820221,
                    -0.006583603098988533,
                    -0.09451806545257568,
                    0.0017718399176374078,
                    -0.011090735904872417,
                    0.03421010449528694,
                    0.029579028487205505,
                    -0.135712668299675,
                    -0.07535480707883835,
                    -0.065569669008255,
                    0.10599236935377121,
                    -0.028045563027262688,
                    0.016045240685343742,
                    -0.08276285976171494,
                    0.07669224590063095,
                    0.015570733696222305,
                    0.05158832669258118,
                    -0.001292772009037435,
                    0.022936329245567322,
                    0.020938798785209656,
                    0.1110149621963501,
                    0.02467694692313671,
                    -0.0113249896094203,
                    -0.04991689696907997,
                    0.019950605928897858,
                    -0.04586169496178627,
                    -0.08215410262346268,
                    0.013666613958775997,
                    -0.04401732608675957,
                    4.646368324756622e-06,
                    0.00041750058881007135,
                    -0.06996767967939377,
                    0.0775478258728981,
                    -0.05429801717400551,
                    -0.05279208719730377,
                    0.05978262051939964,
                    0.05866622552275658,
                    0.02442057617008686,
                    -0.08399034291505814,
                    -0.003127761883661151,
                    -0.015116136521100998,
                    0.023854032158851624,
                    -0.00958877895027399,
                    0.023785753175616264,
                    0.0896957591176033,
                    0.0328298956155777,
                    -0.032912883907556534,
                    -0.06640779972076416,
                    0.005054740700870752,
                    -0.019013376906514168,
                    -0.04505160078406334,
                    -0.03351070359349251,
                    0.1323254555463791,
                    -0.08574707061052322,
                    -0.05839437246322632,
                    0.02876151166856289,
                    -0.047172416001558304,
                    0.06290004402399063,
                    -0.018452784046530724,
                    0.008796674199402332,
                    0.1021452248096466,
                    0.0006737328949384391,
                    0.05796162411570549,
                    -0.027118323370814323
                ],
                "report_type": "Heap-buffer-overflow READ 4",
                "severity": "Medium"
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 9428,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-upx-65864"
            }
        },
        "relation1": {
            "identity": 19363,
            "start": 9428,
            "end": 9431,
            "type": "PATCHING_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 9431,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "more checking of PackUnix::p_info at unpack\n\nhttps://github.com/upx/upx/issues/781\nhttps://bugs.chromium.org/p/oss-fuzz/issues/detail?id=65864\n\tmodified:   p_unix.cpp\n",
                "sha": "2767ec54e11ac516e4a2233f183c61843d9789f0",
                "repo": "upx",
                "encoding": "UTF-8",
                "authored_date": 1706389619,
                "committer_tz_offset": 28800,
                "author_tz_offset": 28800,
                "committed_date": 1706389619
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    },
    {
        "baseNode": {
            "identity": 9428,
            "labels": [
                "VulnerabilityPatch"
            ],
            "properties": {
                "vulnerabilityIdentifier": "ossfuzz-upx-65864"
            }
        },
        "relation1": {
            "identity": 19357,
            "start": 9428,
            "end": 9429,
            "type": "VULNERABLE_COMMIT",
            "properties": {}
        },
        "oneEdgeAway": {
            "identity": 9429,
            "labels": [
                "Commit"
            ],
            "properties": {
                "message": "check nbucket earlier in DT_HASH on ELF\n\nhttps://github.com/upx/upx/issues/780\nhttps://bugs.chromium.org/p/oss-fuzz/issues/detail?id=66079\n\tmodified:   p_lx_elf.cpp\n",
                "sha": "ac72c027937ff7c39b8b2c060fc7df1e1fdee489",
                "repo": "upx",
                "encoding": "UTF-8",
                "authored_date": 1706384545,
                "committer_tz_offset": 28800,
                "author_tz_offset": 28800,
                "committed_date": 1706384545
            }
        },
        "relation2": null,
        "twoEdgesAway": {
            "identity": null,
            "labels": null,
            "properties": null
        }
    }
]